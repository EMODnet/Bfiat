<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Bfiat package: modelling trawling effects in the Dutch part of the Northsea • Bfiat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Bfiat package: modelling trawling effects in the Dutch part of the Northsea">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Bfiat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">How To</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to">
<li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/Bfiat.html">Description</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples-of-use" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples of use</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples-of-use">
<li><a class="dropdown-item" href="../articles/MWTL.html">The dutch monitoring data - fishing impact on density</a></li>
    <li><a class="dropdown-item" href="../articles/MWTL_EF.html">The dutch monitoring - fishing impact on ecosystem functioning</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://emodnet.github.io/Bfiat/"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The Bfiat package: modelling trawling effects in the Dutch part of the Northsea</h1>
                        <h4 data-toc-skip class="author">Karline
Soetaert and Olivier Beauchard</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EMODnet/Bfiat/vignettes/MWTL.Rmd" class="external-link"><code>vignettes/MWTL.Rmd</code></a></small>
      <div class="d-none name"><code>MWTL.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      The impact of bottom trawling on benthic life in the Dutch part of
      the Northsea is estimated. We use monitoring data from 103
      stations in the area (MWTL data set), and impose fishing
      intensities estimated for each of these stations.
    </div>
    
<div class="section level2">
<h2 id="aim-">Aim.<a class="anchor" aria-label="anchor" href="#aim-"></a>
</h2>
<p>We use functions from the <em>Btrait</em> and <em>Bfiat</em>
R-packages to estimate the impact of bottom fisheries on sediment
ecosystem functioning in the Dutch part of the Northsea.</p>
<p>We use three sets of data:</p>
<ul>
<li>
<em>in situ</em> density data from a particular site.</li>
<li>species <em>trait</em> information, including:
<ul>
<li>the age at maturity of the species, and</li>
<li>the depth of occurrence in the sediment.</li>
</ul>
</li>
<li>fishing intensity and gear penetration depths in the sites</li>
</ul>
<p>We use the MWTL macrofauna density data that have been compiled in
the frame of the EMODnet biology project, (<a href="https://www.emodnet-biology.eu" class="external-link uri">https://www.emodnet-biology.eu</a>). These data are
available from the R-package <em>Btrait</em> (Soetaert and Beauchard,
2024a).</p>
<p>The NIOZ trait database is used for the species traits (Beauchard et
al., 2021, 2023). The trait dataset is also in the R-package
<em>Btrait</em>.</p>
</div>
<div class="section level2">
<h2 id="software-">Software.<a class="anchor" aria-label="anchor" href="#software-"></a>
</h2>
<p>The fishing impact models run in the open source framework <em>R</em>
(R core team, 2025) and have been implemented in the <em>Bfiat</em>
R-package (Soetaert and Beauchard, 2024b).</p>
<p>The R-package <em>Btrait</em> (Soetaert and Beauchard, 2022) contains
functions to work on density and trait datasets.</p>
<p>The packages <em>Btrait</em> and <em>Bfiat</em> are available on
github (<a href="https://github.com/EMODnet/Btrait" class="external-link uri">https://github.com/EMODnet/Btrait</a> and <a href="https://github.com/EMODnet/Bfiat" class="external-link uri">https://github.com/EMODnet/Bfiat</a>).</p>
</div>
<div class="section level2">
<h2 id="the-fisheries-impact-model">The fisheries impact model<a class="anchor" aria-label="anchor" href="#the-fisheries-impact-model"></a>
</h2>
<p>The fisheries impact model is based on the logistic growth equation
(Verhulst 1845) that describes how species density or biomass evolves
over time. The effect of fishing on the population is included as a
series of <em>events</em>, that instantaneously decimate population
sizes, while in between these events the populations recover.</p>
<p>The model thus consists of two parts: (continuous) logistic growth in
between fishing events and an instantaneous depletion during
fishing.</p>
<div class="section level3">
<h3 id="logistic-growth">Logistic growth<a class="anchor" aria-label="anchor" href="#logistic-growth"></a>
</h3>
<p>The differential equation is, for t in between
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>t</mi><mi>j</mi><mo>+</mo></msubsup><annotation encoding="application/x-tex">t_j^+</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>t</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow><mo>−</mo></msubsup><annotation encoding="application/x-tex">t_{j+1}^-</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msubsup><mi>D</mi><mi>i</mi><mi>t</mi></msubsup></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>r</mi><mi>i</mi></msub><mo>⋅</mo><msubsup><mi>D</mi><mi>i</mi><mi>t</mi></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><msubsup><mi>D</mi><mi>i</mi><mi>t</mi></msubsup><msub><mi>K</mi><mi>i</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\frac{dD_i^t}{dt}=r_i \cdot D_i^t \cdot (1-\frac{D_i^t}{K_i}),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is time,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>D</mi><mi>i</mi><mi>t</mi></msubsup><annotation encoding="application/x-tex">D_i^t</annotation></semantics></math>
is the density of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at a particular time,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
(units of density) is the carrying capacity of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>i</mi></msub><annotation encoding="application/x-tex">r_i</annotation></semantics></math>
is the logistic growth parameter (units [/time]).</p>
</div>
<div class="section level3">
<h3 id="instantaneous-trawling">Instantaneous trawling<a class="anchor" aria-label="anchor" href="#instantaneous-trawling"></a>
</h3>
<p>During trawling at times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>j</mi></msub><annotation encoding="application/x-tex">t_j</annotation></semantics></math>,
density changes instantaneously:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>D</mi><mi>i</mi><msubsup><mi>t</mi><mi>j</mi><mo>+</mo></msubsup></msubsup><mo>=</mo><msubsup><mi>D</mi><mi>i</mi><msubsup><mi>t</mi><mi>j</mi><mo>−</mo></msubsup></msubsup><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">D_i^{t_j^+} = D_i^{t_j^-} \cdot (1-d_i),</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>D</mi><mi>i</mi><msubsup><mi>t</mi><mi>j</mi><mo>+</mo></msubsup></msubsup><annotation encoding="application/x-tex">D_i^{t_j^+}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>D</mi><mi>i</mi><msubsup><mi>t</mi><mi>j</mi><mo>−</mo></msubsup></msubsup><annotation encoding="application/x-tex">D_i^{t_j^-}</annotation></semantics></math>
are the density immediately after and before trawling occurs at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>j</mi></msub><annotation encoding="application/x-tex">t_j</annotation></semantics></math>
respectively, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math>
is the species-specific and trawl-specific depletion fraction.</p>
</div>
<div class="section level3">
<h3 id="trawling-intensity">Trawling intensity<a class="anchor" aria-label="anchor" href="#trawling-intensity"></a>
</h3>
<p>The time in between trawling can be inferred from the fishing
intensity, expressed as the annual swept area ratio (SAR).</p>
<p>SAR is the cumulative area contacted by a fishing gear over one year
and per surface area. It has units of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup><mspace width="0.222em"></mspace><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><mspace width="0.222em"></mspace><mi>y</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">m^2~m^{-2}~yr^{-1}</annotation></semantics></math>,
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">yr^{-1}</annotation></semantics></math>.</p>
<p>From the swept area ratio (hereafter denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>),
we calculate the average time in between fishing events
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">yr</annotation></semantics></math>)
as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>t</mi><mo>=</mo><msub><mi>t</mi><mrow><mi>j</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>t</mi><mi>j</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>S</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\Delta t = t_{j+1} - t_j = \frac{1}{S}.</annotation></semantics></math></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="data-requirements">Data requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h2>
<p>Central in the impact analysis is the use of a combination of data
sets:</p>
<div class="section level3">
<h3 id="community-composition">Community composition<a class="anchor" aria-label="anchor" href="#community-composition"></a>
</h3>
<p>Benthic biological data to be used for fishing assessment should
comprise at least density data, and preferentially also biomass of
individual species.</p>
<p>The densities or biomasses are used to estimate the “carrying
capacity” of the species at a particular site; this is the abundance the
species attains at steady-state, when undisturbed (i.e. in the absence
of fishing).</p>
</div>
<div class="section level3">
<h3 id="taxonomy">Taxonomy<a class="anchor" aria-label="anchor" href="#taxonomy"></a>
</h3>
<p>To assign biological traits to the taxa in the community, it is
convenient to know their taxonomic position. Thus it will be possible to
derive trait characteristics for taxa that are not documented in the
trait database, based on their taxonomic relationships.</p>
</div>
<div class="section level3">
<h3 id="trait-characteristics">Trait characteristics<a class="anchor" aria-label="anchor" href="#trait-characteristics"></a>
</h3>
<p>The following species traits are used to estimate the fishing impact
on species density:</p>
<ul>
<li>The <em>age</em> at maturity of species is used to estimate their
“intrinsic rate of natural increase”
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>i</mi></msub><annotation encoding="application/x-tex">r_i</annotation></semantics></math>).</li>
<li>The <em>depth</em> at which species live determines their
vulnerability to bottom trawling: it is used to derive the model’s
“depletion parameter”
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math>).</li>
</ul>
</div>
<div class="section level3">
<h3 id="fishing-intensity">Fishing intensity<a class="anchor" aria-label="anchor" href="#fishing-intensity"></a>
</h3>
<p>The model also needs the <em>fishing intensity</em> for a certain
area, for instance expressed as the annual swept area ratio (SAR); this
is the cumulative area contacted by a fishing gear over one year and per
surface area.</p>
<p>From the swept area ratio (hereafter denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>,
units
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><msup><mi>r</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">yr^{-1}</annotation></semantics></math>),
we calculate the time in between fishing events
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mi>r</mi></mrow><annotation encoding="application/x-tex">yr</annotation></semantics></math>)
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mi>S</mi></mfrac><annotation encoding="application/x-tex">\frac{1}{S}</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-availability">Data availability<a class="anchor" aria-label="anchor" href="#data-availability"></a>
</h2>
<div class="section level3">
<h3 id="community-composition-1">Community composition<a class="anchor" aria-label="anchor" href="#community-composition-1"></a>
</h3>
<p>For the subsequent analyses, we use macrofauna density data that have
been compiled in the frame of the EMODnet biology project, (<a href="https://www.emodnet-biology.eu" class="external-link uri">https://www.emodnet-biology.eu</a>).</p>
<p>The monitoring data from the Dutch part of the North sea (called the
MWTL monitoring data) comprise both species densities and biomass for
103 stations, that were sampled during 19 years, extending from 1995
till 2018.</p>
<p>Sampling was performed yearly at first, then less frequently.
Calculations in this document are based on yearly averages.</p>
<p>The MWTL data are available from the R-package <em>Btrait</em>, and
are in a list called <em>MWTL</em> (within R, type: <em>?MWTL</em> to
open the help file for these data).</p>
<p>The composition of the MWTL data is in Appendix 1.</p>
<table class="table">
<caption>TABLE: Metadata of the MWTL dataset</caption>
<colgroup>
<col width="23%">
<col width="46%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th align="left">title</th>
<th align="left">originator</th>
<th align="left">implemented</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">The MWTL Northsea macrobenthos data (1995 - 2018)</td>
<td align="left">Ministerie van Infrastructuur en Milieu,
Rijkswaterstaat Centrale Informatievoorziening (RWS, CIV)</td>
<td align="left">Karline Soetaert, in the frame of the EMODnet biology
project</td>
</tr></tbody>
</table>
<table class="table">
<caption>TABLE: MWTL$density (first 3 rows)</caption>
<colgroup>
<col width="14%">
<col width="15%">
<col width="7%">
<col width="40%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">station</th>
<th align="left">date</th>
<th align="left">year</th>
<th align="left">taxon</th>
<th align="left">density</th>
<th align="left">biomass</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">BREEVTN02</td>
<td align="left">27-06-1995</td>
<td align="left">1995</td>
<td align="left">Bathyporeia guilliamsoniana</td>
<td align="left">14.6</td>
<td align="left">0.0044</td>
</tr>
<tr class="even">
<td align="left">BREEVTN02</td>
<td align="left">27-06-1995</td>
<td align="left">1995</td>
<td align="left">Callianassa</td>
<td align="left">58.5</td>
<td align="left">1.3986</td>
</tr>
<tr class="odd">
<td align="left">BREEVTN02</td>
<td align="left">27-06-1995</td>
<td align="left">1995</td>
<td align="left">Chaetozone setosa</td>
<td align="left">14.6</td>
<td align="left">0.0073</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="taxonomic-data">Taxonomic data<a class="anchor" aria-label="anchor" href="#taxonomic-data"></a>
</h3>
<p>There are 400 different taxa in the MWTL data.</p>
<p>The taxonomic information for all taxa, has been derived from the
WoRMS database and is available from package <em>Btrait</em>, in dataset
<em>Taxonomy</em>:</p>
<table class="table">
<caption>TABLE: Dataset Taxonomy (first 3 rows)</caption>
<colgroup>
<col width="23%">
<col width="13%">
<col width="14%">
<col width="13%">
<col width="13%">
<col width="11%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">taxon</th>
<th align="left">genus</th>
<th align="left">family</th>
<th align="left">order</th>
<th align="left">class</th>
<th align="left">phylum</th>
<th align="left">AphiaID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Abietinaria</td>
<td align="left">Abietinaria</td>
<td align="left">Sertulariidae</td>
<td align="left">Leptothecata</td>
<td align="left">Hydrozoa</td>
<td align="left">Cnidaria</td>
<td align="left">117225</td>
</tr>
<tr class="even">
<td align="left">Abludomelita</td>
<td align="left">Abludomelita</td>
<td align="left">Melitidae</td>
<td align="left">Amphipoda</td>
<td align="left">Malacostraca</td>
<td align="left">Arthropoda</td>
<td align="left">101665</td>
</tr>
<tr class="odd">
<td align="left">Abludomelita obtusata</td>
<td align="left">Abludomelita</td>
<td align="left">Melitidae</td>
<td align="left">Amphipoda</td>
<td align="left">Malacostraca</td>
<td align="left">Arthropoda</td>
<td align="left">102788</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="trait-data">Trait data<a class="anchor" aria-label="anchor" href="#trait-data"></a>
</h3>
<p>We use the traits compiled by NIOZ (called <em>Traits_nioz</em>) for
age at maturity, and living depth. These trait data (mainly on species
level) were compiled by Beauchard et al. (2021) and Beauchard et
al. (2023). This database records 32 different traits from 281 taxa.</p>
<p>All traits are fuzzy-coded. The data structure is in appendix 2.</p>
<table class="table">
<caption>TABLE: First part of dataset Traits_nioz</caption>
<thead><tr class="header">
<th align="left">taxon</th>
<th align="left">ET1.M1</th>
<th align="left">ET1.M2</th>
<th align="left">ET1.M3</th>
<th align="left">ET1.M4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Abludomelita</td>
<td align="left">0.5</td>
<td align="left">0.5</td>
<td align="left">0.0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">Abludomelita obtusata</td>
<td align="left">0.5</td>
<td align="left">0.5</td>
<td align="left">0.0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">Abra alba</td>
<td align="left">0.0</td>
<td align="left">0.5</td>
<td align="left">0.5</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>The figure below shows the position and area of the MWTL stations,
and the swept area ratios (sar) that were derived from OSPAR (ICES
2018).</p>
<div class="figure">
<img src="MWTL_files/figure-html/unnamed-chunk-6-1.png" alt="FIG: MWTL sampling stations with indication of the main areas, fishing intensity and gear penetration depth. '+' denote the two stations that will be showcased." width="960"><p class="caption">
FIG: MWTL sampling stations with indication of the main areas, fishing
intensity and gear penetration depth. ‘+’ denote the two stations that
will be showcased.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="model-steps">Model steps<a class="anchor" aria-label="anchor" href="#model-steps"></a>
</h2>
<p>The model is applied in several steps:</p>
<ul>
<li>the taxon densities per station are prepared, and a list of taxa in
the data is generated,</li>
<li>the traits recording age at maturity and the depth distribution for
each taxon are extracted,</li>
<li>the fishing parameters for each station are extracted</li>
<li>the parameter values are estimated based on the traits, fishing
parameters, and taxon density</li>
<li>the model is run</li>
</ul>
</div>
<div class="section level2">
<h2 id="the-mwtl-density">The MWTL density<a class="anchor" aria-label="anchor" href="#the-mwtl-density"></a>
</h2>
<p>The MWTL data are gathered over several years, and are in data.frame
<em>MWTL$density</em>. We calculate the density for all stations
(descriptor) and taxa, averaged over all years, using <em>Btrait</em>
function <em>get_density</em>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MeanMWTL</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">get_density</span><span class="op">(</span>data        <span class="op">=</span> <span class="va">MWTL</span><span class="op">$</span><span class="va">density</span>,</span>
<span>              descriptor  <span class="op">=</span> <span class="va">station</span>,  </span>
<span>              taxon       <span class="op">=</span> <span class="va">taxon</span>,</span>
<span>              value       <span class="op">=</span> <span class="va">density</span>,</span>
<span>              averageOver <span class="op">=</span> <span class="va">year</span><span class="op">)</span></span></code></pre></div>
<p>The taxa whose traits need to be found are extracted:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MWTLtaxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">MeanMWTL</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span><span class="op">)</span>  </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extracting-taxon-traits">Extracting taxon traits<a class="anchor" aria-label="anchor" href="#extracting-taxon-traits"></a>
</h2>
<p>Taxon traits that we need are in the nioz trait database
(<em>Traits_nioz</em>), from R-package <em>Btrait</em>. From this
database, we use:</p>
<ul>
<li>the depth distribution (fractional occurrence in each depth
layer),</li>
<li>the age at maturity of a species</li>
</ul>
<div class="section level3">
<h3 id="substrate-depth-distribution">Substrate depth distribution<a class="anchor" aria-label="anchor" href="#substrate-depth-distribution"></a>
</h3>
<p>Depth distribution is a fuzzy-coded trait in the trait database. For
use in the model we need to keep it fuzzy coded.</p>
<p>The meaning of the nioz traits is stored in its metadata. We look for
the trait names that relate to depth distribution:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta</span>   <span class="op">&lt;-</span> <span class="fu">metadata</span><span class="op">(</span><span class="va">Traits_nioz</span><span class="op">)</span>  <span class="co"># description of trait modalities</span></span>
<span></span>
<span><span class="va">meta.D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">meta</span>,           <span class="co"># names of trait modalities for substratum depth</span></span>
<span>                 subset <span class="op">=</span> <span class="op">(</span><span class="va">trait</span> <span class="op">==</span> <span class="st">"Substratum depth distribution"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>TABLE: Depth distribution traits in the NIOZ trait
database</caption>
<colgroup>
<col width="11%">
<col width="42%">
<col width="12%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">colname</th>
<th align="left">trait</th>
<th align="left">modality</th>
<th align="left">indic</th>
<th align="left">value</th>
<th align="left">score</th>
<th align="left">units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ET1.M1</td>
<td align="left">Substratum depth distribution</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0.0</td>
<td align="left">1.00</td>
<td align="left">cm</td>
</tr>
<tr class="even">
<td align="left">ET1.M2</td>
<td align="left">Substratum depth distribution</td>
<td align="left">0-5</td>
<td align="left">1</td>
<td align="left">2.5</td>
<td align="left">0.75</td>
<td align="left">cm</td>
</tr>
<tr class="odd">
<td align="left">ET1.M3</td>
<td align="left">Substratum depth distribution</td>
<td align="left">5-15</td>
<td align="left">1</td>
<td align="left">10.0</td>
<td align="left">0.50</td>
<td align="left">cm</td>
</tr>
<tr class="even">
<td align="left">ET1.M4</td>
<td align="left">Substratum depth distribution</td>
<td align="left">15-30</td>
<td align="left">1</td>
<td align="left">22.5</td>
<td align="left">0.25</td>
<td align="left">cm</td>
</tr>
<tr class="odd">
<td align="left">ET1.M5</td>
<td align="left">Substratum depth distribution</td>
<td align="left">&gt;30</td>
<td align="left">1</td>
<td align="left">30.0</td>
<td align="left">0.00</td>
<td align="left">cm</td>
</tr>
</tbody>
</table>
<p>We then extract the depth traits for each taxon in the MWTL density
data set. As not all species in the MWTL dataset have traits assigned,
we use the taxonomic information (in dataset <em>Taxonomy</em>) to
estimate the traits also for unrecorded species.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">traits.D</span> <span class="op">&lt;-</span> <span class="fu">get_trait</span><span class="op">(</span></span>
<span>                taxon    <span class="op">=</span> <span class="va">MWTLtaxa</span>, </span>
<span>                trait    <span class="op">=</span> <span class="va">Traits_nioz</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">meta.D</span><span class="op">$</span><span class="va">colname</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                taxonomy <span class="op">=</span> <span class="va">Taxonomy</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">traits.D</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">meta.D</span><span class="op">$</span><span class="va">modality</span>     <span class="co"># suitable column names</span></span></code></pre></div>
<table class="table">
<caption>TABLE: Depth distribution of species in the MWTL dataset,
(first part)</caption>
<thead><tr class="header">
<th align="left">taxon</th>
<th align="right">0</th>
<th align="right">0-5</th>
<th align="right">5-15</th>
<th align="right">15-30</th>
<th align="right">&gt;30</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Abludomelita obtusata</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Abra alba</td>
<td align="right">0.0</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Abra nitida</td>
<td align="right">0.0</td>
<td align="right">1.0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Of the 400 taxa in the MWTL dataset, only 209 taxa are documented in
the trait database. The traits for the remaining taxa were estimated
based on taxonomic closedness. Of these taxa, only 8 could not be
assigned a trait. These were: Ascidiacea, Chaetognatha, Enteropneusta,
Entoprocta, Nematoda, Nemertea, Platyhelminthes, Priapulida. As these
taxa are not true macrofauna, they can be removed from the dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Notrait</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">traits.D</span><span class="op">)</span><span class="op">$</span><span class="va">notrait</span></span>
<span><span class="va">MWTLtaxa</span> <span class="op">&lt;-</span> <span class="va">MWTLtaxa</span> <span class="op">[</span><span class="op">!</span> <span class="va">MWTLtaxa</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">Notrait</span><span class="op">]</span></span>
<span><span class="va">MeanMWTL</span> <span class="op">&lt;-</span> <span class="va">MeanMWTL</span> <span class="op">[</span><span class="op">!</span> <span class="va">MeanMWTL</span><span class="op">$</span><span class="va">taxon</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">Notrait</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="age-at-maturity">Age at maturity<a class="anchor" aria-label="anchor" href="#age-at-maturity"></a>
</h3>
<p>We perform a similar procedure to extract the age at maturity for
each taxon in the density data. The age at maturity is estimated as the
<em>average</em> of the fuzzy values.</p>
<p>We first find the relevant trait names in the trait database:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta.A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">meta</span>,     </span>
<span>                 subset <span class="op">=</span> <span class="op">(</span><span class="va">trait</span> <span class="op">==</span> <span class="st">"Age at maturity"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>TABLE: Age at maturity traits in the NIOZ trait
database</caption>
<thead><tr class="header">
<th align="left">colname</th>
<th align="left">trait</th>
<th align="left">modality</th>
<th align="right">indic</th>
<th align="right">value</th>
<th align="right">score</th>
<th align="left">units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">RT8.M1</td>
<td align="left">Age at maturity</td>
<td align="left">&lt;1</td>
<td align="right">8</td>
<td align="right">0.5</td>
<td align="right">0.0</td>
<td align="left">year</td>
</tr>
<tr class="even">
<td align="left">RT8.M2</td>
<td align="left">Age at maturity</td>
<td align="left">1-3</td>
<td align="right">8</td>
<td align="right">2.0</td>
<td align="right">0.5</td>
<td align="left">year</td>
</tr>
<tr class="odd">
<td align="left">RT8.M3</td>
<td align="left">Age at maturity</td>
<td align="left">3-5</td>
<td align="right">8</td>
<td align="right">4.0</td>
<td align="right">1.0</td>
<td align="left">year</td>
</tr>
</tbody>
</table>
<p>We then calculate the average age at maturity. To calculate the
average, we pass the <em>trait_class</em> and <em>trait_score</em> while
extracting the traits.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">traits.A</span> <span class="op">&lt;-</span> <span class="fu">get_trait</span><span class="op">(</span> </span>
<span>               taxon       <span class="op">=</span> <span class="va">MWTLtaxa</span>, </span>
<span>               trait       <span class="op">=</span> <span class="va">Traits_nioz</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">meta.A</span><span class="op">$</span><span class="va">colname</span><span class="op">)</span><span class="op">]</span>, </span>
<span>               trait_class <span class="op">=</span> <span class="va">meta.A</span><span class="op">$</span><span class="va">trait</span>, </span>
<span>               trait_score <span class="op">=</span> <span class="va">meta.A</span><span class="op">$</span><span class="va">value</span>, </span>
<span>               taxonomy    <span class="op">=</span> <span class="va">Taxonomy</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>TABLE: Mean age at maturity of species ([yr]) in the MWTL
dataset (first part)</caption>
<thead><tr class="header">
<th align="left">taxon</th>
<th align="center">Age.at.maturity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Abludomelita obtusata</td>
<td align="center">0.5</td>
</tr>
<tr class="even">
<td align="left">Abra alba</td>
<td align="center">0.5</td>
</tr>
<tr class="odd">
<td align="left">Abra nitida</td>
<td align="center">0.5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="merged-trait-density-data-frame">Merged trait-density data.frame<a class="anchor" aria-label="anchor" href="#merged-trait-density-data-frame"></a>
</h2>
<p>We merge these two trait datasets in one data.frame, merging by the
taxon.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TraitsAll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x  <span class="op">=</span> <span class="va">traits.A</span>, </span>
<span>                   y  <span class="op">=</span> <span class="va">traits.D</span>, </span>
<span>                   by <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span></span></code></pre></div>
<p>and then combine it with the species density data</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MWTLtrait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x  <span class="op">=</span> <span class="va">MeanMWTL</span>, </span>
<span>                   y  <span class="op">=</span> <span class="va">TraitsAll</span>,</span>
<span>                   by <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fishing-parameters">Fishing parameters<a class="anchor" aria-label="anchor" href="#fishing-parameters"></a>
</h2>
<p>Each station has a specific fishing intensity (swept area ratio,
<em>sar</em>), and mean gear penetration depth (<em>gpd</em>). This
information is kept in data.frame MWTL$abiotics (from R-package
Btrait).</p>
<p>The MWTL data.frame are merged with the swept area ratio, and with
the gear penetration depth, merging on column <em>station</em>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MWTLtrait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x  <span class="op">=</span> <span class="va">MWTLtrait</span>, </span>
<span>                   y  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">abiotics</span>, </span>
<span>                               select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">station</span>, <span class="va">sar</span>, <span class="va">gpd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="st">"station"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameter-values">Parameter values<a class="anchor" aria-label="anchor" href="#parameter-values"></a>
</h2>
<div class="section level3">
<h3 id="intrinsic-rate-of-natural-increase">Intrinsic rate of natural increase<a class="anchor" aria-label="anchor" href="#intrinsic-rate-of-natural-increase"></a>
</h3>
<p>The intrinsic rate of natural increase is specific for a species, and
can be estimated using function <em>par_r</em>. This parameter is added
to the MWTL data.frame.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_r</a></span><span class="op">(</span>age_at_maturity <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">Age.at.maturity</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="depletion-fraction-d">Depletion fraction d<a class="anchor" aria-label="anchor" href="#depletion-fraction-d"></a>
</h3>
<p>The depletion rate depends on the depth occurrence of the species
(<em>fDepth</em>), and on the gear penetration depth (<em>gpd</em>).</p>
<p>The latter differs among stations, so the species depletion fraction
will vary with the station.</p>
<p>We also need to input the upper position of each depth layer
(<em>uDepth</em>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_d</a></span><span class="op">(</span></span>
<span>  gpd    <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">gpd</span>,</span>
<span>  </span>
<span>  fDepth <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"0"</span>, <span class="st">"0-5"</span>, <span class="st">"5-15"</span>, <span class="st">"15-30"</span>, <span class="st">"&gt;30"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  uDepth <span class="op">=</span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">0</span>,     <span class="fl">0</span>,     <span class="fl">5</span>,      <span class="fl">15</span>,    <span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="carrying-capacity-k">Carrying capacity K<a class="anchor" aria-label="anchor" href="#carrying-capacity-k"></a>
</h3>
<p>Te carrying capacity is estimated from the model itself. We pass the
species <em>density</em>, the fishing intensity (<em>sar</em>), the rate
of increase (<em>r</em>), and the depletion fraction (<em>d</em>):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_K</a></span><span class="op">(</span></span>
<span>  </span>
<span>  density <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">density</span>,</span>
<span>  sar     <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">sar</span>,</span>
<span>  </span>
<span>  r       <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">r</span>,</span>
<span>  d       <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">d</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The data that we will use for fishing impact assessment is:</p>
<table class="table">
<caption>TABLE: First part of data used for fishing assessment</caption>
<thead><tr class="header">
<th align="left">station</th>
<th align="left">taxon</th>
<th align="left">r</th>
<th align="left">d</th>
<th align="left">K</th>
<th align="left">sar</th>
<th align="left">gpd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">BREEVTN02</td>
<td align="left">Ophiura</td>
<td align="left">0.96</td>
<td align="left">0.16</td>
<td align="left">2.87</td>
<td align="left">1.42</td>
<td align="left">2.95</td>
</tr>
<tr class="even">
<td align="left">BREEVTN02</td>
<td align="left">Sthenelais limicola</td>
<td align="left">0.73</td>
<td align="left">0.14</td>
<td align="left">5.64</td>
<td align="left">1.42</td>
<td align="left">2.95</td>
</tr>
<tr class="odd">
<td align="left">BREEVTN02</td>
<td align="left">Diplocirrus glaucus</td>
<td align="left">1.89</td>
<td align="left">0.11</td>
<td align="left">6.23</td>
<td align="left">1.42</td>
<td align="left">2.95</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="species-for-which-the-model-does-not-find-a-solution">Species for which the model does not find a solution<a class="anchor" aria-label="anchor" href="#species-for-which-the-model-does-not-find-a-solution"></a>
</h3>
<p>These are species where the depletion is too high and/or the
intrinsic rate of increase is too low, so that it cannot persist in the
environment under the current fishing pressure. This causes an
anomalously high carrying capacity compared to observed density. Such
occurrences are removed from the data set.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">DK</span> <span class="op">&lt;-</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">density</span><span class="op">/</span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">K</span></span>
<span><span class="va">ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">DK</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">NAS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">MWTLtrait</span>, subset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">DK</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MWTLtrait</span> <span class="op">&lt;-</span> <span class="va">MWTLtrait</span><span class="op">[</span><span class="op">-</span><span class="va">ii</span>,<span class="op">]</span></span></code></pre></div>
<p>There are 16 such species, the highest observed density
being17.4415692. These taxa are removed from the analysis.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">NAS</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">TM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">NAS</span><span class="op">$</span><span class="va">density</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">NAS</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span>, FUN<span class="op">=</span><span class="va">max</span><span class="op">)</span></span>
<span><span class="va">TT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">TT</span>, <span class="va">TM</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TT</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="st">"occurrences"</span>, <span class="st">"max density"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">TT</span>, caption <span class="op">=</span> <span class="st">"Taxa for which the model could not be solved"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Taxa for which the model could not be solved</caption>
<thead><tr class="header">
<th align="left">taxon</th>
<th align="right">occurrences</th>
<th align="right">max density</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Amphiura filiformis</td>
<td align="right">1</td>
<td align="right">0.6747638</td>
</tr>
<tr class="even">
<td align="left">Astropecten</td>
<td align="right">2</td>
<td align="right">11.5504579</td>
</tr>
<tr class="odd">
<td align="left">Crangon crangon</td>
<td align="right">1</td>
<td align="right">0.6747638</td>
</tr>
<tr class="even">
<td align="left">Cucumaria</td>
<td align="right">1</td>
<td align="right">0.6842105</td>
</tr>
<tr class="odd">
<td align="left">Ensis ensis</td>
<td align="right">1</td>
<td align="right">2.4416667</td>
</tr>
<tr class="even">
<td align="left">Eteone longa</td>
<td align="right">1</td>
<td align="right">2.9852901</td>
</tr>
<tr class="odd">
<td align="left">Eudorella truncatula</td>
<td align="right">1</td>
<td align="right">3.4690862</td>
</tr>
<tr class="even">
<td align="left">Kurtiella bidentata</td>
<td align="right">1</td>
<td align="right">7.0395316</td>
</tr>
<tr class="odd">
<td align="left">Ophiura</td>
<td align="right">2</td>
<td align="right">4.0242915</td>
</tr>
<tr class="even">
<td align="left">Paraleptopentacta elongata</td>
<td align="right">1</td>
<td align="right">1.4431849</td>
</tr>
<tr class="odd">
<td align="left">Pholoe baltica</td>
<td align="right">1</td>
<td align="right">5.4170040</td>
</tr>
<tr class="even">
<td align="left">Pholoe minuta</td>
<td align="right">2</td>
<td align="right">13.2036283</td>
</tr>
<tr class="odd">
<td align="left">Spisula subtruncata</td>
<td align="right">1</td>
<td align="right">17.4415692</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="running-the-fishing-model">Running the fishing model<a class="anchor" aria-label="anchor" href="#running-the-fishing-model"></a>
</h2>
<p>We run the model for 8255 species-station occurrences. The model is
run for 30 years, of which 20 years of fishing (and thus 10 years where
fishing stopped).</p>
<p>We provide taxon names to label the output columns</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">30</span>, length.out <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span><span class="va">dens</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_perturb</a></span><span class="op">(</span>parms        <span class="op">=</span> <span class="va">MWTLtrait</span>, </span>
<span>                         times        <span class="op">=</span> <span class="va">times</span>, </span>
<span>                         taxon_names  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">station</span>, </span>
<span>                                              <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">taxon</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,</span>
<span>                         tend_perturb <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##   0.552   0.067   0.619</span></span></code></pre>
<p>The result is a matrix with 3000 rows and 8256 columns, the first of
which contains the time, followed by the density trajectories of all
species, and for all stations.</p>
<table class="table">
<caption>TABLE: First part of model output</caption>
<colgroup>
<col width="7%">
<col width="21%">
<col width="35%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">times</th>
<th align="left">BREEVTN02_Ophiura</th>
<th align="left">BREEVTN02_Sthenelais limicola</th>
<th align="left">BREEVTN02_Diplocirrus glaucus</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0.00</td>
<td align="left">2.87</td>
<td align="left">5.64</td>
<td align="left">6.23</td>
</tr>
<tr class="even">
<td align="left">0.01</td>
<td align="left">2.87</td>
<td align="left">5.64</td>
<td align="left">6.23</td>
</tr>
<tr class="odd">
<td align="left">0.02</td>
<td align="left">2.87</td>
<td align="left">5.64</td>
<td align="left">6.23</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="summaries">Summaries<a class="anchor" aria-label="anchor" href="#summaries"></a>
</h3>
<p>The total density per station is calculated as rowSums per
station.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dens</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dens</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="co"># remove first column</span></span>
<span><span class="va">Total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split.default</a></span><span class="op">(</span><span class="va">Dens</span>, <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">station</span><span class="op">)</span>, <span class="co"># split in stations</span></span>
<span>                FUN <span class="op">=</span> <span class="va">rowSums</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>            <span class="co"># take row sums</span></span></code></pre></div>
<p>Then relative values are calculated by dividing all columns (MARGIN =
2) by their maximum (STATS).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Drel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span>x      <span class="op">=</span> <span class="va">Total</span>, </span>
<span>              MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              STATS  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Total</span>,            <span class="co"># max of each column</span></span>
<span>                             MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                             FUN    <span class="op">=</span> <span class="va">max</span><span class="op">)</span>, </span>
<span>              FUN    <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>                    <span class="co"># divide by the max</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="some-results">Some results<a class="anchor" aria-label="anchor" href="#some-results"></a>
</h3>
<p>We show the results for the 20 most abundant species in two
stations.</p>
<div class="figure">
<img src="MWTL_files/figure-html/unnamed-chunk-31-1.png" alt="FIG: Density trajectories of 5 most abundant species from two stations" width="864"><p class="caption">
FIG: Density trajectories of 5 most abundant species from two stations
</p>
</div>
<p>The average density reduction due to fishing in each of the stations
is estimated:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fishing reduction for all species</span></span>
<span><span class="va">DDrel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span>X      <span class="op">=</span> <span class="va">dens</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>               MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>               FUN    <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># averaged per station</span></span>
<span><span class="va">DDstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>x   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>p <span class="op">=</span> <span class="va">DDrel</span><span class="op">)</span>, </span>
<span>                    by  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">station</span><span class="op">)</span>, </span>
<span>                    FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MWTLstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">stations</span>, <span class="va">DDstat</span>,   <span class="co"># add station coordinates </span></span>
<span>                  by <span class="op">=</span> <span class="st">"station"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">MWTLstat</span>, </span>
<span>    <span class="fu">map_MWTL</span><span class="op">(</span>x    <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, colvar <span class="op">=</span> <span class="va">p</span>, </span>
<span>             main <span class="op">=</span> <span class="st">"Fractional reduction "</span>, clab <span class="op">=</span> <span class="st">"-"</span>, </span>
<span>             col  <span class="op">=</span> <span class="va">Colramp</span>, cex <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">15</span>, log <span class="op">=</span> <span class="st">""</span>,</span>
<span>             type <span class="op">=</span> <span class="st">"legend"</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="MWTL_files/figure-html/unnamed-chunk-32-1.png" alt="FIG: Average fishing impacts for the MWTL stations" width="480"><p class="caption">
FIG: Average fishing impacts for the MWTL stations
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="structure-of-the-mwtl-data">Structure of the MWTL data<a class="anchor" aria-label="anchor" href="#structure-of-the-mwtl-data"></a>
</h3>
<p>The MWTL list contains several data.frames. We will use mainly the
data.frames called <em>density</em>, <em>stations</em>, and
<em>abiotics</em> (for fishing intensities). The structure of these data
is:</p>
<table class="table">
<caption>TABLE: MWTL$station</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">description</th>
<th align="left">format</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">x</td>
<td align="left">degrees longitude</td>
<td align="left">WGS84</td>
</tr>
<tr class="even">
<td align="left">y</td>
<td align="left">degrees latitude</td>
<td align="left">WGS84</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>TABLE: MWTL$density</caption>
<colgroup>
<col width="20%">
<col width="58%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">description</th>
<th align="left">units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">station</td>
<td align="left">station name</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">date</td>
<td align="left">sampling date, a string</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">taxon</td>
<td align="left">taxon name, checked by worms, and adjusted</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">density</td>
<td align="left">species total density</td>
<td align="left">individuals/m2</td>
</tr>
<tr class="odd">
<td align="left">biomass</td>
<td align="left">species total ash-free dry weight</td>
<td align="left">gAFDW/m2</td>
</tr>
<tr class="even">
<td align="left">taxon.original</td>
<td align="left">original taxon name</td>
<td align="left"></td>
</tr>
</tbody>
</table>
<table class="table">
<caption>TABLE: MWTL$abiotics (related to fishing)</caption>
<thead><tr class="header">
<th align="left">name</th>
<th align="left">description</th>
<th align="left">units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DRB</td>
<td align="left">swept area ratio for dredge</td>
<td align="left">m2/m2/year</td>
</tr>
<tr class="even">
<td align="left">OT</td>
<td align="left">swept area ratio for otter trawl</td>
<td align="left">m2/m2/year</td>
</tr>
<tr class="odd">
<td align="left">SN</td>
<td align="left">swept area ratio for seines</td>
<td align="left">m2/m2/year</td>
</tr>
<tr class="even">
<td align="left">TBB</td>
<td align="left">swept area ratio for beam trawl</td>
<td align="left">m2/m2/year</td>
</tr>
<tr class="odd">
<td align="left">sar</td>
<td align="left">swept area ratio (fisheries), DRB +OT +SN +TBB</td>
<td align="left">m2/m2/year</td>
</tr>
<tr class="even">
<td align="left">subsar</td>
<td align="left">swept area ratio (fisheries) &gt; 2cm</td>
<td align="left">m2/m2/year</td>
</tr>
<tr class="odd">
<td align="left">gpd</td>
<td align="left">gear penetration depth</td>
<td align="left">cm</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="structure-of-the-trait-data">Structure of the Trait data<a class="anchor" aria-label="anchor" href="#structure-of-the-trait-data"></a>
</h3>
<table class="table">
<caption>TABLE: Metadata of Traits_nioz</caption>
<colgroup>
<col width="11%">
<col width="42%">
<col width="12%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">colname</th>
<th align="left">trait</th>
<th align="left">modality</th>
<th align="left">indic</th>
<th align="left">value</th>
<th align="left">score</th>
<th align="left">units</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ET1.M1</td>
<td align="left">Substratum depth distribution</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0.0</td>
<td align="left">1.00</td>
<td align="left">cm</td>
</tr>
<tr class="even">
<td align="left">ET1.M2</td>
<td align="left">Substratum depth distribution</td>
<td align="left">0-5</td>
<td align="left">1</td>
<td align="left">2.5</td>
<td align="left">0.75</td>
<td align="left">cm</td>
</tr>
<tr class="odd">
<td align="left">ET1.M3</td>
<td align="left">Substratum depth distribution</td>
<td align="left">5-15</td>
<td align="left">1</td>
<td align="left">10.0</td>
<td align="left">0.50</td>
<td align="left">cm</td>
</tr>
<tr class="even">
<td align="left">ET1.M4</td>
<td align="left">Substratum depth distribution</td>
<td align="left">15-30</td>
<td align="left">1</td>
<td align="left">22.5</td>
<td align="left">0.25</td>
<td align="left">cm</td>
</tr>
<tr class="odd">
<td align="left">ET1.M5</td>
<td align="left">Substratum depth distribution</td>
<td align="left">&gt;30</td>
<td align="left">1</td>
<td align="left">30.0</td>
<td align="left">0.00</td>
<td align="left">cm</td>
</tr>
<tr class="even">
<td align="left">ET2.M1</td>
<td align="left">Biodiffusion</td>
<td align="left">Null</td>
<td align="left">2</td>
<td align="left">0.0</td>
<td align="left">0.00</td>
<td align="left">-</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Beauchard O, Brind’Amour A, Schratzberger M, Laffargue P, Hintzen NT,
Somerfield PJ, Piet G (2021) A generic approach to develop a trait-based
indicator of trawling-induced disturbance. Mar Ecol Prog Ser 675:35-52.
<a href="https://doi.org/10.3354/meps13840" class="external-link uri">https://doi.org/10.3354/meps13840</a></p>
<p>Beauchard, O., Murray S.A. Thompson, Kari Elsa Ellingsen, Gerjan
Piet, Pascal Laffargue, Karline Soetaert, 2023. Assessing sea floor
functional diversity and vulnerability. Marine Ecology Progress Series
v708, p21-43, <a href="https://www.int-res.com/abstracts/meps/v708/p21-43" class="external-link uri">https://www.int-res.com/abstracts/meps/v708/p21-43</a></p>
<p>ICES Technical Service, Greater North Sea and Celtic Seas Ecoregions,
29 August 2018 sr.2018.14 Version 2: 22 January 2019 <a href="https://doi.org/10.17895/ices.pub.4508" class="external-link uri">https://doi.org/10.17895/ices.pub.4508</a> OSPAR request on
the production of spatial data layers of fishing intensity/pressure.</p>
<p>R Core Team (2024). R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria. URL
<a href="https://www.R-project.org/" class="external-link uri">https://www.R-project.org/</a>.</p>
<p>Soetaert Karline, Olivier Beauchard (2024). Btrait: Working with
Biological density, taxonomy, and trait composition data. R package
version 1.0.1.</p>
<p>Soetaert Karline, Olivier Beauchard (2024). Bfiat: Bottom Fishing
Impact Assessment Tool. R package version 1.0.1.</p>
<p>Verhulst, Pierre-François (1845). “Recherches mathématiques sur la
loi d’accroissement de la population” [Mathematical Researches into the
Law of Population Growth Increase]. Nouveaux Mémoires de l’Académie
Royale des Sciences et Belles-Lettres de Bruxelles. 18: 8.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
