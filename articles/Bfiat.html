<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bfiat: Modelling trawling effects on ecosystem functioning • Bfiat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bfiat: Modelling trawling effects on ecosystem functioning">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Bfiat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">How To</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to">
<li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/Bfiat.html">Description</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples-of-use" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples of use</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples-of-use">
<li><a class="dropdown-item" href="../articles/MWTL.html">The dutch monitoring data - fishing impact on density</a></li>
    <li><a class="dropdown-item" href="../articles/MWTL_EF.html">The dutch monitoring - fishing impact on ecosystem functioning</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://emodnet.github.io/Bfiat/"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bfiat: Modelling trawling effects on ecosystem functioning</h1>
                        <h4 data-toc-skip class="author">Karline
Soetaert and Olivier Beauchard</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EMODnet/Bfiat/vignettes/Bfiat.Rmd" class="external-link"><code>vignettes/Bfiat.Rmd</code></a></small>
      <div class="d-none name"><code>Bfiat.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      Bfiat is an R-package to estimate the impact of bottom trawling on
      organism density at the taxon level, and on ecosystem functioning.
      In this vignette we demonstrate the use of the package using
      simple examples.
    </div>
    
<div class="section level2">
<h2 id="aim-">Aim.<a class="anchor" aria-label="anchor" href="#aim-"></a>
</h2>
<p>This document describes how to estimate the impact of bottom
fisheries on sediment ecosystem functioning, using the R-package
<em>Bfiat</em> (Bottom Fisheries Impact Assessment Tool).</p>
<p>This R-package contains a data-driven mechanistic model that
describes how species density is being reduced by bottom trawling, and
then recovers till the next fishing event.</p>
<p>The outcome of this biological module are trajectories of species
(taxon) densities over time. As the species densities change, also the
ecosystem functions delivered by the community change.</p>
</div>
<div class="section level2">
<h2 id="two-logistic-growth-models-including-fisheries">Two logistic growth models including fisheries<a class="anchor" aria-label="anchor" href="#two-logistic-growth-models-including-fisheries"></a>
</h2>
<p>Logistic growth describes how species density or biomass evolves when
the sediment is undisturbed (i.e. in between fishing events). The
logistic model reads:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>D</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>r</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>D</mi><mi>i</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>D</mi><mi>i</mi></msub><msub><mi>K</mi><mi>i</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\frac{dD_i}{dt}=r_i \cdot D_i \cdot (1-\frac{D_i}{K_i}),</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is time,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>i</mi></msub><annotation encoding="application/x-tex">D_i</annotation></semantics></math>
is the density of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
at a particular time,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
is the carrying capacity of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>i</mi></msub><annotation encoding="application/x-tex">r_i</annotation></semantics></math>
is the logistic growth parameter (units [/time]). The term on the left
hand side,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>d</mi><msub><mi>D</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{dD_i}{dt}</annotation></semantics></math>
expresses how
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>i</mi></msub><annotation encoding="application/x-tex">D_i</annotation></semantics></math>
changes over time (it is a derivative).</p>
<p>The parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>i</mi></msub><annotation encoding="application/x-tex">r_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
are specific for species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>;
the carrying capacity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
also depends on the site where the species is found.</p>
<div class="section level3">
<h3 id="fisheries-events">Fisheries events<a class="anchor" aria-label="anchor" href="#fisheries-events"></a>
</h3>
<p>To include the impact of fisheries in the logistic growth model, we
can assume that trawling occurs as a series of <em>events</em>, that
instantaneously decimate populations. In between these events the
populations recover. Such fishing models consist of two parts:</p>
<ol style="list-style-type: decimal">
<li>When the sediment is trawled, at times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>j</mi></msub><annotation encoding="application/x-tex">t_j</annotation></semantics></math>,
the density of each species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
is instantaneously depleted with a fraction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math>,
so that only a fraction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">1-d_i</annotation></semantics></math>
remains:</li>
</ol>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>D</mi><mi>i</mi><msubsup><mi>t</mi><mi>j</mi><mo>+</mo></msubsup></msubsup><mo>=</mo><msubsup><mi>D</mi><mi>i</mi><msubsup><mi>t</mi><mi>j</mi><mo>−</mo></msubsup></msubsup><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>d</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">D_i^{t_j^+} = D_i^{t_j^-} \times (1-d_i),</annotation></semantics></math>
Here
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>D</mi><mi>i</mi><msubsup><mi>t</mi><mi>j</mi><mo>+</mo></msubsup></msubsup><annotation encoding="application/x-tex">D_i^{t_j^+}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>D</mi><mi>i</mi><msubsup><mi>t</mi><mi>j</mi><mo>−</mo></msubsup></msubsup><annotation encoding="application/x-tex">D_i^{t_j^-}</annotation></semantics></math>
are the density after and before trawling occurs at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>j</mi></msub><annotation encoding="application/x-tex">t_j</annotation></semantics></math>
respectively, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math>
is the depletion fraction. The higher is the depletion factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math>,
the more the density of the species after trawling will have been
reduced.</p>
<ol start="2" style="list-style-type: decimal">
<li>In between fishing, the population restores according to the
logistic growth equation
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>D</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>r</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>D</mi><mi>i</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>D</mi><mi>i</mi></msub><msub><mi>K</mi><mi>i</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\frac{dD_i}{dt}=r_i \cdot D_i \cdot (1-\frac{D_i}{K_i}).</annotation></semantics></math>
</li>
</ol>
<p>The , the proportion of a grid cell swept by fishing gear per year,
is used to estimate the mean <em>time in between fishing events</em> :
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mi>T</mi><mo>=</mo><mfrac><mn>1</mn><mi>S</mi></mfrac></mrow><annotation encoding="application/x-tex">\Delta T = \frac{1}{S}</annotation></semantics></math>,
in years. From this, the times of the fishing events can be estimated,
e.g. as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>j</mi></msub><mo>=</mo><msub><mi>T</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>Δ</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">T_j = T_{j-1} + \Delta T</annotation></semantics></math>,
where we assume equally spaced fishing events.</p>
</div>
<div class="section level3">
<h3 id="continuous-fishing">Continuous fishing<a class="anchor" aria-label="anchor" href="#continuous-fishing"></a>
</h3>
<p>Another approoach to model fishing pressure on populations is to
assume that fishing induces a constant mortality on the benthos of a
large area rather than being caused by a set of localised events.</p>
<p>In this case, the (continuous) dynamic model reads (e.g. Pitcher et
al., 2017):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>d</mi><msub><mi>D</mi><mi>i</mi></msub></mrow><mrow><mi>d</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi>r</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>D</mi><mi>i</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>D</mi><mi>i</mi></msub><msub><mi>K</mi><mi>i</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>m</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>D</mi><mi>i</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">\frac{dD_i}{dt}=r_i \cdot D_i \cdot (1-\frac{D_i}{K_i}) - m_i  \cdot D_i,</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>i</mi></msub><annotation encoding="application/x-tex">m_i</annotation></semantics></math>
is the constant mortality induced upon the species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level2">
<h2 id="r-package-bfiat">R-package Bfiat<a class="anchor" aria-label="anchor" href="#r-package-bfiat"></a>
</h2>
<p>The R-package <em>Bfiat</em> (Soetaert and Beauchard, 2024)
contains:</p>
<ul>
<li>Functions to estimate bottom trawling impacts on density</li>
</ul>
<pre><code><span><span class="co">##  [1] "critical_d"        "critical_gpd"      "critical_r"       </span></span>
<span><span class="co">##  [4] "critical_sar"      "density_logistic"  "density_metier"   </span></span>
<span><span class="co">##  [7] "density_perturb"   "run_logistic"      "run_perturb"      </span></span>
<span><span class="co">## [10] "sensitivity_area"  "sensitivity_taxon" "steady_logistic"  </span></span>
<span><span class="co">## [13] "steady_metier"     "steady_perturb"    "trawl_metier"     </span></span>
<span><span class="co">## [16] "trawl_perturb"</span></span></code></pre>
<ul>
<li>Functions to estimate bottom trawling impacts on ecosystem
functions.</li>
</ul>
<pre><code><span><span class="co">## [1] "get_Db_model"    "get_irr_model"   "get_trait_model"</span></span></code></pre>
<ul>
<li>Functions to calculate fishing parameters.</li>
</ul>
<pre><code><span><span class="co">## [1] "par_d" "par_K" "par_m" "par_r"</span></span></code></pre>
<ul>
<li>Datasets to apply the Bfiat functions.</li>
</ul>
<pre><code><span><span class="co">## [1] "NIOZdata" "SAR"</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="two-functions-for-the-assessment-of-bottom-trawling-on-benthic-density-">Two functions for the assessment of bottom trawling on benthic
density.<a class="anchor" aria-label="anchor" href="#two-functions-for-the-assessment-of-bottom-trawling-on-benthic-density-"></a>
</h2>
<div class="section level3">
<h3 id="trawling-events">Trawling events<a class="anchor" aria-label="anchor" href="#trawling-events"></a>
</h3>
<p>Functions <em>density_perturb</em> and <em>run_perturb</em> estimate
the impact of bottom disturbances on benthic taxa. Both functions
implement the same model, but require slightly different inputs. For
instance, function <em>run_perturb</em> accepts randomly spaced trawling
times (via argument <em>events</em>), while <em>density_perturb</em>
does not.</p>
<p>Function <em>density_metier</em> allows to input several metiers,
each with their own sar and depletion fraction.</p>
<p>They are defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/density.html">density_perturb</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fl">1</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> times <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,  </span>
<span> as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/density.html">density_metier</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>,  </span>
<span> <span class="fl">0.1</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span>  </span>
<span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/trawlingfun.html">run_perturb</a></span> <span class="op">(</span><span class="va">parms</span>, <span class="va">times</span>, sar <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span>  </span>
<span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, events <span class="op">=</span> <span class="cn">NULL</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, addsum <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<p>As an example, we estimate trawling impact on one species, with
trawling occurring either once or twice per year
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mn>1</mn><mo>=</mo><mn>1</mn><mo>,</mo><mi>S</mi><mn>2</mn><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">S1=1, S2=2</annotation></semantics></math>).
The trawling lasts for 10 years, after which the sediment remains
untrawled for another 10 years.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>   <span class="co"># output times, years</span></span>
<span></span>
<span><span class="co"># species-specific parameters</span></span>
<span><span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.5</span>,   <span class="co"># [/yr], rate of increase</span></span>
<span>              K <span class="op">=</span> <span class="fl">10</span>,    <span class="co"># [ind], carrying capacity</span></span>
<span>              d <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>   <span class="co"># [-]  , depletion fraction</span></span>
<span></span>
<span><span class="co"># run the model - one trawling event per year</span></span>
<span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_perturb</a></span><span class="op">(</span>parms          <span class="op">=</span> <span class="va">parms</span>,</span>
<span>                        times          <span class="op">=</span> <span class="va">times</span>, </span>
<span>                        tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                        tend_perturb   <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        sar            <span class="op">=</span> <span class="fl">1.</span><span class="op">)</span>  </span>
<span>               </span>
<span><span class="co"># run the model - two trawling events per year</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_perturb</a></span><span class="op">(</span>parms          <span class="op">=</span> <span class="va">parms</span>,</span>
<span>                        times          <span class="op">=</span> <span class="va">times</span>, </span>
<span>                        tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                        tend_perturb   <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        sar            <span class="op">=</span> <span class="fl">2.</span><span class="op">)</span>  </span>
<span><span class="co"># show the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out1</span>, <span class="va">out2</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"years"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"density"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Trawling with events"</span>, </span>
<span>     lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, </span>
<span>       title <span class="op">=</span> <span class="st">"sar"</span>,legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1/yr"</span>, <span class="st">"2/yr"</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-7-1.png" alt="Two trawling impact runs, for a species with [r=0.5/yr, K=10 ind, d=0.1]; trawling lasts for 10 years, followed by a recovery of 10 years" width="700"><p class="caption">
Two trawling impact runs, for a species with [r=0.5/yr, K=10 ind,
d=0.1]; trawling lasts for 10 years, followed by a recovery of 10 years
</p>
</div>
</div>
<div class="section level3">
<h3 id="constant-trawling">Constant trawling<a class="anchor" aria-label="anchor" href="#constant-trawling"></a>
</h3>
<p>Functions <em>density_logistic</em> and <em>run_logistic</em>
implement a fishing model with constant mortality, and are defined
as:</p>
<pre><code><span><span class="fu"><a href="../reference/density.html">density_logistic</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> m <span class="op">=</span> <span class="va">m</span><span class="op">)</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> times <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,  </span>
<span> as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/trawlingfun.html">run_logistic</a></span> <span class="op">(</span><span class="va">parms</span>, <span class="va">times</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,  </span>
<span> taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, addsum <span class="op">=</span> <span class="cn">FALSE</span>,  </span>
<span> verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<p>We run this model with mortality = 0.1 and 0.2 /year. As before we
assume that fishing stops after 10 years. This can simply be set with
argument <em>tend_perturb</em>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>   <span class="co"># output times, years</span></span>
<span></span>
<span><span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.5</span>,   <span class="co"># [/yr], rate of increase</span></span>
<span>              K <span class="op">=</span> <span class="fl">10</span>,    <span class="co"># [ind], carrying capacity</span></span>
<span>              m <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>   <span class="co"># [/yr], mortality rate</span></span>
<span></span>
<span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_logistic</a></span><span class="op">(</span>times          <span class="op">=</span> <span class="va">times</span>, </span>
<span>                       tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       tend_perturb   <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                       parms          <span class="op">=</span> <span class="va">parms</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># increase mortality</span></span>
<span><span class="va">p2</span>      <span class="op">&lt;-</span> <span class="va">parms</span></span>
<span><span class="va">p2</span><span class="op">$</span><span class="va">m</span>    <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span></span>
<span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_logistic</a></span><span class="op">(</span>times          <span class="op">=</span> <span class="va">times</span>, </span>
<span>                       tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       tend_perturb   <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                       parms          <span class="op">=</span> <span class="va">p2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">c1</span>, <span class="va">c2</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"years"</span>, ylab <span class="op">=</span> <span class="st">"density"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Constant trawling"</span>, </span>
<span>     lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0.2/yr"</span>, <span class="st">"0.4/yr"</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-9-1.png" alt="Two trawling impact runs, for a species with [r=0.5/yr, K=10 ind, d=0.1, m=0.1 and m=0.2/yr]; trawling lasts for 10 years, followed by a recovery of 10 years" width="700"><p class="caption">
Two trawling impact runs, for a species with [r=0.5/yr, K=10 ind, d=0.1,
m=0.1 and m=0.2/yr]; trawling lasts for 10 years, followed by a recovery
of 10 years
</p>
</div>
</div>
<div class="section level3">
<h3 id="effect-of-trawling-on-several-species">Effect of trawling on several species<a class="anchor" aria-label="anchor" href="#effect-of-trawling-on-several-species"></a>
</h3>
<p>The same models can be run for several species at once:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>  <span class="co"># output times      [year]</span></span>
<span></span>
<span><span class="co"># Species names and parameters</span></span>
<span><span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  taxon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span>,</span>
<span>  K     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">2</span>,   <span class="fl">10</span>,    <span class="fl">4</span><span class="op">)</span>,  <span class="co"># carrying capacity [g/m2]</span></span>
<span>  r     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">2</span>,    <span class="fl">5</span>,  <span class="fl">0.4</span><span class="op">)</span>,  <span class="co"># rate of increase  [/year]</span></span>
<span>  d     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.5</span>,  <span class="fl">0.3</span>,  <span class="fl">0.1</span><span class="op">)</span>   <span class="co"># depletion rate</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run the model</span></span>
<span><span class="va">run1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_perturb</a></span><span class="op">(</span>parms          <span class="op">=</span> <span class="va">parms</span>, </span>
<span>                        times          <span class="op">=</span> <span class="va">times</span>, </span>
<span>                        tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                        tend_perturb   <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        sar            <span class="op">=</span> <span class="fl">0</span>   <span class="op">)</span></span>
<span></span>
<span><span class="va">run2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_perturb</a></span><span class="op">(</span>parms          <span class="op">=</span> <span class="va">parms</span>, </span>
<span>                        times          <span class="op">=</span> <span class="va">times</span>, </span>
<span>                        tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                        tend_perturb   <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        sar            <span class="op">=</span> <span class="fl">1</span>   <span class="op">)</span></span>
<span></span>
<span><span class="va">run3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_perturb</a></span><span class="op">(</span>parms          <span class="op">=</span> <span class="va">parms</span>, </span>
<span>                        times          <span class="op">=</span> <span class="va">times</span>, </span>
<span>                        tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                        tend_perturb   <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                        sar            <span class="op">=</span> <span class="fl">2</span>   <span class="op">)</span></span>
<span><span class="co"># show the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">run1</span>, <span class="va">run2</span>, <span class="va">run3</span>, </span>
<span>     lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span>, mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"bottomright"</span>, </span>
<span>       legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"trawls/year"</span>, </span>
<span>       col<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lty<span class="op">=</span><span class="fl">1</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-10-1.png" alt="Trawling impacts on three species (s1, s2 and s3) and for two trawling intensities" width="576"><p class="caption">
Trawling impacts on three species (s1, s2 and s3) and for two trawling
intensities
</p>
</div>
</div>
<div class="section level3">
<h3 id="multiple-metiers">Multiple metiers<a class="anchor" aria-label="anchor" href="#multiple-metiers"></a>
</h3>
<p>We can also simulate several metiers (fishing activities), each with
their own depletion induced on the species:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>  <span class="co"># output times      [year]</span></span>
<span></span>
<span><span class="co"># Species names and parameters</span></span>
<span><span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  taxon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span>, <span class="st">"s4"</span><span class="op">)</span>,</span>
<span>  K     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">2</span>,  <span class="fl">10</span>,    <span class="fl">4</span>,     <span class="fl">1</span><span class="op">)</span>,  <span class="co"># carrying capacity [/m2]</span></span>
<span>  r     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">5</span>,   <span class="fl">2</span>,  <span class="fl">0.4</span>,     <span class="fl">1</span><span class="op">)</span>   <span class="co"># rate of increase  [/year]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4 metiers</span></span>
<span></span>
<span><span class="va">sar</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fl">1</span>, m2 <span class="op">=</span> <span class="fl">0.7</span>, m3 <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># depletion rate is species (rows) and metier- specific (columns)</span></span>
<span><span class="co">#                          sp1   sp2    sp3    sp4</span></span>
<span><span class="va">d</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.5</span>,  <span class="fl">0.3</span>,   <span class="fl">0.1</span>,   <span class="fl">0.3</span><span class="op">)</span>,  <span class="co"># metier 1</span></span>
<span>                   m2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.3</span>,  <span class="fl">0.6</span>,   <span class="fl">0.2</span>,   <span class="fl">0.2</span><span class="op">)</span>,  <span class="co"># metier 2</span></span>
<span>                   m3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.2</span>,  <span class="fl">0.1</span>,  <span class="fl">0.02</span>,  <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># run the model</span></span>
<span><span class="va">runm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_metier</a></span><span class="op">(</span>parms          <span class="op">=</span> <span class="va">parms</span>, </span>
<span>                       d              <span class="op">=</span> <span class="va">d</span>,</span>
<span>                       times          <span class="op">=</span> <span class="va">times</span>, </span>
<span>                       tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                       tend_perturb   <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                       sar            <span class="op">=</span> <span class="va">sar</span>   <span class="op">)</span></span>
<span><span class="co"># show the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">runm</span>, lty <span class="op">=</span> <span class="fl">1</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co">#, main = "3 metiers")</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-11-1.png" alt="Trawling impacts on four species (s1, s2, s3 and s4) and for three metiers" width="960"><p class="caption">
Trawling impacts on four species (s1, s2, s3 and s4) and for three
metiers
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="trawling-impacts-on-traits-and-ecosystem-functions">Trawling impacts on traits and ecosystem functions<a class="anchor" aria-label="anchor" href="#trawling-impacts-on-traits-and-ecosystem-functions"></a>
</h2>
<div class="section level3">
<h3 id="trawling-impacts-on-traits">Trawling impacts on traits<a class="anchor" aria-label="anchor" href="#trawling-impacts-on-traits"></a>
</h3>
<p>Function <em>get_trait_model</em> combines modeled species responses
with traits; it is defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/getTraitModel.html">get_trait_model</a></span> <span class="op">(</span><span class="va">model</span>, <span class="va">trait</span>, trait_class <span class="op">=</span> <span class="cn">NULL</span>, trait_score <span class="op">=</span> <span class="cn">NULL</span>,  </span>
<span> taxon_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, taxonomy <span class="op">=</span> <span class="cn">NULL</span>, taxon_column <span class="op">=</span> <span class="fl">1</span>,  </span>
<span> scalewithvalue <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<p>Using the previous model runs, we estimate the impact of trawling on
the feeding type of species, where we assume they are either suspension
or deposit feeders.</p>
<p>We first define the extent to which, for each species, both types of
feeding contributes to its diet, and where the sum of the proportions =
1.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedingtype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxon      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span>, </span>
<span>                          suspension <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">0</span>,  <span class="fl">0.5</span>,   <span class="fl">1</span><span class="op">)</span>, </span>
<span>                          deposit    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">1</span>,  <span class="fl">0.5</span>,   <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">feedingtype</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">taxon</th>
<th align="right">suspension</th>
<th align="right">deposit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">s1</td>
<td align="right">0.0</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">s2</td>
<td align="right">0.5</td>
<td align="right">0.5</td>
</tr>
<tr class="odd">
<td align="left">s3</td>
<td align="right">1.0</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
<p>Then we calculate how both feeding types are affected by the
trawling. We first estimate the total numbers of both types, after which
we also estimate the relative contribution (using argument
<em>scalewithvalue</em>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FT</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTraitModel.html">get_trait_model</a></span><span class="op">(</span>model          <span class="op">=</span> <span class="va">run2</span>, </span>
<span>                       trait          <span class="op">=</span> <span class="va">feedingtype</span>, </span>
<span>                       scalewithvalue <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">FT2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTraitModel.html">get_trait_model</a></span><span class="op">(</span>model          <span class="op">=</span> <span class="va">run2</span>, </span>
<span>                       trait          <span class="op">=</span> <span class="va">feedingtype</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">FT</span>, ylab <span class="op">=</span> <span class="st">"/m2"</span>,  </span>
<span>     mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">FT2</span>, ylab <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fraction suspension feeding"</span>, <span class="st">"fraction deposit feeding"</span><span class="op">)</span>, </span>
<span>     mfrow <span class="op">=</span> <span class="cn">NULL</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-14-1.png" alt="Change in absolute  (top) and relative (bottom) contribution of feeding types due to trawling" width="768"><p class="caption">
Change in absolute (top) and relative (bottom) contribution of feeding
types due to trawling
</p>
</div>
<p>Similarly, we can merge the model output for instance with mean
weight of each taxon, where when <em>scalewithvalue=FALSE</em>, we will
obtain the summed weights of all individuals, whereas if
<em>scalewithvalue=TRUE</em>, we will obtain the mean weight of the
entire community.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Biomass as a trait</span></span>
<span><span class="va">WW</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxon   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span>, </span>
<span>                   biomass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,   <span class="fl">0.5</span>,   <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Lrun</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTraitModel.html">get_trait_model</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">run2</span>, </span>
<span>                         trait <span class="op">=</span> <span class="va">WW</span>, </span>
<span>                         scalewithvalue<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Lrun2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTraitModel.html">get_trait_model</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">run2</span>, </span>
<span>                         trait <span class="op">=</span> <span class="va">WW</span>, </span>
<span>                         scalewithvalue<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Lrun</span>,  main <span class="op">=</span> <span class="st">"mean weight"</span>, xlab <span class="op">=</span> <span class="st">"g/ind"</span>,  </span>
<span>     mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Lrun2</span>, main <span class="op">=</span> <span class="st">"summed weight"</span>, xlab <span class="op">=</span> <span class="st">"g/m2"</span>,</span>
<span>     mfrow <span class="op">=</span> <span class="cn">NULL</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-15-1.png" alt="Change in mean and total weight due to trawling" width="768"><p class="caption">
Change in mean and total weight due to trawling
</p>
</div>
</div>
<div class="section level3">
<h3 id="trawling-impacts-on-ecosystem-functions">Trawling impacts on ecosystem functions<a class="anchor" aria-label="anchor" href="#trawling-impacts-on-ecosystem-functions"></a>
</h3>
<p>Functions <em>get_Db_model</em>, <em>get_irr_model</em> estimate the
effect of species responses on bioturbation and bioirrigation rates, as
described in Querios et al., 2013 and Wrede et al., 2018 respectively.
They are defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/getDbModel.html">get_Db_model</a></span> <span class="op">(</span><span class="va">model</span>, trait <span class="op">=</span> <span class="fu">Btrait</span><span class="fu">::</span><span class="va"><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_Db</a></span>, taxon_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  </span>
<span> taxonomy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">weight</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/getDbModel.html">get_irr_model</a></span> <span class="op">(</span><span class="va">model</span>, trait <span class="op">=</span> <span class="fu">Btrait</span><span class="fu">::</span><span class="va"><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_irr</a></span>, taxon_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  </span>
<span> taxonomy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">weight</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<p>To calculate the <em>bioturbation index</em>, we need to input the
relevant trait information. This should be a data.frame, with the first
column the name of the taxon, and followed by columns denoting the
mobility and reworking modes (values between 1-4 and 1-5 respectively).
These columns should be named “Mi” and “Ri”.</p>
<p>For the <em>bioirrigation index</em>, next to the taxon name the
columns named “BT” (burrowtype, value from 1-3), “FT” (feeding type,
1-3), and “ID” (injection depth, 1-4) should be present.</p>
<p>To calculate both indices, we also require the mean weight of the
taxa; this should be passed as a data.frame with taxonname in the first
column, and the weight in the second.</p>
<p>The formula for estimating the bioturbation Index for taxon i (as in
Querios et al., 2013) is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>P</mi><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msqrt><mi>(</mi></msqrt><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>⋅</mo><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>R</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>M</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">BPc_i = \sqrt(W_i)  \cdot  density_i  \cdot  R_i  \cdot  M_i</annotation></semantics></math></p>
<p>The formula for estimating the bioirrigation Index for taxon i (as in
Wrede et al., 2018) is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>P</mi><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>W</mi><mi>i</mi><mn>0.75</mn></msubsup><mo>⋅</mo><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mi>B</mi><msub><mi>T</mi><mi>i</mi></msub><mo>⋅</mo><mi>F</mi><msub><mi>T</mi><mi>i</mi></msub><mo>⋅</mo><mi>I</mi><msub><mi>D</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">IPc_i = W_i^{0.75}  \cdot  density_i  \cdot  BT_i  \cdot FT_i \cdot ID_i</annotation></semantics></math>,</p>
<p>As an example, we first input the weights and traits required, and
then estimate the bioturbation and bioirrigation potential associated to
previous runs.</p>
<p>The bioturbation and bioirrigation function estimate the contribution
of each species to these indices, as well as the total index.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxon  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span>, </span>
<span>                       weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.5</span>,  <span class="fl">1.0</span>,   <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Dbtrait</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span>, </span>
<span>                       Ri    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">4</span>,    <span class="fl">3</span>,    <span class="fl">1</span><span class="op">)</span>, </span>
<span>                       Mi    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">3</span>,    <span class="fl">3</span>,   <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">irrtrait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s1"</span>, <span class="st">"s2"</span>, <span class="st">"s3"</span><span class="op">)</span>, </span>
<span>                       BT    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, times<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, </span>
<span>                       FT    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">3</span>,  <span class="fl">2.5</span>,   <span class="fl">2</span><span class="op">)</span>, </span>
<span>                       ID    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">3</span>,    <span class="fl">3</span>,   <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Db</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getDbModel.html">get_Db_model</a></span><span class="op">(</span>model  <span class="op">=</span> <span class="va">run2</span>, </span>
<span>                    trait  <span class="op">=</span> <span class="va">Dbtrait</span>, </span>
<span>                    weight <span class="op">=</span> <span class="va">weight</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Db</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-17-1.png" alt="Change in absolute  (top) and relative (bottom) contribution of feeding types due to trawling" width="576"><p class="caption">
Change in absolute (top) and relative (bottom) contribution of feeding
types due to trawling
</p>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Irr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getDbModel.html">get_irr_model</a></span><span class="op">(</span>model  <span class="op">=</span> <span class="va">run2</span>, </span>
<span>                     trait  <span class="op">=</span> <span class="va">irrtrait</span>, </span>
<span>                     weight <span class="op">=</span> <span class="va">weight</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Irr</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-17-2.png" alt="Change in absolute  (top) and relative (bottom) contribution of feeding types due to trawling" width="576"><p class="caption">
Change in absolute (top) and relative (bottom) contribution of feeding
types due to trawling
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="functions-to-estimate-fishing-parameters-">Functions to estimate fishing parameters.<a class="anchor" aria-label="anchor" href="#functions-to-estimate-fishing-parameters-"></a>
</h2>
<p>The package <em>Bfiat</em> also contains functions to estimate the
fishing parameters.</p>
<div class="section level3">
<h3 id="depletion-rate">Depletion rate<a class="anchor" aria-label="anchor" href="#depletion-rate"></a>
</h3>
<p>Function <em>par_d</em> estimates the depletion rate as a function of
the depth occurrence of a species and of the gear penetration depth.</p>
<p>The <em>depletion fraction</em>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>i</mi></msub><annotation encoding="application/x-tex">d_i</annotation></semantics></math>)
for a certain species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is implemented as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>m</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>,</mo><munder><mo>∑</mo><mrow><mi>z</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>z</mi><mi>u</mi></msub><mo>,</mo><msub><mi>z</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow></munder><msub><mi>m</mi><mi>d</mi></msub><mo>⋅</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msub><mi>p</mi><mi>G</mi></msub><mo>−</mo><msub><mi>z</mi><mi>u</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>f</mi><msub><mi>i</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>z</mi><mi>u</mi></msub><mo>,</mo><msub><mi>z</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">d_i = min \left[m_{max}, \sum_{z=[z_u, z_l]}  m_d \cdot max\left( 0, p_G-z_u\right) \cdot fi_{[z_u, z_l]}\right]</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>u</mi></msub><annotation encoding="application/x-tex">z_u</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>l</mi></msub><annotation encoding="application/x-tex">z_l</annotation></semantics></math>
are the upper and lower depth of the species’ living space,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is a coefficient that scales the depletion to the depth that the gear
has penetrated in the species’s living space (the sediment depth
inbetween
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>u</mi></msub><mo>,</mo><msub><mi>z</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">z_u, z_l</annotation></semantics></math>),
and where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><msub><mi>i</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>z</mi><mi>u</mi></msub><mo>,</mo><msub><mi>z</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></msub></mrow><annotation encoding="application/x-tex">fi_{[z_u, z_l]}</annotation></semantics></math>
is the fractional occurrence of species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
in that zone. The maximal depletion fraction is limited to the value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">m_{max}</annotation></semantics></math>.</p>
<p>Good values for these parameters are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>d</mi></msub><mo>=</mo><mn>0.055</mn></mrow><annotation encoding="application/x-tex">m_d = 0.055</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">cm^{-1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>=</mo><mn>0.42</mn></mrow><annotation encoding="application/x-tex">m_{max} = 0.42</annotation></semantics></math>.
The function is defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/trawlingpars.html">par_d</a></span> <span class="op">(</span>gpd <span class="op">=</span> <span class="fl">1</span>, m_d <span class="op">=</span> <span class="fl">0.055</span>, m_max <span class="op">=</span> <span class="fl">0.42</span>, <span class="va">fDepth</span>, <span class="va">uDepth</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<p>Below, the depletion rate is estimated for three species, where the
living depth of the species has been divided in 2 sediment layers (0-10
and 10-20 cm), and is fuzzy coded.</p>
<p>The first species lives in the upper sediment layer (D0_10) only; the
second is equally distributed between layers and the third is only found
below 10 cm:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">fDepth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>D0_10  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,   <span class="co">#upper depth=0</span></span>
<span>                      D10_20 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>   <span class="co">#upper depth=10</span></span>
<span> <span class="va">uDepth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>  <span class="co"># upper depth                           </span></span></code></pre></div>
<p>The depletion, using the default parameter settings, and for a gear
penetration depth of 1 cm is:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/trawlingpars.html">par_d</a></span> <span class="op">(</span>gpd    <span class="op">=</span> <span class="fl">1</span>, </span>
<span>        fDepth <span class="op">=</span> <span class="va">fDepth</span>, </span>
<span>        uDepth <span class="op">=</span> <span class="va">uDepth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.0550 0.0275 0.0000</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/trawlingpars.html">par_d</a></span> <span class="op">(</span>gpd    <span class="op">=</span> <span class="fl">10</span>, </span>
<span>        fDepth <span class="op">=</span> <span class="va">fDepth</span>, </span>
<span>        uDepth <span class="op">=</span> <span class="va">uDepth</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.420 0.275 0.000</span></span></code></pre>
<p>Note that the deep-living species is not affected by any of the
gears.</p>
</div>
<div class="section level3">
<h3 id="rate-of-increase">Rate of increase<a class="anchor" aria-label="anchor" href="#rate-of-increase"></a>
</h3>
<p>Function <em>par_r</em> estimates the rate of increase (units
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>i</mi><mi>m</mi><msup><mi>e</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">time^{-1}</annotation></semantics></math>),
as a function of the species age at maturity (a_i) as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>4.165</mn><msub><mi>a</mi><mi>i</mi></msub></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">r_i=\frac{4.165}{a_i}.</annotation></semantics></math>
It is defined as:</p>
<pre><code><span><span class="fu"><a href="../reference/trawlingpars.html">par_r</a></span> <span class="op">(</span>age_at_maturity <span class="op">=</span> <span class="cn">NULL</span>, longevity <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">Age_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">5</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x    <span class="op">=</span> <span class="va">Age_mat</span>, </span>
<span>      y    <span class="op">=</span> <span class="fu"><a href="../reference/trawlingpars.html">par_r</a></span><span class="op">(</span><span class="va">Age_mat</span><span class="op">)</span>, </span>
<span>      xlab <span class="op">=</span> <span class="st">"age at maturity, year"</span>, </span>
<span>      ylab <span class="op">=</span> <span class="st">"r, /year"</span>, </span>
<span>      main <span class="op">=</span> <span class="st">"relationship between age at maturity and r"</span>,</span>
<span>      las  <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-22-1.png" alt="relationship between longevity and rate of increase" width="576"><p class="caption">
relationship between longevity and rate of increase
</p>
</div>
</div>
<div class="section level3">
<h3 id="carrying-capacity">Carrying capacity<a class="anchor" aria-label="anchor" href="#carrying-capacity"></a>
</h3>
<p>Function <em>par_K</em> estimates the species carrying capacity,
based on the fishing parameters, and species density. It does so by
inverse modelling, assuming that the measured density is the density of
the fauna, under the fishing pressure (sar).</p>
<pre><code><span><span class="fu"><a href="../reference/trawlingpars.html">par_K</a></span> <span class="op">(</span><span class="va">density</span>, <span class="va">sar</span>, <span class="va">r</span>, <span class="va">d</span>, t_density <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/trawlingpars.html">par_K</a></span> <span class="op">(</span>density <span class="op">=</span>   <span class="fl">1</span>, </span>
<span>        sar     <span class="op">=</span>   <span class="fl">1</span>, </span>
<span>        r       <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>        d       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.053105       NA</span></span></code></pre>
<p>Not all combinations of parameters lead to viable carrying
capacities, notably if the mortality induced by fisheries is larger than
the species intrinsic rate of increase (<em>r</em>), then the species
should become extinct due to fishing.</p>
<p>Carrying capacity K can be estimated for a sequence of fishing
intensities</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sequence of fishing intensities</span></span>
<span> <span class="va">sar.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0.05</span>, to<span class="op">=</span><span class="fl">3</span>, by<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># estimate carrying capacity for all these fishing intensities</span></span>
<span> <span class="va">K.seq</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_K</a></span><span class="op">(</span>density <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  sar     <span class="op">=</span> <span class="va">sar.seq</span>,</span>
<span>                  r       <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                  d       <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span> </span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sar.seq</span>, <span class="va">K.seq</span>,      </span>
<span>      xlab <span class="op">=</span> <span class="st">"Swept area ratio, /yr"</span>, </span>
<span>      ylab <span class="op">=</span> <span class="st">"K/D"</span>,</span>
<span>      main <span class="op">=</span> <span class="st">"relationship between sar and K"</span>,</span>
<span>      las <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-25-1.png" alt="relationship between carrying capaicty and swept area ratio" width="576"><p class="caption">
relationship between carrying capaicty and swept area ratio
</p>
</div>
<p>Note that the higher the trawling intensity (or swept area ratio),
the more the current density will deviate from the actual carrying
capacity, so the K/sar ratio significantly increases with sar. Above a
sar=2.25, the mortality becomes larger than the rate of increase, and
the species is likely to be extinct.</p>
</div>
<div class="section level3">
<h3 id="continuous-mortality-coefficient">Continuous mortality coefficient<a class="anchor" aria-label="anchor" href="#continuous-mortality-coefficient"></a>
</h3>
<p>Function <em>par_m</em> estimates the constant mortality parameter
for a species with growth rate <em>r</em>, so that the continuous
fishing model is consistent with the discrete model with parameters
<em>d</em> and the fishing intensity <em>sar</em>.</p>
<pre><code><span><span class="fu"><a href="../reference/trawlingpars.html">par_m</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">r</span>, <span class="va">K</span>, <span class="va">d</span>, refD <span class="op">=</span> <span class="va">K</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trawlingpars.html">par_m</a></span><span class="op">(</span>sar <span class="op">=</span> <span class="fl">2</span>, </span>
<span>      r   <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>      d   <span class="op">=</span> <span class="fl">0.2</span>, K <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.4447989</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="accessory-functions">Accessory functions<a class="anchor" aria-label="anchor" href="#accessory-functions"></a>
</h2>
<div class="section level3">
<h3 id="density-at-pertubation-and-steady-state-density">Density at pertubation, and steady-state density<a class="anchor" aria-label="anchor" href="#density-at-pertubation-and-steady-state-density"></a>
</h3>
<p>Function <em>density_perturb</em> estimates densities at selected
times, while <em>trawl_perturb</em> estimates the density before and
after the n-th trawling event.</p>
<pre><code><span><span class="fu"><a href="../reference/density.html">density_perturb</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fl">1</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> times <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,  </span>
<span> as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/trawlingdensity.html">trawl_perturb</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fl">1</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/density.html">density_perturb</a></span><span class="op">(</span>sar <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                r   <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                d   <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>                times  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   times         1</span></span>
<span><span class="co">## 1   0.0 1.0000000</span></span>
<span><span class="co">## 2   0.5 1.0000000</span></span>
<span><span class="co">## 3   1.0 0.8370301</span></span>
<span><span class="co">## 4   1.5 0.8683324</span></span>
<span><span class="co">## 5   2.0 0.7449818</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trawlingdensity.html">trawl_perturb</a></span><span class="op">(</span>sar <span class="op">=</span> <span class="fl">2</span>, </span>
<span>              r   <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>              d   <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>              n   <span class="op">=</span> <span class="fl">10</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   K   r   d sar D0 times times_end ntrawl_from ntrawl_to   density</span></span>
<span><span class="co">## 1 1 0.5 0.2   2  1   4.5       5.0          10        11 0.3379225</span></span>
<span><span class="co">## 2 1 0.5 0.2   2  1   5.0       5.5          11        12 0.3197363</span></span>
<span><span class="co">## 3 1 0.5 0.2   2  1   5.5       6.0          12        13 0.3038197</span></span>
<span><span class="co">##   density_start density_end</span></span>
<span><span class="co">## 1     0.3103657   0.3662333</span></span>
<span><span class="co">## 2     0.2929867   0.3473014</span></span>
<span><span class="co">## 3     0.2778411   0.3306613</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/trawlingdensity.html">trawl_perturb</a></span><span class="op">(</span>sar <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>, </span>
<span>              r   <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>              d   <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>              n   <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   K   r   d sar D0 times times_end ntrawl_from ntrawl_to   density</span></span>
<span><span class="co">## 1 1 0.5 0.2   2  1     0       0.5           1         2 0.8190069</span></span>
<span><span class="co">## 2 1 0.5 0.2   3  1     0       0.5           1         2 0.8128907</span></span>
<span><span class="co">## 3 1 0.5 0.2   4  1     0       0.5           1         2 0.8097507</span></span>
<span><span class="co">## 4 1 0.5 0.2   5  1     0       0.5           1         2 0.8078403</span></span>
<span><span class="co">## 5 1 0.5 0.2   6  1     0       0.5           1         2 0.8065557</span></span>
<span><span class="co">## 6 1 0.5 0.2   7  1     0       0.5           1         2 0.8056328</span></span>
<span><span class="co">## 7 1 0.5 0.2   8  1     0       0.5           1         2 0.8049376</span></span>
<span><span class="co">## 8 1 0.5 0.2   9  1     0       0.5           1         2 0.8043951</span></span>
<span><span class="co">## 9 1 0.5 0.2  10  1     0       0.5           1         2 0.8039600</span></span>
<span><span class="co">##   density_start density_end</span></span>
<span><span class="co">## 1           0.8   0.8370301</span></span>
<span><span class="co">## 2           0.8   0.8253410</span></span>
<span><span class="co">## 3           0.8   0.8192530</span></span>
<span><span class="co">## 4           0.8   0.8155214</span></span>
<span><span class="co">## 5           0.8   0.8130008</span></span>
<span><span class="co">## 6           0.8   0.8111842</span></span>
<span><span class="co">## 7           0.8   0.8098128</span></span>
<span><span class="co">## 8           0.8   0.8087410</span></span>
<span><span class="co">## 9           0.8   0.8078802</span></span></code></pre>
<p>Function <em>steady_perturb</em> and <em>steady_logistic</em>
estimate the density at steady state.</p>
<pre><code><span><span class="fu"><a href="../reference/steadydensity.html">steady_perturb</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fl">1</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<pre><code><span><span class="fu"><a href="../reference/steadydensity.html">steady_logistic</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> m <span class="op">=</span> <span class="va">m</span><span class="op">)</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span>  </span>
<span> </span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">sD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/steadydensity.html">steady_perturb</a></span><span class="op">(</span>K   <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                      r   <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                      d   <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   K   r   d sar D0 density_before density_after      density ntrawl time</span></span>
<span><span class="co">## 1 1 0.5 0.2   1  1   6.146287e-01  4.917030e-01 5.537146e-01     40   40</span></span>
<span><span class="co">## 2 1 0.5 0.2   2  1   1.198015e-01  9.584121e-02 1.074297e-01    374  187</span></span>
<span><span class="co">## 3 1 0.5 0.2   3  1   1.746276e-09  1.397021e-09 1.520186e-09    333  111</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># this is the inverse and should return K=1</span></span>
<span><span class="fu"><a href="../reference/trawlingpars.html">par_K</a></span><span class="op">(</span>density <span class="op">=</span> <span class="va">sD</span><span class="op">$</span><span class="va">density</span>,</span>
<span>      sar     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      r       <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>      d       <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.000003 1.000036       NA</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h2>
<p>There are 2 data sets in the <em>Bfiat</em> package:</p>
<div class="section level3">
<h3 id="density-and-biomass-data">Density and biomass data<a class="anchor" aria-label="anchor" href="#density-and-biomass-data"></a>
</h3>
<p>Dataset <em>NIOZdata</em> provides macrofauna density and biomass
data at 4 sites in the NorthSea.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">map_key</span><span class="op">(</span>x        <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">stations</span><span class="op">$</span><span class="va">x</span>,</span>
<span>        y        <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">stations</span><span class="op">$</span><span class="va">y</span>, </span>
<span>        contours <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">contours</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        col.levels <span class="op">=</span> <span class="st">"grey"</span>, by.levels <span class="op">=</span> <span class="fl">5</span>, draw.levels <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x      <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">stations</span><span class="op">$</span><span class="va">x</span>, </span>
<span>     y      <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">stations</span><span class="op">$</span><span class="va">y</span><span class="op">+</span><span class="fl">0.5</span>, </span>
<span>     labels <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">stations</span><span class="op">$</span><span class="va">station</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-32-1.png" alt="Stations in the NIOZdata dataset" width="576"><p class="caption">
Stations in the NIOZdata dataset
</p>
</div>
<p>The characteristics of NIOZdata, in terms of density and biomass
are:</p>
<table class="table">
<caption>Characteristics of NIOZdata: density (ind/m2), biomass
(gWW/m2), number of taxa, depth (m), % silt, sar (/yr), subsar (/yr) and
gear penetration depth (cm)</caption>
<colgroup>
<col width="25%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="8%">
<col width="5%">
<col width="6%">
<col width="6%">
<col width="9%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">station</th>
<th align="right">density</th>
<th align="right">biomass</th>
<th align="right">numTaxa</th>
<th align="right">depth</th>
<th align="right">D50</th>
<th align="right">silt</th>
<th align="right">sar</th>
<th align="right">subsar</th>
<th align="right">gpd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Doggerbank</td>
<td align="right">1519</td>
<td align="right">240</td>
<td align="right">61</td>
<td align="right">26</td>
<td align="right">217</td>
<td align="right">0.0</td>
<td align="right">1.91</td>
<td align="right">0.38</td>
<td align="right">1.71</td>
</tr>
<tr class="even">
<td align="left">FladenGround</td>
<td align="right">1170</td>
<td align="right">447</td>
<td align="right">51</td>
<td align="right">135</td>
<td align="right">57</td>
<td align="right">40.0</td>
<td align="right">3.18</td>
<td align="right">0.52</td>
<td align="right">1.55</td>
</tr>
<tr class="odd">
<td align="left">FrieseFront</td>
<td align="right">1322</td>
<td align="right">297</td>
<td align="right">57</td>
<td align="right">34</td>
<td align="right">86</td>
<td align="right">38.0</td>
<td align="right">1.24</td>
<td align="right">0.85</td>
<td align="right">2.17</td>
</tr>
<tr class="even">
<td align="left">Vlakte_van_de_Raan</td>
<td align="right">20598</td>
<td align="right">1103</td>
<td align="right">81</td>
<td align="right">10</td>
<td align="right">210</td>
<td align="right">8.3</td>
<td align="right">6.31</td>
<td align="right">3.22</td>
<td align="right">2.45</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="swept-area-ratio">Swept Area Ratio<a class="anchor" aria-label="anchor" href="#swept-area-ratio"></a>
</h3>
<p>Fishing intensity for the Northsea area as annual swept area ratios
are in a dataset called <em>SAR</em>, with a resolution of 0.05 dg in
longitudinal, and 0.05 dg in the latitudinal direction. The data
originate from ICES, and have been compiled on request of OSPAR. They
comprise:</p>
<ul>
<li>
<em>sar</em>: the swept area ratio of the surface 0-2 cm</li>
<li>
<em>subsar</em>: the swept area ratio of the subsurface (&gt;
2cm),</li>
<li>
<em>gpd</em>, the mean gear penetration depth, estimated based on
the different metiers, i.e. 4.45, 1.55, 1.55, 2.55 cm for dredge, otter
trawl, seine, beam trawl respectively (the mean of the gear penetration
in mud and sand).</li>
<li>
<em>lon</em>, <em>lat</em>, the coordinates of the points</li>
</ul>
<p><img src="Bfiat_files/figure-html/unnamed-chunk-34-1.png" width="768"></p>
<p>Note: the R-package, <em>Btrait</em> (Soetaert and Beauchard, 2022)
also contains density and trait data that can be used for fishery
assessment.</p>
</div>
</div>
<div class="section level2">
<h2 id="sensitivity-and-critical-values">Sensitivity and critical values<a class="anchor" aria-label="anchor" href="#sensitivity-and-critical-values"></a>
</h2>
<div class="section level3">
<h3 id="taxon-sensitivity">Taxon sensitivity<a class="anchor" aria-label="anchor" href="#taxon-sensitivity"></a>
</h3>
<p>Function <em>sensitivity_taxon</em> estimates for one taxon the
density decrease for combinations of sar (swept area ratio) and gpd
(gear penetration depth); also estimates (sar x gpd) values where the
taxon reaches a critical level.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">sensitivity_taxon</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## sensitivity_taxon (fDepth = 1, uDepth = 0, r = 0.1, sar.seq = seq(0, 10,  </span></span>
<span><span class="co">##  length.out = 200), gpd.seq = seq(0, 5, length.out = 200),  </span></span>
<span><span class="co">##  ...)  </span></span>
<span><span class="co">## </span></span></code></pre>
<p>Function critical_sar and critical_gpd estimate the critical fishing
intensity and gear penetration depth above which the taxon would become
extinct (crit_DK = 0) or attain some predefined fraction of its carrying
capacity (crit_DK &gt; 0).</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">critical_sar</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## critical_sar (gpd = 1, fDepth = 1, uDepth = 0, d = NULL, r = 0.1,  </span></span>
<span><span class="co">##  crit_DK = 0, ...)  </span></span>
<span><span class="co">## </span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">critical_gpd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## critical_gpd (sar = 1, fDepth = 1, uDepth = 0, d = NULL, r = 0.1,  </span></span>
<span><span class="co">##  crit_DK = 0, ...)  </span></span>
<span><span class="co">## </span></span></code></pre>
<p>In the figure below, first the sensitivity for the species Arctica
islandica in the Dutch North sea area (the MWTL data) is estimated and
plotted. The sensitivity to fishing intensity (sar) and gear penetration
depth (gpd) shows a rather large area where the species cannot survive
(the white region). We then add all stations from the Dutch part of the
North sea, characterised by the sar and gpd. This shows how the species
would do in these stations. We end by estimating the critical sar for
the gears (gpd) used in the Dutch Northsea, above which Artica islandica
would dissappear.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># parameters for Arctica islandica</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">fishing</span>, </span>
<span>       subset <span class="op">=</span> <span class="op">(</span><span class="va">taxon</span> <span class="op">==</span> <span class="st">"Arctica islandica"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                taxon p0 p0_5cm p5_15cm p15_30cm p30cm Age.at.maturity    r</span></span>
<span><span class="co">## 38 Arctica islandica  0    0.6     0.4        0     0               4 0.64</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S_af</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity.html">sensitivity_taxon</a></span><span class="op">(</span>r      <span class="op">=</span> <span class="fl">0.64</span>, </span>
<span>                          fDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>                          uDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,      <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># image, white = extinct</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">S_af</span><span class="op">$</span><span class="va">sar</span>, y <span class="op">=</span> <span class="va">S_af</span><span class="op">$</span><span class="va">gpd</span>, z <span class="op">=</span> <span class="va">S_af</span><span class="op">$</span><span class="va">DK</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"sar, /yr"</span>, ylab <span class="op">=</span> <span class="st">"gpd, cm"</span>, </span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Species sensitivity"</span>, <span class="st">"Arctica islandica"</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu">jet2.col</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, clab <span class="op">=</span> <span class="st">"D/K"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">S_af</span><span class="op">$</span><span class="va">sar</span>, <span class="va">S_af</span><span class="op">$</span><span class="va">critical_gpd</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>        </span>
<span><span class="co"># add the stations in the MWTL data (from Btrait)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">abiotics</span><span class="op">$</span><span class="va">sar</span>, <span class="va">MWTL</span><span class="op">$</span><span class="va">abiotics</span><span class="op">$</span><span class="va">gpd</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, pch <span class="op">=</span> <span class="fl">18</span>, legend <span class="op">=</span> <span class="st">" MWTL stations"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Bfiat_files/figure-html/unnamed-chunk-37-1.png" width="768"></p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c_s_MWTL</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/critical.html">critical_sar</a></span><span class="op">(</span>gpd <span class="op">=</span> <span class="va">MWTL</span><span class="op">$</span><span class="va">abiotics</span><span class="op">$</span><span class="va">gpd</span>, </span>
<span>                         fDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>                         uDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,      <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">c_s_MWTL</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">##  0.7282  1.2278  1.2863  1.3744  1.5133  2.1144</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="area-sensitivity-and-critical-values">area sensitivity and critical values<a class="anchor" aria-label="anchor" href="#area-sensitivity-and-critical-values"></a>
</h3>
<p>Function <em>sensitivity_area</em> estimates for one set of sar and
gpd values the density decrease for combinations of r (rate of natural
increase) and d (depletion) of a taxon; also estimates critical (r x d)
combinations for the area.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">sensitivity_area</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## sensitivity_area (sar = 1, gpd = 1, r.seq = seq(0.1, 5, length.out = 200),  </span></span>
<span><span class="co">##  d.seq = seq(0, 0.5, length.out = 200))  </span></span>
<span><span class="co">## </span></span></code></pre>
<p>Functions critical_r and critical_d estimate the critical intrinsic
rate of natural increase (r) and depletion fraction (d) beyond which a
taxon, that experiences the fishing intensity and gear penetration depth
of the area, would become extinct (crit_DK = 0) or attain some
predefined fraction of its carrying capacity (crit_DK &gt; 0).</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">critical_r</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## critical_r (sar = 1, gpd = 1, fDepth = 1, uDepth = 0, d = NULL,  </span></span>
<span><span class="co">##  crit_DK = 0, ...)  </span></span>
<span><span class="co">## </span></span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Def_fun</span><span class="op">(</span><span class="va">critical_d</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## critical_d (sar = 1, r = 0.1, crit_DK = 0, ...)  </span></span>
<span><span class="co">## </span></span></code></pre>
<p>We plot the sensitivity for one station in the Dutch part of the
Northsea, and add the species from the MWTL area on this plot.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># parameters for station WADDKT04</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">abiotics</span>, </span>
<span>       subset <span class="op">=</span> <span class="op">(</span><span class="va">station</span><span class="op">==</span> <span class="st">"WADDKT04"</span><span class="op">)</span>,</span>
<span>       select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">station</span>, <span class="va">sar</span>, <span class="va">gpd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     station      sar      gpd</span></span>
<span><span class="co">## 97 WADDKT04 11.81742 1.898136</span></span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">S_W</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity.html">sensitivity_area</a></span><span class="op">(</span>sar      <span class="op">=</span> <span class="fl">11.817</span>, </span>
<span>                        gpd      <span class="op">=</span> <span class="fl">1.90</span>,</span>
<span>                        r.seq    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="fl">11</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>                        d.seq    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># image of station sensitivity, white = extinct (D/K = NA)</span></span>
<span><span class="fu">image2D</span><span class="op">(</span>x <span class="op">=</span> <span class="va">S_W</span><span class="op">$</span><span class="va">r</span>, y <span class="op">=</span> <span class="va">S_W</span><span class="op">$</span><span class="va">d</span>, z<span class="op">=</span><span class="va">S_W</span><span class="op">$</span><span class="va">DK</span>, </span>
<span>        xlab <span class="op">=</span> <span class="st">"r, /yr"</span>, ylab <span class="op">=</span> <span class="st">"d, -"</span>, </span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Area sensitivity"</span>, </span>
<span>                 <span class="st">"WADDKT04"</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu">jet2.col</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, clab <span class="op">=</span> <span class="st">"D/K"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">S_W</span><span class="op">$</span><span class="va">r</span>, <span class="va">S_W</span><span class="op">$</span><span class="va">critical_d</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Species characteristics relating to fishgin for species in the MWTL data </span></span>
<span><span class="co"># (from package Btrait)</span></span>
<span><span class="va">SP_Fish</span>    <span class="op">&lt;-</span> <span class="va">MWTL</span><span class="op">$</span><span class="va">fishing</span></span>
<span></span>
<span><span class="co"># depletion for all MWTL species in station WADDKT04</span></span>
<span><span class="va">SP_Fish</span><span class="op">$</span><span class="va">dW</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_d</a></span><span class="op">(</span></span>
<span>          gpd    <span class="op">=</span> <span class="fl">1.90</span>, </span>
<span>          fDepth <span class="op">=</span> <span class="va">SP_Fish</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p0"</span>, <span class="st">"p0_5cm"</span>, <span class="st">"p5_15cm"</span>, <span class="st">"p15_30cm"</span>, <span class="st">"p30cm"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>          uDepth <span class="op">=</span>           <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">0</span>,    <span class="fl">0</span>,        <span class="fl">5</span>,         <span class="fl">15</span>,         <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">SP_Fish</span><span class="op">$</span><span class="va">r</span>, <span class="va">SP_Fish</span><span class="op">$</span><span class="va">dW</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">18</span>, col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, pch <span class="op">=</span> <span class="fl">18</span>, legend <span class="op">=</span> <span class="st">" MWTL species"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Bfiat_files/figure-html/unnamed-chunk-40-1.png" width="768"></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="fishing-impact-in-a-station-in-the-north-sea-friesefront">Fishing impact in a station in the North sea: FrieseFront<a class="anchor" aria-label="anchor" href="#fishing-impact-in-a-station-in-the-north-sea-friesefront"></a>
</h2>
<p>We now calculate the impact of bottom trawling on one station in the
Norths Sea, located in the FrieseFront, and part of the NIOZdata
dataset.</p>
<p>This station is located at 4.447 dgE and 53.667 dgN. It is 34 m deep,
and has a fine-sandy sediment with median grain size = 86
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">\mu m</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="density-and-biomass">Density and biomass<a class="anchor" aria-label="anchor" href="#density-and-biomass"></a>
</h3>
<p>To apply the fisheries model to this station, we first select the
<em>density</em> and <em>biomass</em> of the macrofauna. The biomasses
are in wet weight and called “biomass_ww”.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FF</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">get_density</span><span class="op">(</span>data       <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">density</span>,</span>
<span>              descriptor <span class="op">=</span> <span class="va">station</span>,</span>
<span>              subset     <span class="op">=</span> <span class="va">station</span> <span class="op">==</span> <span class="st">"FrieseFront"</span>,</span>
<span>              taxon      <span class="op">=</span> <span class="va">taxon</span>,</span>
<span>              value      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">density</span>, <span class="va">biomass_ww</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fishing-parameters">Fishing parameters<a class="anchor" aria-label="anchor" href="#fishing-parameters"></a>
</h3>
<p>To estimate fishing effects, we need, for each taxon, the living
depth (substratum depth distribution), and the age at maturity.</p>
<p>We first find the names, and meaning of the traits in the NIOZ trait
database (Traits_nioz, from package <em>Btrait</em>), and select the
traits relating to living depth and age at maturity:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">traits.lab</span>      <span class="op">&lt;-</span> <span class="fu">metadata</span><span class="op">(</span><span class="va">Traits_nioz</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># metadata of traits in database (name, value, ...)</span></span>
<span><span class="va">meta.depth</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">traits.lab</span>, </span>
<span>                         subset <span class="op">=</span> <span class="va">trait</span> <span class="op">==</span> <span class="st">"Substratum depth distribution"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta.maturity</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">traits.lab</span>, </span>
<span>                         subset <span class="op">=</span> <span class="va">trait</span> <span class="op">==</span> <span class="st">"Age at maturity"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select actual traits</span></span>
<span><span class="va">traits.depth</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Traits_nioz</span>, </span>
<span>                          select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">meta.depth</span><span class="op">$</span><span class="va">colname</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">traits.maturity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Traits_nioz</span>, </span>
<span>                          select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">meta.maturity</span><span class="op">$</span><span class="va">colname</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We then extract the traits for each species in the data, passing also
the taxonomic relationships. This allows the traits to be estimated also
for species that are not documented in the trait database. The taxonomy
has been obtained from the worms database, and is stored in
<em>NIOZdata$taxonomy</em>.</p>
<p>The trait database records the traits in fuzzy format. For the depth
distribution, we keep the data fuzzy, as some species may be found in
different depth levels.</p>
<p>As we need the <em>mean</em> age at maturity, we also pass the trait
class and value (argument trait_class, trait_score).</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NIOZdata</span><span class="op">$</span><span class="va">density</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Depth</span>    <span class="op">&lt;-</span> <span class="fu">get_trait</span><span class="op">(</span>taxon       <span class="op">=</span> <span class="va">taxa</span>, </span>
<span>                      trait       <span class="op">=</span> <span class="va">traits.depth</span>, </span>
<span>                      taxonomy    <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">taxonomy</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Depth</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">meta.depth</span><span class="op">$</span><span class="va">modality</span></span>
<span></span>
<span><span class="va">Maturity</span> <span class="op">&lt;-</span> <span class="fu">get_trait</span><span class="op">(</span>taxon       <span class="op">=</span> <span class="va">taxa</span>, </span>
<span>                      trait       <span class="op">=</span> <span class="va">traits.maturity</span>, </span>
<span>                      taxonomy    <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">taxonomy</span>, </span>
<span>                      trait_class <span class="op">=</span> <span class="va">meta.maturity</span><span class="op">$</span><span class="va">trait</span>,</span>
<span>                      trait_score <span class="op">=</span> <span class="va">meta.maturity</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Traits_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Depth</span>, <span class="va">Maturity</span><span class="op">)</span></span></code></pre></div>
<p>The age at maturity can now be used to estimate the intrinsic rate of
natural increase:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Traits_combined</span><span class="op">$</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_r</a></span><span class="op">(</span>age_at_maturity <span class="op">=</span> <span class="va">Traits_combined</span><span class="op">$</span><span class="va">Age.at.maturity</span><span class="op">)</span></span></code></pre></div>
<p>This information is merged with the data.frame that contains the
station-species information, where the common columns are the
“taxon”:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">FF</span>, <span class="va">Traits_combined</span>, </span>
<span>            by <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span></span></code></pre></div>
<p>For each station in the data set, the <em>Swept Area Ratio</em> (sar)
and estimated gear penetration depth (gpd), averaged over the years
2009-2017 is stored in the <em>NIOZdata$abiotics</em> table; the sar and
gpd for station FrieseFront is extracted and added to the parameter
file:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FF</span><span class="op">$</span><span class="va">sar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">NIOZdata</span><span class="op">$</span><span class="va">abiotics</span>, </span>
<span>                 subset <span class="op">=</span> <span class="va">station</span><span class="op">==</span><span class="st">"FrieseFront"</span><span class="op">)</span><span class="op">$</span><span class="va">sar</span></span>
<span><span class="va">FF</span><span class="op">$</span><span class="va">gpd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">NIOZdata</span><span class="op">$</span><span class="va">abiotics</span>, </span>
<span>                 subset <span class="op">=</span> <span class="va">station</span><span class="op">==</span><span class="st">"FrieseFront"</span><span class="op">)</span><span class="op">$</span><span class="va">gpd</span></span>
<span></span>
<span></span>
<span><span class="va">FF</span> <span class="op">&lt;-</span> <span class="va">FF</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">FF</span><span class="op">$</span><span class="va">density</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">FF</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>The <em>depletion</em> during trawling is estimated based on the
depth of occurrence.</p>
<p>The depletion rate can now be estimated, based on the sar (1.2392633)
and the gear penetration depth (2.1715897). We use the function
<em>par_d</em> to estimate the depletion rate.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fDepth</span>  <span class="op">&lt;-</span> <span class="va">FF</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"0-5"</span>, <span class="st">"5-15"</span>, <span class="st">"15-30"</span>, <span class="st">"&gt;30"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">uDepth</span>  <span class="op">&lt;-</span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0</span>,   <span class="fl">0</span>,     <span class="fl">5</span>,      <span class="fl">15</span>,      <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">FF</span><span class="op">$</span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_d</a></span><span class="op">(</span>gpd    <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">gpd</span>, <span class="co"># gear penetration depth</span></span>
<span>              fDepth <span class="op">=</span> <span class="va">fDepth</span>, <span class="co"># fractional occurrence in depth layers</span></span>
<span>              uDepth <span class="op">=</span> <span class="va">uDepth</span><span class="op">)</span> <span class="co"># upper depth of layers</span></span></code></pre></div>
<p>We can now estimate the species carrying capacity, using function
<em>par_K</em>.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FF</span><span class="op">$</span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_K</a></span><span class="op">(</span>density <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">density</span>, </span>
<span>              sar     <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">sar</span>, </span>
<span>              r       <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">r</span>, </span>
<span>              d       <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span></code></pre></div>
<p>The parameter file is now thinned, removing the columns we do not
need any further:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="st">"density"</span>, <span class="st">"biomass_ww"</span>, <span class="st">"K"</span>, <span class="st">"r"</span>, <span class="st">"d"</span>, <span class="st">"sar"</span><span class="op">)</span></span>
<span><span class="va">FF</span>     <span class="op">&lt;-</span> <span class="va">FF</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">FF</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span>,<span class="va">pnames</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">FF</span>, n<span class="op">=</span><span class="fl">6</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">1</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">taxon</th>
<th align="right">density</th>
<th align="right">biomass_ww</th>
<th align="right">K</th>
<th align="right">r</th>
<th align="right">d</th>
<th align="right">sar</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Abra</td>
<td align="right">81.2</td>
<td align="right">0.1</td>
<td align="right">83.1</td>
<td align="right">5.1</td>
<td align="right">0.1</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="left">Abra alba</td>
<td align="right">20.9</td>
<td align="right">0.3</td>
<td align="right">21.2</td>
<td align="right">5.1</td>
<td align="right">0.1</td>
<td align="right">1.2</td>
</tr>
<tr class="odd">
<td align="left">Abra nitida</td>
<td align="right">2.3</td>
<td align="right">0.1</td>
<td align="right">2.4</td>
<td align="right">5.1</td>
<td align="right">0.1</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="left">Abyssoninoe hibernica</td>
<td align="right">30.2</td>
<td align="right">0.5</td>
<td align="right">33.2</td>
<td align="right">0.7</td>
<td align="right">0.1</td>
<td align="right">1.2</td>
</tr>
<tr class="odd">
<td align="left">Ampelisca brevicornis</td>
<td align="right">2.3</td>
<td align="right">0.0</td>
<td align="right">2.4</td>
<td align="right">5.1</td>
<td align="right">0.1</td>
<td align="right">1.2</td>
</tr>
<tr class="even">
<td align="left">Amphiura filiformis</td>
<td align="right">429.2</td>
<td align="right">22.7</td>
<td align="right">524.5</td>
<td align="right">0.6</td>
<td align="right">0.1</td>
<td align="right">1.2</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="model-run">Model run<a class="anchor" aria-label="anchor" href="#model-run"></a>
</h3>
<p>The model is run for 40 years, where trawling occurs only the first
20 years. We specify the times at which a fishing event occurs and pass
this to the model function (<em>run_perturb</em>). The argument
<em>addsum</em>, when set equal to TRUE calculates the summed
densities.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># timings of the fishing events, based on sar</span></span>
<span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">FF</span><span class="op">$</span><span class="va">sar</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>              by   <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">FF</span><span class="op">$</span><span class="va">sar</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>              to   <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="va">times</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span>, length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run the model</span></span>
<span><span class="va">fish.FF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingfun.html">run_perturb</a></span><span class="op">(</span>parms        <span class="op">=</span> <span class="va">FF</span>, </span>
<span>                       times        <span class="op">=</span> <span class="va">times</span>, </span>
<span>                       sar          <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">sar</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                       tend_perturb <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                       addsum       <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>As the parameter file was ordered with respect to the species
density, it is easy to plot the density trajectory for the 8 most
abundant species (<em>which=1:8</em>); this is followed by the total
density.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Abundant</span> <span class="op">&lt;-</span> <span class="va">FF</span><span class="op">$</span><span class="va">taxon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">FF</span><span class="op">$</span><span class="va">K</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fish.FF</span>, </span>
<span>     which <span class="op">=</span> <span class="va">Abundant</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, </span>
<span>     ylab  <span class="op">=</span> <span class="st">"ind/m2"</span>, </span>
<span>     xlab  <span class="op">=</span> <span class="st">"year"</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fish.FF</span>, </span>
<span>     which <span class="op">=</span> <span class="st">"sum"</span>, </span>
<span>     ylab  <span class="op">=</span> <span class="st">"ind/m2"</span>, </span>
<span>     xlab  <span class="op">=</span> <span class="st">"year"</span>, </span>
<span>     las<span class="op">=</span><span class="fl">1</span>, mfrow<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>  <span class="co"># mforw=NULL to prevent it from starting a new figure</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-52-1.png" alt="Fishing impact on the density of the 8 most abundant species, and the total density in station FrieseFront; 20 years of fishing followed by 20 years without fishing." width="768"><p class="caption">
Fishing impact on the density of the 8 most abundant species, and the
total density in station FrieseFront; 20 years of fishing followed by 20
years without fishing.
</p>
</div>
<p>Using the previous model run, we estimate the impact of trawling on
suspension feeders.</p>
<p>We first extract the modality “Suspension feeder” from the nioz trait
database:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta.susp</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span>
<span>                    <span class="fu">metadata</span><span class="op">(</span><span class="va">Traits_nioz</span><span class="op">)</span>, </span>
<span>                    subset<span class="op">=</span> <span class="op">(</span><span class="va">modality</span> <span class="op">==</span> <span class="st">"Suspension feeder"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">traits.susp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Traits_nioz</span>, </span>
<span>                      select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">meta.susp</span><span class="op">$</span><span class="va">colname</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">traits.susp</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"SuspensionFeeder"</span></span></code></pre></div>
<p>The nioz trait database stores the trait modalities in fuzzy format,
so the data record the fractional contribution of suspension feeding to
the diet of each species:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">traits.susp</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   taxon SuspensionFeeder</span></span>
<span><span class="co">## 1          Abludomelita              0.0</span></span>
<span><span class="co">## 2 Abludomelita obtusata              0.0</span></span>
<span><span class="co">## 3             Abra alba              0.5</span></span></code></pre>
<p>We now calculate the degree to which suspension feeding changes in
the community, using the function <em>get_trait_model</em>. For those
species in the model whose suspension feeding is not known, we use the
taxonomic closeness to find good values; this is simply done by passing
data.frame <em>Taxonomy</em>.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">susp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTraitModel.html">get_trait_model</a></span><span class="op">(</span>model    <span class="op">=</span> <span class="va">fish.FF</span>, </span>
<span>                         trait    <span class="op">=</span> <span class="va">traits.susp</span>, </span>
<span>                         taxonomy <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">taxonomy</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">susp1</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Relative abundance suspension feeders"</span>, ylab <span class="op">=</span> <span class="st">"-"</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Bfiat_files/figure-html/unnamed-chunk-55-1.png" width="700"></p>
<p>The bioturbation potential can be easily estimated by passing the
correct database to the function <em>get_Db_model</em>. For this
function, we also need the mean weight of the species which is
calculated first (<em>WW</em>).</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">WW</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxon <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">taxon</span>, </span>
<span>                 W     <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">biomass_ww</span><span class="op">/</span><span class="va">FF</span><span class="op">$</span><span class="va">density</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Db.FF</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getDbModel.html">get_Db_model</a></span><span class="op">(</span>model    <span class="op">=</span> <span class="va">fish.FF</span>, </span>
<span>                      trait    <span class="op">=</span> <span class="va">Traits_Db</span>, </span>
<span>                      taxonomy <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">taxonomy</span>, </span>
<span>                      weight   <span class="op">=</span> <span class="va">WW</span>, </span>
<span>                      na.rm    <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># removes those species where W is NA</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Db.FF</span>, </span>
<span>     which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"BPc"</span> , <span class="va">Abundant</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span>,</span>
<span>     ylab  <span class="op">=</span> <span class="st">"BPc, -"</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Db.FF</span>, </span>
<span>     which <span class="op">=</span> <span class="st">"BPc"</span>, </span>
<span>     ylab  <span class="op">=</span> <span class="st">"-"</span>, </span>
<span>     las <span class="op">=</span> <span class="fl">1</span>, mfrow <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Bfiat_files/figure-html/unnamed-chunk-57-1.png" alt="Fishing impact on the contribution to the bioturbation potential of the main species, and the total bioturbation potential in station FrieseFront; 20 years of fishing followed by 20 years without fishing." width="768"><p class="caption">
Fishing impact on the contribution to the bioturbation potential of the
main species, and the total bioturbation potential in station
FrieseFront; 20 years of fishing followed by 20 years without fishing.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>This product was created under the European Marine Observation Data
Network (EMODnet) Biology Phase V. Additional support came from the
NWO-funded project BFIAT (NWO 18523).</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Beauchard O, Brind’Amour A, Schratzberger M, Laffargue P, Hintzen NT,
Somerfield PJ, Piet G (2021) A generic approach to develop a trait-based
indicator of trawling-induced disturbance. Mar Ecol Prog Ser 675:35-52.
<a href="https://doi.org/10.3354/meps13840" class="external-link uri">https://doi.org/10.3354/meps13840</a></p>
<p>Beauchard, O., Murray S.A. Thompson, Kari Elsa Ellingsen, Gerjan
Piet, Pascal Laffargue, Karline Soetaert, 2023. Assessing sea floor
functional diversity and vulnerability. Marine Ecology Progress Serie
v708, p21-43, <a href="https://www.int-res.com/abstracts/meps/v708/p21-43/" class="external-link uri">https://www.int-res.com/abstracts/meps/v708/p21-43/</a></p>
<p>Chamberlain S, Vanhoorne. B (2023). worrms: World Register of Marine
Species (WoRMS) Client. R package version 0.4.3, <a href="https://CRAN.R-project.org/package=worrms" class="external-link uri">https://CRAN.R-project.org/package=worrms</a>.</p>
<p>Hiddink, JG, Jennings, S, Sciberras, M, et al. Assessing bottom
trawling impacts based on the longevity of benthic invertebrates. J Appl
Ecol. 2019; 56: 1075– 1084. <a href="https://doi.org/10.1111/1365-2664.13278" class="external-link uri">https://doi.org/10.1111/1365-2664.13278</a></p>
<p>Hiddink, Jan Geert, Simon Jennings, Marija Sciberras, Claire L.
Szostek, Kathryn M. Hughes, Nick Ellis, Adriaan D. Rijnsdorp, Robert A.
McConnaughey, Tessa Mazor, Ray Hilborn, Jeremy S. Collie, C. Roland
Pitcher, Ricardo O. Amoroso, Ana M. Parma, Petri Suuronen, and Michel J.
Kaiser, 2017. Global analysis of depletion and recovery of seabed biota
after bottom trawling disturbance. Proc. Nat. Aca. Sci, 114 (31)
8301-8306. <a href="https://doi.org/10.1073/pnas.161885811" class="external-link uri">https://doi.org/10.1073/pnas.161885811</a>.</p>
<p>Queiros, A. M., S. N. R. Birchenough, J Bremner, J.A. Godbold, R.E.
Parker, A. Romero-Ramirez, H. Reiss, M. Solan, P. J. Somerfield, C. Van
Colen, G. Van Hoey, S. Widdicombe, 2013. A bioturbation classification
of European marine infaunal invertebrates. Ecology and Evolution 3 (11),
3958-3985</p>
<p>Wrede, A., J.Beermann, J.Dannheim, L.Gutow, T.Brey, 2018. Organism
functional traits and ecosystem supporting services - A novel approach
to predict bioirrigation. Ecological indicators, 91, 737-743.</p>
<p>Soetaert K, Beauchard O (2024). R-package Btrait: Working with
Biological density, taxonomy, and trait composition data. Netherlands
Institute of Sea Research. Data product created under the European
Marine Observation Data Network (EMODnet) Biology Phase IV.</p>
<p>Karline Soetaert, Olivier Beauchard (2024). Bfiat: Bottom Fishing
Impact Assessment Tool. Data product created under the European Marine
Observation Data Network (EMODnet) Biology Phase V.</p>
<p>R Core Team (2021). R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria. URL
<a href="https://www.R-project.org/" class="external-link uri">https://www.R-project.org/</a>.</p>
<p>C.R. Pitcher, J.G. Hiddink, S. Jennings, J. Collie, A.M. Parma, R.
Amoroso, T. Mazor, M. Sciberras, R.A. McConnaughey, A.D. Rijnsdorp, M.J.
Kaiser, P. Suuronen, and R. Hilborn, 2022. Trawl impacts on the relative
status of biotic communities of seabed sedimentary habitats in 24
regions worldwide. PNAS. <a href="https://doi.org/10.1073/pnas.2109449119" class="external-link uri">https://doi.org/10.1073/pnas.2109449119</a></p>
<p>C.R. Pitcher, N. Ellis, S. Jennings, J.G. Hiddink, T. Mazor,
M.J.Kaiser, M.I. Kangas, R.A. McConnaughey, A.M. Parma, A.D. Rijnsdorp,
P. Suuronen, J.S. Collie, R. Amoroso, K.M. Hughes and R. Hilborn, 2017.
Estimating the sustainability of towed fishing-gearimpacts on seabed
habitats: a simple quantitative riskassessment method applicable to
data-limited fisheries. Methods in Ecology and
Evolution2017,8,472–480doi: 10.1111/2041-210X.12705</p>
<p>J. Depestele, K. Degrendele, M. Esmaeili, A. Ivanovic, S. Kroger,
F.G. O’Neill, R. Parker, H. Polet, M. Roche, L.R. Teal, B. Vanelslander,
A.D. Rijnsdorp. (2018). Comparison of mechanical disturbance in soft
sediments due to tickler-chain SumWing trawl versus electro-fitted
PulseWing trawl. ICES J. Mar. Sci. 76, 312–329.</p>
</div>
<div class="section level2">
<h2 id="appendices">Appendices<a class="anchor" aria-label="anchor" href="#appendices"></a>
</h2>
<div class="section level3">
<h3 id="list-of-all-functions-and-data-sets-in-bfiat">List of all functions and data sets in Bfiat:<a class="anchor" aria-label="anchor" href="#list-of-all-functions-and-data-sets-in-bfiat"></a>
</h3>
<pre><code><span><span class="fu"><a href="../reference/critical.html">critical_d</a></span> <span class="op">(</span>sar <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">0.1</span>, crit_DK <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/critical.html">critical_gpd</a></span> <span class="op">(</span>sar <span class="op">=</span> <span class="fl">1</span>, fDepth <span class="op">=</span> <span class="fl">1</span>, uDepth <span class="op">=</span> <span class="fl">0</span>, d <span class="op">=</span> <span class="cn">NULL</span>, r <span class="op">=</span> <span class="fl">0.1</span>,  </span>
<span> crit_DK <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/critical.html">critical_r</a></span> <span class="op">(</span>sar <span class="op">=</span> <span class="fl">1</span>, gpd <span class="op">=</span> <span class="fl">1</span>, fDepth <span class="op">=</span> <span class="fl">1</span>, uDepth <span class="op">=</span> <span class="fl">0</span>, d <span class="op">=</span> <span class="cn">NULL</span>,  </span>
<span> crit_DK <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/critical.html">critical_sar</a></span> <span class="op">(</span>gpd <span class="op">=</span> <span class="fl">1</span>, fDepth <span class="op">=</span> <span class="fl">1</span>, uDepth <span class="op">=</span> <span class="fl">0</span>, d <span class="op">=</span> <span class="cn">NULL</span>, r <span class="op">=</span> <span class="fl">0.1</span>,  </span>
<span> crit_DK <span class="op">=</span> <span class="fl">0</span>, <span class="va">...</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/density.html">density_logistic</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> m <span class="op">=</span> <span class="va">m</span><span class="op">)</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> times <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,  </span>
<span> as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/density.html">density_metier</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>,  </span>
<span> <span class="fl">0.1</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span>  </span>
<span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/density.html">density_perturb</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fl">1</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> times <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,  </span>
<span> as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/getDbModel.html">get_Db_model</a></span> <span class="op">(</span><span class="va">model</span>, trait <span class="op">=</span> <span class="fu">Btrait</span><span class="fu">::</span><span class="va"><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_Db</a></span>, taxon_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  </span>
<span> taxonomy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">weight</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/getDbModel.html">get_irr_model</a></span> <span class="op">(</span><span class="va">model</span>, trait <span class="op">=</span> <span class="fu">Btrait</span><span class="fu">::</span><span class="va"><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_irr</a></span>, taxon_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,  </span>
<span> taxonomy <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">weight</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/getTraitModel.html">get_trait_model</a></span> <span class="op">(</span><span class="va">model</span>, <span class="va">trait</span>, trait_class <span class="op">=</span> <span class="cn">NULL</span>, trait_score <span class="op">=</span> <span class="cn">NULL</span>,  </span>
<span> taxon_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, taxonomy <span class="op">=</span> <span class="cn">NULL</span>, taxon_column <span class="op">=</span> <span class="fl">1</span>,  </span>
<span> scalewithvalue <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="va">NIOZdata</span> <span class="op">:</span> <span class="va">dataset</span></span>
<span></span>
<span><span class="fu"><a href="../reference/trawlingpars.html">par_d</a></span> <span class="op">(</span>gpd <span class="op">=</span> <span class="fl">1</span>, m_d <span class="op">=</span> <span class="fl">0.055</span>, m_max <span class="op">=</span> <span class="fl">0.42</span>, <span class="va">fDepth</span>, <span class="va">uDepth</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/trawlingpars.html">par_K</a></span> <span class="op">(</span><span class="va">density</span>, <span class="va">sar</span>, <span class="va">r</span>, <span class="va">d</span>, t_density <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/trawlingpars.html">par_m</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">r</span>, <span class="va">K</span>, <span class="va">d</span>, refD <span class="op">=</span> <span class="va">K</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/trawlingpars.html">par_r</a></span> <span class="op">(</span>age_at_maturity <span class="op">=</span> <span class="cn">NULL</span>, longevity <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/trawlingfun.html">run_logistic</a></span> <span class="op">(</span><span class="va">parms</span>, <span class="va">times</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,  </span>
<span> taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, addsum <span class="op">=</span> <span class="cn">FALSE</span>,  </span>
<span> verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/trawlingfun.html">run_perturb</a></span> <span class="op">(</span><span class="va">parms</span>, <span class="va">times</span>, sar <span class="op">=</span> <span class="fl">1</span>, tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span>  </span>
<span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, events <span class="op">=</span> <span class="cn">NULL</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>,  </span>
<span> D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, addsum <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="va">SAR</span> <span class="op">:</span> <span class="va">dataset</span></span>
<span></span>
<span><span class="fu"><a href="../reference/sensitivity.html">sensitivity_area</a></span> <span class="op">(</span>sar <span class="op">=</span> <span class="fl">1</span>, gpd <span class="op">=</span> <span class="fl">1</span>, r.seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,  </span>
<span> d.seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/sensitivity.html">sensitivity_taxon</a></span> <span class="op">(</span>fDepth <span class="op">=</span> <span class="fl">1</span>, uDepth <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="fl">0.1</span>, sar.seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>,  </span>
<span> length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>, gpd.seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,  </span>
<span> <span class="va">...</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/steadydensity.html">steady_logistic</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> m <span class="op">=</span> <span class="va">m</span><span class="op">)</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/steadydensity.html">steady_metier</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>,  </span>
<span> <span class="fl">0.1</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/steadydensity.html">steady_perturb</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fl">1</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/trawlingdensity.html">trawl_metier</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>, d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>,  </span>
<span> <span class="fl">0.1</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  </span>
<span> </span>
<span><span class="fu"><a href="../reference/trawlingdensity.html">trawl_perturb</a></span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,  </span>
<span> d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fl">1</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  </span>
<span> </span></code></pre>
</div>
<div class="section level3">
<h3 id="estimating-mean-life-span-from-fuzzy-coded-values">Estimating mean Life-span from fuzzy coded values<a class="anchor" aria-label="anchor" href="#estimating-mean-life-span-from-fuzzy-coded-values"></a>
</h3>
<p>To calculate the rate of increase, we need the average life span of
the organism. In many trait databases this characteristic is fuzzy
coded, i.e. a taxon may belong to multiple modalities.</p>
<p>This is the case for the nioz trait database (<em>Traits_nioz</em>).
To convert the data to crisp format, we first need to find the name of
the trait that captures life span.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NIOZ_att</span> <span class="op">&lt;-</span> <span class="fu">metadata</span><span class="op">(</span><span class="va">Traits_nioz</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">NIOZ_att</span><span class="op">$</span><span class="va">trait</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "Substratum depth distribution"    "Biodiffusion"                    </span></span>
<span><span class="co">##  [3] "Downward conveying"               "Upward conveying"                </span></span>
<span><span class="co">##  [5] "Regeneration"                     "Biodeposition"                   </span></span>
<span><span class="co">##  [7] "Bioerosion"                       "Biostabilisation"                </span></span>
<span><span class="co">##  [9] "Ventilation/Pumping"              "Burrow width"                    </span></span>
<span><span class="co">## [11] "Endo-3D structure type"           "Endo-3D structure depth"         </span></span>
<span><span class="co">## [13] "Epi-3D structure type"            "Epi-3D structure extension"      </span></span>
<span><span class="co">## [15] "Epi-3D structure size"            "Body mass"                       </span></span>
<span><span class="co">## [17] "Body length"                      "Body resistance"                 </span></span>
<span><span class="co">## [19] "Motility"                         "Burrowing/Sheltering depth"      </span></span>
<span><span class="co">## [21] "Feeding type"                     "Life span"                       </span></span>
<span><span class="co">## [23] "Age at maturity"                  "Reproductive frequency"          </span></span>
<span><span class="co">## [25] "Fertilisation"                    "Annual fecundity"                </span></span>
<span><span class="co">## [27] "Offspring type"                   "Offspring size"                  </span></span>
<span><span class="co">## [29] "Offspring protection"             "Offspring development"           </span></span>
<span><span class="co">## [31] "Offspring benthic stage duration" "Offspring pelagic stage duration"</span></span></code></pre>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LSatt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">NIOZ_att</span>, subset<span class="op">=</span><span class="va">trait</span><span class="op">==</span><span class="st">"Life span"</span><span class="op">)</span></span>
<span><span class="va">LSatt</span></span></code></pre></div>
<pre><code><span><span class="co">##    colname     trait modality indic value score units</span></span>
<span><span class="co">## 92  RT7.M1 Life span       &lt;1     7   0.5  0.00  year</span></span>
<span><span class="co">## 93  RT7.M2 Life span      1-3     7   2.0  0.25  year</span></span>
<span><span class="co">## 94  RT7.M3 Life span     3-10     7   6.5  0.50  year</span></span>
<span><span class="co">## 95  RT7.M4 Life span    10-20     7  15.0  0.75  year</span></span>
<span><span class="co">## 96  RT7.M5 Life span      &gt;20     7  30.0  1.00  year</span></span></code></pre>
<p>The column names of lifespan traits in the nioz database are in
LS$colname. They are, together with the taxon name extracted from the
database:</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LS</span> <span class="op">&lt;-</span> <span class="va">Traits_nioz</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">LSatt</span><span class="op">$</span><span class="va">colname</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">LS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   taxon RT7.M1 RT7.M2 RT7.M3 RT7.M4 RT7.M5</span></span>
<span><span class="co">## 1          Abludomelita      1      0      0      0      0</span></span>
<span><span class="co">## 2 Abludomelita obtusata      1      0      0      0      0</span></span>
<span><span class="co">## 3             Abra alba      0      1      0      0      0</span></span>
<span><span class="co">## 4           Abra nitida      0      1      0      0      0</span></span>
<span><span class="co">## 5       Abra prismatica      0      1      0      0      0</span></span>
<span><span class="co">## 6           Abra tenuis      0      1      0      0      0</span></span></code></pre>
<p>We now calculate the average life span using function
<em>get_trait</em>. By passing the “trait_class” and “trait_score”, the
averages are estimated. We also pass the taxonomic tree of these data,
so that the lifespan of taxa for which this is unknown is estimated
based on taxonomic closeness.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MeanLS</span> <span class="op">&lt;-</span> <span class="fu">get_trait</span><span class="op">(</span>taxon       <span class="op">=</span> <span class="va">FF</span><span class="op">$</span><span class="va">taxon</span>,</span>
<span>                    trait       <span class="op">=</span> <span class="va">LS</span>,</span>
<span>                    trait_class <span class="op">=</span> <span class="va">LSatt</span><span class="op">$</span><span class="va">trait</span>,</span>
<span>                    trait_score <span class="op">=</span> <span class="va">LSatt</span><span class="op">$</span><span class="va">value</span>,</span>
<span>                    taxonomy    <span class="op">=</span> <span class="va">NIOZdata</span><span class="op">$</span><span class="va">taxonomy</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">MeanLS</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   taxon Life.span</span></span>
<span><span class="co">## 1                  Abra     2.000</span></span>
<span><span class="co">## 2             Abra alba     2.000</span></span>
<span><span class="co">## 3           Abra nitida     2.000</span></span>
<span><span class="co">## 4 Abyssoninoe hibernica     9.625</span></span>
<span><span class="co">## 5 Ampelisca brevicornis     2.000</span></span>
<span><span class="co">## 6   Amphiura filiformis    15.000</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
