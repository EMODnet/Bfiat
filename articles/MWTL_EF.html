<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>R-package Bfiat - Modelling trawling effects on ecosystem functioning - MWTL data • Bfiat</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="R-package Bfiat - Modelling trawling effects on ecosystem functioning - MWTL data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Bfiat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">How To</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to">
<li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/Bfiat.html">Description</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples-of-use" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples of use</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples-of-use">
<li><a class="dropdown-item" href="../articles/MWTL.html">The dutch monitoring data - fishing impact on density</a></li>
    <li><a class="dropdown-item" href="../articles/MWTL_EF.html">The dutch monitoring - fishing impact on ecosystem functioning</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://emodnet.github.io/Bfiat/"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>R-package Bfiat - Modelling trawling effects on ecosystem functioning - MWTL data</h1>
                        <h4 data-toc-skip class="author">Karline
Soetaert and Olivier Beauchard</h4>
            
            <h4 data-toc-skip class="date">current 25 July, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/EMODnet/Bfiat/vignettes/MWTL_EF.Rmd" class="external-link"><code>vignettes/MWTL_EF.Rmd</code></a></small>
      <div class="d-none name"><code>MWTL_EF.Rmd</code></div>
    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      The impact of bottom trawling on sediment ecosystem functions in
      the Dutch part of the Northsea is estimated. We use monitoring
      data from 103 stations in the area (MWTL data set), and impose
      fishing intensities estimated for each of these stations. We then
      use the output of the fishing model to estimate the effect of
      fishing on the bioturbation and bioirrigation in these stations.
    </div>
    
<div class="section level2">
<h2 id="software-">Software.<a class="anchor" aria-label="anchor" href="#software-"></a>
</h2>
<p>The fishing impact models run in the open source framework <em>R</em>
(R core team, 2025) and have been implemented in the <em>Bfiat</em>
R-package (Soetaert and Beauchard, 2024).</p>
<p>The R-package <em>Btrait</em> (Soetaert and Beauchard, 2022) contains
functions to work on density and trait datasets.</p>
<p>The packages <em>Btrait</em> and <em>Bfiat</em> are available on
github (<a href="https://github.com/EMODnet/Btrait" class="external-link uri">https://github.com/EMODnet/Btrait</a> and <a href="https://github.com/EMODnet/Bfiat" class="external-link uri">https://github.com/EMODnet/Bfiat</a>).</p>
</div>
<div class="section level2">
<h2 id="data-requirements">Data requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h2>
<p>Central in the impact analysis is the merging of model output with
trait data</p>
<div class="section level3">
<h3 id="species-specific-density-trajectories">species-specific density trajectories<a class="anchor" aria-label="anchor" href="#species-specific-density-trajectories"></a>
</h3>
<p>The impact of fishing on ecosystem functions uses as input the
density trajectories of species, under fishing pressure. These density
trajectories can be obtained with function <em>density_perturb</em> from
the Bfiat package. In the vignette <em>MWTL</em>, it is described how
this can be done for the MWTL dataset.</p>
</div>
<div class="section level3">
<h3 id="trait-characteristics-of-the-benthic-species-">trait characteristics of the benthic species.<a class="anchor" aria-label="anchor" href="#trait-characteristics-of-the-benthic-species-"></a>
</h3>
<ul>
<li>The reworking
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>i</mi></msub><annotation encoding="application/x-tex">R_i</annotation></semantics></math>)
and mobility mode
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>M</mi><mi>i</mi></msub><annotation encoding="application/x-tex">M_i</annotation></semantics></math>)
of species, as well as their weight
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>i</mi></msub><annotation encoding="application/x-tex">W_i</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">density</annotation></semantics></math>,
is used to estimate their “bioturbation potential”, a parameter that
determines sediment mixing.</li>
</ul>
<p>The formula for estimating the bioturbation Index for taxon i (as in
Querios et al., 2013) is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>P</mi><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msqrt><mi>(</mi></msqrt><msub><mi>W</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>⋅</mo><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>R</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>M</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">BPc_i = \sqrt(W_i)  \cdot  density_i  \cdot  R_i  \cdot  M_i</annotation></semantics></math></p>
<ul>
<li>The feeding type,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">FT_i</annotation></semantics></math>,
burrowing type,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">BT_i</annotation></semantics></math>,
injection
depth<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><msub><mi>D</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">ID_i</annotation></semantics></math>,
combined with the species mean weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>i</mi></msub><annotation encoding="application/x-tex">W_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">density</annotation></semantics></math>,
is used to estimate the species’ “bioirrigation potential”, which
reflects the intensity at which burrows are flushed.</li>
</ul>
<p>The formula for estimating the bioirrigation Index for taxon i (as in
Wrede et al., 2018) is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>P</mi><msub><mi>c</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>W</mi><mi>i</mi><mn>0.75</mn></msubsup><mo>⋅</mo><mi>d</mi><mi>e</mi><mi>n</mi><mi>s</mi><mi>i</mi><mi>t</mi><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mi>B</mi><msub><mi>T</mi><mi>i</mi></msub><mo>⋅</mo><mi>F</mi><msub><mi>T</mi><mi>i</mi></msub><mo>⋅</mo><mi>I</mi><msub><mi>D</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">IPc_i = W_i^{0.75}  \cdot  density_i  \cdot  BT_i  \cdot FT_i \cdot ID_i</annotation></semantics></math>,</p>
<p>Several trait databases are available from the R-package
<em>Btrait</em>.</p>
<ul>
<li><p>The traits required for calculating the bioturbation potential
(<em>Traits_Db</em>) were compiled in Queiros et al. (2013).</p></li>
<li><p>Traits to estimate bioirrigation potential (<em>Traits_irr</em>)
were described in Wrede et al. (2018); they were derived from the
<em>Traits_nioz</em> dataset.</p></li>
</ul>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="running-the-fishing-impact-model">Running the fishing impact model<a class="anchor" aria-label="anchor" href="#running-the-fishing-impact-model"></a>
</h2>
<p>The code to run the model for all 102 MWTL stations at once is given
below.</p>
<p>The how and why is in another vignette: MWTL_fishing</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#### taxon density ####</span></span>
<span><span class="va">MeanMWTL</span> <span class="op">&lt;-</span> <span class="fu">get_density</span><span class="op">(</span>data <span class="op">=</span> <span class="va">MWTL</span><span class="op">$</span><span class="va">density</span>, descriptor <span class="op">=</span> <span class="va">station</span>, taxon <span class="op">=</span> <span class="va">taxon</span>, </span>
<span>                        value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">density</span>, <span class="va">biomass</span><span class="op">)</span>, averageOver <span class="op">=</span> <span class="va">year</span><span class="op">)</span></span>
<span><span class="va">MWTLtaxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">MeanMWTL</span><span class="op">$</span><span class="va">taxon</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co">#### taxon traits ####</span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu">metadata</span><span class="op">(</span><span class="va">Traits_nioz</span><span class="op">)</span>   <span class="co"># description of trait modalities</span></span>
<span></span>
<span><span class="co">#  *substratum depth*, fuzzy coded</span></span>
<span><span class="va">subD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">meta</span>, subset <span class="op">=</span> <span class="op">(</span><span class="va">trait</span> <span class="op">==</span> <span class="st">"Substratum depth distribution"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TraitsDD</span> <span class="op">&lt;-</span> <span class="fu">get_trait</span><span class="op">(</span>taxon <span class="op">=</span> <span class="va">MWTLtaxa</span>, taxonomy <span class="op">=</span> <span class="va">Taxonomy</span>, </span>
<span>                      trait <span class="op">=</span> <span class="va">Traits_nioz</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">subD</span><span class="op">$</span><span class="va">colname</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">TraitsDD</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">subD</span><span class="op">$</span><span class="va">modality</span></span>
<span></span>
<span><span class="co"># *age at maturity*, averaged</span></span>
<span><span class="va">subA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">meta</span>, subset <span class="op">=</span> <span class="op">(</span><span class="va">trait</span> <span class="op">==</span> <span class="st">"Age at maturity"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TraitsAAM</span> <span class="op">&lt;-</span> <span class="fu">get_trait</span><span class="op">(</span>taxon <span class="op">=</span> <span class="va">MWTLtaxa</span>, taxonomy <span class="op">=</span> <span class="va">Taxonomy</span>, </span>
<span>                       trait <span class="op">=</span> <span class="va">Traits_nioz</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">subA</span><span class="op">$</span><span class="va">colname</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                       trait_class <span class="op">=</span> <span class="va">subA</span><span class="op">$</span><span class="va">trait</span>, trait_score <span class="op">=</span> <span class="va">subA</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### merge with fisheries data ####</span></span>
<span><span class="va">TraitsAll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">TraitsAAM</span>, <span class="va">TraitsDD</span>, by <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span></span>
<span><span class="va">MWTLtrait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">MeanMWTL</span>, <span class="va">TraitsAll</span>, by <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span></span>
<span><span class="va">MWTLtrait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">MWTLtrait</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">abiotics</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">station</span>, <span class="va">sar</span>, <span class="va">gpd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   by <span class="op">=</span> <span class="st">"station"</span><span class="op">)</span></span>
<span><span class="va">MWTLtrait</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">MWTLtrait</span>, subset <span class="op">=</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Age.at.maturity</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### model parameters ####</span></span>
<span><span class="co"># intrinsic rate of natural increase </span></span>
<span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_r</a></span><span class="op">(</span>age_at_maturity <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">Age.at.maturity</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># depletion fraction (d)</span></span>
<span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_d</a></span><span class="op">(</span>gpd <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">gpd</span>, </span>
<span>                     fDepth <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"0"</span>, <span class="st">"0-5"</span>, <span class="st">"5-15"</span>, <span class="st">"15-30"</span>, <span class="st">"&gt;30"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                     uDepth <span class="op">=</span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">0</span>,     <span class="fl">0</span>,     <span class="fl">5</span>,      <span class="fl">15</span>,    <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># carrying capacity (K)</span></span>
<span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trawlingpars.html">par_K</a></span><span class="op">(</span>density <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">density</span>, sar <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">sar</span>,</span>
<span>                     r <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">r</span>, d <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove taxa where the model cannot find a solution (few taxa)</span></span>
<span><span class="va">ii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">K</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span> <span class="op">(</span><span class="st">"the number of occurrences removed (not compatible with model) is:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ii</span><span class="op">)</span>,</span>
<span>     <span class="st">"from a total of "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MWTLtrait</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## the number of occurrences removed (not compatible with model) is: 16 from a total of  8271</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MWTLtrait</span> <span class="op">&lt;-</span> <span class="va">MWTLtrait</span><span class="op">[</span><span class="op">-</span><span class="va">ii</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">#### run the model, 20 years fishing, followed by 10 years without fishing ####</span></span>
<span><span class="va">taxon_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">station</span>, <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">taxon</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">times</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">30</span>, length.out <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="va">densFishing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/density.html">density_perturb</a></span><span class="op">(</span>parms        <span class="op">=</span> <span class="va">MWTLtrait</span>, </span>
<span>                               times        <span class="op">=</span> <span class="va">times</span>, </span>
<span>                               taxon_names  <span class="op">=</span> <span class="va">taxon_names</span>,</span>
<span>                               tend_perturb <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>  </span></code></pre></div>
<div class="section level3">
<h3 id="the-bioturbation-and-bio-irrigation-potential">The bioturbation and bio-irrigation potential<a class="anchor" aria-label="anchor" href="#the-bioturbation-and-bio-irrigation-potential"></a>
</h3>
<p>The functions <em>get_Db_model</em> and <em>get_irr_model</em>
estimate the bioturbation and bio-irrigation potential based on dynamic
model output for the species. They require the <em>trait</em>
information, and the individual <em>weight</em> of the species. The
<em>taxonomy</em> is passed to allow retrieving traits for undocumented
species based on their taxonomic relationships. Argument
<em>taxon_names</em> assigns each column in the model output to a
species that can be located in the trait database or in the
taxonomy.</p>
<p>First the mean weight is estimated based on biomass and density:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate the weight</span></span>
<span><span class="va">MWTLtrait</span><span class="op">$</span><span class="va">WW</span> <span class="op">&lt;-</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">biomass</span> <span class="op">/</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">density</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>   <span class="va">Db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getDbModel.html">get_Db_model</a></span><span class="op">(</span>model       <span class="op">=</span> <span class="va">densFishing</span>,</span>
<span>                      trait       <span class="op">=</span> <span class="va">Traits_Db</span>, </span>
<span>                      taxon_names <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">taxon</span>,</span>
<span>                      taxonomy    <span class="op">=</span> <span class="va">Taxonomy</span>, </span>
<span>                      weight      <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">WW</span><span class="op">)</span></span>
<span><span class="op">)</span>  </span></code></pre></div>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##   1.521   0.254   1.776</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">Irr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getDbModel.html">get_irr_model</a></span><span class="op">(</span>model       <span class="op">=</span> <span class="va">densFishing</span>,</span>
<span>                      trait       <span class="op">=</span> <span class="va">Traits_irr</span>, </span>
<span>                      taxon_names <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">taxon</span>,</span>
<span>                      taxonomy    <span class="op">=</span> <span class="va">Taxonomy</span>, </span>
<span>                      weight      <span class="op">=</span> <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">WW</span><span class="op">)</span></span></code></pre></div>
<p>The results have in their first column, time, followed by the BPc or
IPc contribution of all species, and the last column is the sum of all
these indices. We strip the output from the first and last column and
then sum the indices, per station, for all times, to obtain the total
BPc and IPc per station:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DB</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Db</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Db</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>  <span class="co"># remove first and last column</span></span>
<span><span class="va">DBC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split.default</a></span><span class="op">(</span><span class="va">DB</span>, <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">station</span><span class="op">)</span>, <span class="co"># split in stations</span></span>
<span>              FUN <span class="op">=</span> <span class="va">rowSums</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>         <span class="co"># take row sums</span></span>
<span></span>
<span><span class="va">IR</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Irr</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Irr</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">IR</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split.default</a></span><span class="op">(</span><span class="va">IR</span>, <span class="va">MWTLtrait</span><span class="op">$</span><span class="va">station</span><span class="op">)</span>, </span>
<span>              FUN <span class="op">=</span> <span class="va">rowSums</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We then create relative values by dividing all columns by the
maximum, and plot the results.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Dbrel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">DBC</span>, </span>
<span>               MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>               STATS  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">DBC</span>,            <span class="co"># max of each column</span></span>
<span>                              MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                              FUN    <span class="op">=</span> <span class="va">max</span><span class="op">)</span>, </span>
<span>               FUN    <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span>                  <span class="co"># divide by the max</span></span>
<span><span class="va">Irrrel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">IR</span>, </span>
<span>               MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>               STATS  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">IR</span>, </span>
<span>                              MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                              FUN    <span class="op">=</span> <span class="va">max</span><span class="op">)</span>, </span>
<span>               FUN    <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># dB reduction -  the larger the value the more bioturbation is impacted</span></span>
<span><span class="va">Dbred</span>   <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Dbrel</span>, </span>
<span>                     MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                     FUN    <span class="op">=</span> <span class="va">min</span><span class="op">)</span></span>
<span><span class="va">Irrred</span>  <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Irrrel</span>, </span>
<span>                     MARGIN <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                     FUN    <span class="op">=</span> <span class="va">min</span><span class="op">)</span></span>
<span></span>
<span><span class="va">depletion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">stations</span>, </span>
<span>                        Dbred  <span class="op">=</span> <span class="va">Dbred</span>, </span>
<span>                        Irrred <span class="op">=</span> <span class="va">Irrred</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">times</span>,  <span class="va">Dbrel</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"Fishing impact on Bioturbation potential"</span>, ylab <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>        col <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">Irrrel</span>, </span>
<span>        main <span class="op">=</span> <span class="st">"Fishing impact on Bioirrigation potential"</span>, ylab <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>        col <span class="op">=</span> <span class="fl">4</span>, lty <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">depletion</span>,</span>
<span>         <span class="fu">map_MWTL</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, colvar <span class="op">=</span> <span class="va">Dbred</span>, </span>
<span>                  main <span class="op">=</span> <span class="st">"Bioturbation reduction"</span>, clab <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>                  clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.55</span><span class="op">)</span>,</span>
<span>                  pch <span class="op">=</span> <span class="fl">18</span>, log<span class="op">=</span> <span class="st">"c"</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">depletion</span>, </span>
<span>     <span class="fu">map_MWTL</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, colvar <span class="op">=</span> <span class="va">Irrred</span>, </span>
<span>              main <span class="op">=</span> <span class="st">"Bioirrigation reduction"</span>, clab <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>              clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.005</span>, <span class="fl">0.55</span><span class="op">)</span>,</span>
<span>              pch <span class="op">=</span> <span class="fl">18</span>, log<span class="op">=</span> <span class="st">"c"</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="MWTL_EF_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Beauchard O, Brind’Amour A, Schratzberger M, Laffargue P, Hintzen NT,
Somerfield PJ, Piet G (2021) A generic approach to develop a trait-based
indicator of trawling-induced disturbance. Mar Ecol Prog Ser 675:35-52.
<a href="https://doi.org/10.3354/meps13840" class="external-link uri">https://doi.org/10.3354/meps13840</a></p>
<p>Beauchard, O., Murray S.A. Thompson, Kari Elsa Ellingsen, Gerjan
Piet, Pascal Laffargue, Karline Soetaert, 2023. Assessing sea floor
functional diversity and vulnerability. Marine Ecology Progress Series
v708, p21-43, <a href="https://www.int-res.com/abstracts/meps/v708/p21-43" class="external-link uri">https://www.int-res.com/abstracts/meps/v708/p21-43</a></p>
<p>J. Depestele, K. Degrendele, M. Esmaeili, A. Ivanovic, S. Kroger,
F.G. O’Neill, R. Parker, H. Polet, M. Roche, L.R. Teal, B. Vanelslander,
A.D. Rijnsdorp. (2018). Comparison of mechanical disturbance in soft
sediments due to tickler-chain SumWing trawl versus electro-fitted
PulseWing trawl. ICES J. Mar. Sci. 76, 312–329.</p>
<p>Hiddink, JG, Jennings, S, Sciberras, M, et al. Assessing bottom
trawling impacts based on the longevity of benthic invertebrates. J Appl
Ecol. 2019; 56: 1075– 1084. <a href="https://doi.org/10.1111/1365-2664.13278" class="external-link uri">https://doi.org/10.1111/1365-2664.13278</a></p>
<p>Hiddink, Jan Geert, Simon Jennings, Marija Sciberras, Claire L.
Szostek, Kathryn M. Hughes, Nick Ellis, Adriaan D. Rijnsdorp, Robert A.
McConnaughey, Tessa Mazor, Ray Hilborn, Jeremy S. Collie, C. Roland
Pitcher, Ricardo O. Amoroso, Ana M. Parma, Petri Suuronen, and Michel J.
Kaiser, 2017. Global analysis of depletion and recovery of seabed biota
after bottom trawling disturbance. Proc. Nat. Aca. Sci, 114 (31)
8301-8306 <a href="https://doi.org/10.1073/pnas.161885811" class="external-link uri">https://doi.org/10.1073/pnas.161885811</a>.</p>
<p>Holstein j. (2018). worms: Retrieving Aphia Information from World
Register of Marine Species. R package version 0.2.2. <a href="https://CRAN.R-project.org/package=worms" class="external-link uri">https://CRAN.R-project.org/package=worms</a></p>
<p>ICES Technical Service, Greater North Sea and Celtic Seas Ecoregions,
29 August 2018 sr.2018.14 Version 2: 22 January 2019 <a href="https://doi.org/10.17895/ices.pub.4508" class="external-link uri">https://doi.org/10.17895/ices.pub.4508</a> OSPAR request on
the production of spatial data layers of fishing intensity/pressure.</p>
<p>C.R. Pitcher, J.G. Hiddink, S. Jennings, J. Collie, A.M. Parma, R.
Amoroso, T. Mazor, M. Sciberras, R.A. McConnaughey, A.D. Rijnsdorp, M.J.
Kaiser, P. Suuronen, and R. Hilborn, 2022. Trawl impacts on the relative
status of biotic communities of seabed sedimentary habitats in 24
regions worldwide. PNAS. <a href="https://doi.org/10.1073/pnas.2109449119" class="external-link uri">https://doi.org/10.1073/pnas.2109449119</a></p>
<p>C.R. Pitcher, N. Ellis, S. Jennings, J.G. Hiddink, T. Mazor,
M.J.Kaiser, M.I. Kangas, R.A. McConnaughey, A.M. Parma, A.D. Rijnsdorp,
P. Suuronen, J.S. Collie, R. Amoroso, K.M. Hughes and R. Hilborn, 2017.
Estimating the sustainability of towed fishing-gearimpacts on seabed
habitats: a simple quantitative riskassessment method applicable to
data-limited fisheries. Methods in Ecology and Evolution2017, 8,
472–480doi: 10.1111/2041-210X.12705</p>
<p>Queiros, A. M., S. N. R. Birchenough, J Bremner, J.A. Godbold, R.E.
Parker, A. Romero-Ramirez, H. Reiss, M. Solan, P. J. Somerfield, C. Van
Colen, G. Van Hoey, S. Widdicombe, 2013. A bioturbation classification
of European marine infaunal invertebrates. Ecology and Evolution 3 (11),
3958-3985</p>
<p>R Core Team (2021). R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria. URL
<a href="https://www.R-project.org/" class="external-link uri">https://www.R-project.org/</a>.</p>
<p>Soetaert Karline, Olivier Beauchard (2022). Btrait: Working with
Biological density, taxonomy, and trait composition data. R package
version 1.0.2.</p>
<p>Soetaert Karline, Olivier Beauchard (2022). Bfiat: Bottom Fishing
Impact Assessment Tool. R package version 0.0.1.</p>
<p>Verhulst, Pierre-François (1845). “Recherches mathématiques sur la
loi d’accroissement de la population” [Mathematical Researches into the
Law of Population Growth Increase]. Nouveaux Mémoires de l’Académie
Royale des Sciences et Belles-Lettres de Bruxelles. 18: 8.</p>
<p>Wrede, A., J.Beermann, J.Dannheim, L.Gutow, T.Brey, 2018. Organism
functional traits and ecosystem supporting services - A novel approach
to predict bioirrigation. Ecological indicators, 91, 737-743.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
