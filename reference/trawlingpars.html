<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate model parameters for use in the fishing impact model. — trawling parameters • Bfiat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate model parameters for use in the fishing impact model. — trawling parameters"><meta property="og:description" content="par_r calculates the intrinsic rate of natural increase (r) of benthic taxa, based on their longevity.
par_d calculates the depletion rate (d) of benthic taxa, based on their depth occurrence in the sediment.
par_K calculates the carrying capacity (K) of benthic taxa, based on the (average) density, on the swept area ratio (fishing intensity), and on the species-specific parameters r and d (rate of increase and depletion fraction).
par_m calculates the mortality rate in the continuous model, so that it is compatible with the discrete (event-driven) model, based on the swept area ratio (fishing intensity), and on the species-specific parameters r and d (rate of increase and depletion fraction)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bfiat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Bfiat.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MWTL_EF.html">R-package Bfiat - Modelling trawling effects on ecosystem functioning - MWTL data</a>
    </li>
    <li>
      <a href="../articles/MWTL.html">The Bfiat package: modelling trawling effects in the Dutch part of the Northsea</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate model parameters for use in the fishing impact model.</h1>

    <div class="hidden name"><code>trawlingpars.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>par_r</code> calculates the intrinsic rate of natural increase (r) of benthic taxa, based on their longevity.</p>
<p><code>par_d</code> calculates the depletion rate (d) of benthic taxa, based on their depth occurrence in the sediment.</p>
<p><code>par_K</code> calculates the carrying capacity (K) of benthic taxa, based on the (average) density, on the swept area ratio (fishing intensity), and on the species-specific parameters r and d (rate of increase and depletion fraction).</p>
<p><code>par_m</code> calculates the mortality rate in the continuous model, so that it is compatible with the discrete (event-driven) model, based on the swept area ratio (fishing intensity), and on the species-specific parameters r and d (rate of increase and depletion fraction).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">par_r</span> <span class="op">(</span>age_at_maturity <span class="op">=</span> <span class="cn">NULL</span>, longevity <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>   </span>
<span><span class="fu">par_d</span> <span class="op">(</span>gpd <span class="op">=</span> <span class="fl">1</span>, m_d <span class="op">=</span> <span class="fl">0.055</span>, m_max <span class="op">=</span> <span class="fl">0.42</span>, </span>
<span>       <span class="va">fDepth</span>, <span class="va">uDepth</span><span class="op">)</span></span>
<span><span class="fu">par_K</span> <span class="op">(</span><span class="va">density</span>, <span class="va">sar</span>, <span class="va">r</span>, <span class="va">d</span>, t_density <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>       </span>
<span><span class="fu">par_m</span> <span class="op">(</span><span class="va">sar</span>, <span class="va">r</span>, <span class="va">K</span>, <span class="va">d</span>, refD <span class="op">=</span> <span class="va">K</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-density-">density <a class="anchor" aria-label="anchor" href="#arg-density-"></a></dt>
<dd><p>vector or number with the observed abundance or biomass of the taxon.</p></dd>

  <dt id="arg-t-density-">t_density <a class="anchor" aria-label="anchor" href="#arg-t-density-"></a></dt>
<dd><p>time after the onset of fishing at which the density/biomass was estimated.
  If NULL, then an infinite time at which fishing intensity was = sar is assumed. In that case, the inputted <code>density</code> is assumed to be at steady-state with respect to <code>sar</code>.</p></dd>


  <dt id="arg-sar-">sar <a class="anchor" aria-label="anchor" href="#arg-sar-"></a></dt>
<dd><p>fishing intensity, estimated as Swept Area Ratio, units e.g. [m2/m2/year]. One number, or a vector of the same length as the other parameters.</p></dd>

  <dt id="arg-r-">r <a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>the rate of increase of each taxon, units e.g. [/year]. One number, or a vector of the same length as the other parameters.</p></dd>

  <dt id="arg-d-">d <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>depletion fraction due to fishing. One number, or a vector of the same length as the other parameters.</p></dd>

  <dt id="arg-k-">K <a class="anchor" aria-label="anchor" href="#arg-k-"></a></dt>
<dd><p>carrying capacity. One number, or a vector of same length as the other parameters.</p></dd>

  <dt id="arg-refd-">refD <a class="anchor" aria-label="anchor" href="#arg-refd-"></a></dt>
<dd><p>reference density at which the mortality should be estimated. One number or a vector, or a vector of the same length as <code>r</code>.</p></dd>

  <dt id="arg-longevity-age-at-maturity-">longevity, age_at_maturity <a class="anchor" aria-label="anchor" href="#arg-longevity-age-at-maturity-"></a></dt>
<dd><p>mean lifetime or age at maturity of the species, years. <code>age_at_maturity</code> gives better estimates of rate of increase than <code>longevity</code>. At least one of these two arguments needs to be specified; if both are given a value then</p></dd>

  <dt id="arg-gpd-">gpd <a class="anchor" aria-label="anchor" href="#arg-gpd-"></a></dt>
<dd><p>gear penetration depth, units e.g. [cm]. One number or a vector.</p></dd>

  <dt id="arg-m-d-">m_d <a class="anchor" aria-label="anchor" href="#arg-m-d-"></a></dt>
<dd><p>mortality (depletion) parameter expressing the increase in mortality with increasing penetration depth, units e.g. [/cm]. One number, or a vector of the same length as <code>gpd</code>.</p></dd>

  <dt id="arg-m-max-">m_max <a class="anchor" aria-label="anchor" href="#arg-m-max-"></a></dt>
<dd><p>maximum mortality fraction in any layer, dimensionless. One number, or a vector of the same length as <code>gpd</code>.</p></dd>

  <dt id="arg-fdepth-">fDepth <a class="anchor" aria-label="anchor" href="#arg-fdepth-"></a></dt>
<dd><p>fractional occurrence of species in sediment layers, dimensionless.
  A vector of the same length as <code>uDepth</code> (if only one taxon) or, for multiple taxa,
  a data.frame or matrix with number of columns = length of <code>uDepth</code>. The sum of <code>fDepth</code> should equal 1.</p></dd>

  <dt id="arg-udepth-">uDepth <a class="anchor" aria-label="anchor" href="#arg-udepth-"></a></dt>
<dd><p>vector with depth of the upper position of the sediment layers, units e.g. [cm]. A vector with length equal to the number of columns of <code>fDepth</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>return the parameter values, as a vector.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div id="details">
    <h2>Details</h2>


<p>The parameters d, K, r are used in the logistic population density model:</p>
<p>dC/dt = r * C * (1-C/K)</p>
<p>where <code>r</code> is the intrinsic rate of increase (units [/time]), K is the carrying capacity (same units as C).</p>
<p>During a fishing disturbance at time T, the density or biomass C is instantaneously reduced with a factor <code>d</code>:</p>
<p>C{T+} = C{T-} * (1-d)</p>
<p>where (T-) and (T+) are the time immediately before and after the disturbance.</p>
<p>The formulae for estimating these parameters for a species i are:</p>
<ul><li><p><code>d</code>  is estimated as:</p>
<p>d[i] = min(m_max, sum(m_d * max(0, gpd-uDepth[i,])*fDepth[i,]))</p>
<p>where uDepth[i,] and fDepth[i,] are the parameters for all layers for species i, and summation is over all sediment layers.</p>
<p>The parameters m_d and m_max are estimated by fitting station-wide depletion rates to depletion values in Hiddink et al. (2017). See examples.</p></li>
<li><p><code>r</code> is estimated as r[i] = 2.56/age_at_maturity[i]: or as r[i] = 5.31/longevity[i], as in Hiddink et al. (2019).</p></li>
<li><p><code>K</code> is estimated as: K[i] = (density[i]*r[i])/(r[i]-sar * d[i]), derived from Pitcher et al., 2017.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="trawlingfun.html">run_perturb</a> for how to run a disturbance model.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_nioz</a>, for trait databases in package Btrait.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/MWTLdensitydata.html" class="external-link">MWTL</a> for data sets on which fishing can be imposed.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/BtraitMap.html" class="external-link">map_key</a> for simple plotting functions.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Hiddink, JG, Jennings, S, Sciberras, M, et al., 2019. Assessing bottom trawling impacts based on the longevity of benthic invertebrates. J Appl Ecol 56: 1075-1084. https://doi.org/10.1111/1365-2664.13278</p>
<p>Hiddink, Jan Geert, Simon Jennings, Marija Sciberras, Claire L. Szostek, Kathryn M. Hughes, Nick Ellis, Adriaan D. Rijnsdorp, Robert A. McConnaughey, Tessa Mazor, Ray Hilborn, Jeremy S. Collie, C. Roland Pitcher, Ricardo O. Amoroso, Ana M. Parma, Petri Suuronen, and Michel J. Kaiser, 2017.  Global analysis of depletion and recovery of seabed biota after bottom trawling disturbance. Proc. Nat. Aca. Sci, 114 (31) 8301-8306. https://doi.org/10.1073/pnas.161885811.</p>
<p>C.R. Pitcher, N. Ellis, S. Jennings, J.G. Hiddink, T. Mazor, M.J.Kaiser, M.I. Kangas, R.A. McConnaughey, A.M. Parma, A.D. Rijnsdorp, P. Suuronen, J.S. Collie, R. Amoroso, K.M. Hughes and R. Hilborn, 2017. Estimating the sustainability of towed fishing-gearimpacts on seabed habitats: a simple quantitative riskassessment method applicable to data-limited fisheries. Methods in Ecology and Evolution,8,472-480doi: 10.1111/2041-210X.12705</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## =======================================================</span></span></span>
<span class="r-in"><span><span class="co">## Simple example:</span></span></span>
<span class="r-in"><span><span class="co">## =======================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Depletion rate for one organism</span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># depletion for one organism, living in [0-5], [5-10], [10-15] and &gt;15 cm</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">par_d</span> <span class="op">(</span>gpd<span class="op">=</span><span class="fl">12</span>, fDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>,  <span class="co"># fractional occurrence</span></span></span>
<span class="r-in"><span>               uDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,     <span class="fl">5</span>,  <span class="fl">10</span>,  <span class="fl">15</span><span class="op">)</span><span class="op">)</span>  <span class="co"># upper depth</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2365</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Depletion rate for several organisms</span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># depth penetration for three organisms:</span></span></span>
<span class="r-in"><span><span class="co"># 2 sediment layers (0-10 and 10-20 cm)</span></span></span>
<span class="r-in"><span><span class="co"># sp1: in upper sediment layer, sp2: equally distributed, sp3: deep-dwelling</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">fDepth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>D0_10  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,   <span class="co">#upper depth=0</span></span></span>
<span class="r-in"><span>                      D10_20 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>   <span class="co">#upper depth=10</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">uDepth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>                            </span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># estimate depletion, using default parameter settings</span></span></span>
<span class="r-in"><span> <span class="co"># gpd=1 -&gt; does not penetrate in depth layer 2</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="fu">par_d</span> <span class="op">(</span>gpd<span class="op">=</span><span class="fl">1</span>, fDepth<span class="op">=</span><span class="va">fDepth</span>, uDepth<span class="op">=</span><span class="va">uDepth</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0550 0.0275 0.0000</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># gpd=12 cm -&gt; maximal depletion in layer 1; also mortality in layer 2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">par_d</span> <span class="op">(</span>gpd<span class="op">=</span><span class="fl">12</span>, fDepth<span class="op">=</span><span class="va">fDepth</span>, uDepth<span class="op">=</span><span class="va">uDepth</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.420 0.385 0.110</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># higher mortality coefficient:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">par_d</span> <span class="op">(</span>gpd<span class="op">=</span><span class="fl">12</span>, fDepth<span class="op">=</span><span class="va">fDepth</span>, uDepth<span class="op">=</span><span class="va">uDepth</span>, m_d<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.42 0.42 0.20</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># depletion for one species and a range of gear penetration depths</span></span></span>
<span class="r-in"><span> <span class="va">GPD.seq</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">GPD.seq</span>, </span></span>
<span class="r-in"><span>      <span class="fu">par_d</span> <span class="op">(</span>fDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             uDepth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             gpd    <span class="op">=</span> <span class="va">GPD.seq</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      xlab<span class="op">=</span><span class="st">"gear penetration depth, cm"</span>,       </span></span>
<span class="r-in"><span>      ylab<span class="op">=</span><span class="st">"depletion"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingpars-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># rate of increase</span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">Longevity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>, to<span class="op">=</span><span class="fl">10</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Longevity</span>, <span class="fu">par_r</span><span class="op">(</span><span class="va">Longevity</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"longevity, year"</span>, </span></span>
<span class="r-in"><span>      ylab<span class="op">=</span><span class="st">"r, /year"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingpars-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Carrying capacity </span></span></span>
<span class="r-in"><span><span class="co"># -------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimated assuming current density is in steady-state with fishing</span></span></span>
<span class="r-in"><span><span class="co"># this returns a NA -&gt; the steady state of the density at the sar = 0</span></span></span>
<span class="r-in"><span> <span class="fu">par_K</span> <span class="op">(</span>density<span class="op">=</span><span class="fl">1</span>, sar<span class="op">=</span><span class="fl">1</span>, r<span class="op">=</span><span class="fl">0.1</span>, d<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assuming that the density was estimated after 50 years of fishing</span></span></span>
<span class="r-in"><span> <span class="fu">par_K</span> <span class="op">(</span>density<span class="op">=</span><span class="fl">1</span>, sar<span class="op">=</span><span class="fl">1</span>, r<span class="op">=</span><span class="fl">0.1</span>, d<span class="op">=</span><span class="fl">0.3</span>, t_density<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 916816.4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimated average mortality rate is larger than the rate of increase, r</span></span></span>
<span class="r-in"><span> <span class="fu">par_m</span> <span class="op">(</span>sar<span class="op">=</span><span class="fl">1</span>, r<span class="op">=</span><span class="fl">0.1</span>, d<span class="op">=</span><span class="fl">0.3</span>, K<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3553768</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this returns a value -&gt; the species is able to persist under the current sar</span></span></span>
<span class="r-in"><span> <span class="fu">par_K</span> <span class="op">(</span>density<span class="op">=</span><span class="fl">1</span>, sar<span class="op">=</span><span class="fl">1</span>, r<span class="op">=</span><span class="fl">0.1</span>, d<span class="op">=</span><span class="fl">0.075</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.537522</span>
<span class="r-in"><span> <span class="fu">par_m</span> <span class="op">(</span>sar<span class="op">=</span><span class="fl">1</span>, r<span class="op">=</span><span class="fl">0.1</span>, d<span class="op">=</span><span class="fl">0.3</span>, K<span class="op">=</span><span class="fl">10</span><span class="op">)</span>  <span class="co"># smaller than 0.1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3553768</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimated for a sequence of fishing intensities</span></span></span>
<span class="r-in"><span> <span class="va">sar.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0.05</span>, to<span class="op">=</span><span class="fl">2</span>, by<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">K.seq</span>   <span class="op">&lt;-</span> <span class="fu">par_K</span><span class="op">(</span>density <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                  sar     <span class="op">=</span> <span class="va">sar.seq</span>,</span></span>
<span class="r-in"><span>                  r       <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                  d       <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sar.seq</span>, <span class="va">K.seq</span>,      </span></span>
<span class="r-in"><span>      xlab<span class="op">=</span><span class="st">"Swept area ratio, /yr"</span>, </span></span>
<span class="r-in"><span>      ylab <span class="op">=</span> <span class="st">"carrying capacity"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingpars-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>            </span></span>
<span class="r-in"><span><span class="co">## =======================================================</span></span></span>
<span class="r-in"><span><span class="co">## Fishing parameters for species in Traits_nioz database</span></span></span>
<span class="r-in"><span><span class="co">## =======================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -----------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Depletion rate</span></span></span>
<span class="r-in"><span><span class="co"># -----------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># column names with depth occurrence of species in trait database</span></span></span>
<span class="r-in"><span> <span class="va">DepthTraits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">metadata</span><span class="op">(</span><span class="va">Traits_nioz</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                        subset <span class="op">=</span> <span class="va">trait</span><span class="op">==</span><span class="st">"Substratum depth distribution"</span><span class="op">)</span>  </span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">DepthTraits</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   colname                         trait modality indic value score units</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  ET1.M1 Substratum depth distribution        0     1   0.0  1.00    cm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  ET1.M2 Substratum depth distribution      0-5     1   2.5  0.75    cm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  ET1.M3 Substratum depth distribution     5-15     1  10.0  0.50    cm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  ET1.M4 Substratum depth distribution    15-30     1  22.5  0.25    cm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  ET1.M5 Substratum depth distribution      &gt;30     1  30.0  0.00    cm</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">toselect</span>     <span class="op">&lt;-</span> <span class="va">DepthTraits</span><span class="op">$</span><span class="va">colname</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># select depth occurrence traits in trait database</span></span></span>
<span class="r-in"><span> <span class="va">Traits_depth</span> <span class="op">&lt;-</span> <span class="va">Traits_nioz</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>, <span class="va">toselect</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Traits_depth</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   taxon ET1.M1 ET1.M2 ET1.M3 ET1.M4 ET1.M5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          Abludomelita    0.5    0.5    0.0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Abludomelita obtusata    0.5    0.5    0.0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             Abra alba    0.0    0.5    0.5      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           Abra nitida    0.0    1.0    0.0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       Abra prismatica    0.0    1.0    0.0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           Abra tenuis    0.0    1.0    0.0      0      0</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># give suitable names to the columns </span></span></span>
<span class="r-in"><span> <span class="va">cn</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x0"</span>, <span class="st">"x0-5"</span>, <span class="st">"x5-15"</span>, <span class="st">"x15-30"</span>, <span class="st">"x&gt;30"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Traits_depth</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cn</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Traits_depth</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   taxon  x0 x0-5 x5-15 x15-30 x&gt;30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          Abludomelita 0.5  0.5   0.0      0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Abludomelita obtusata 0.5  0.5   0.0      0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3             Abra alba 0.0  0.5   0.5      0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           Abra nitida 0.0  1.0   0.0      0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       Abra prismatica 0.0  1.0   0.0      0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           Abra tenuis 0.0  1.0   0.0      0    0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># vector with corresponding depth of upper boundary </span></span></span>
<span class="r-in"><span> <span class="va">uDepth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">30</span><span class="op">)</span>  </span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># depletion for all species and 1 cm gear penetration depth</span></span></span>
<span class="r-in"><span> <span class="va">d_1cm</span> <span class="op">&lt;-</span> <span class="fu">par_d</span><span class="op">(</span> fDepth <span class="op">=</span> <span class="va">Traits_depth</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                 uDepth <span class="op">=</span> <span class="va">uDepth</span>, </span></span>
<span class="r-in"><span>                 gpd    <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">d_1cm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.00000 0.02750 0.05500 0.04183 0.05500 0.05500 </span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># depletion for Abra alba and range of penetration depths</span></span></span>
<span class="r-in"><span> <span class="va">GPD.seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">A.alba</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">Traits_depth</span>, subset<span class="op">=</span><span class="va">taxon</span><span class="op">==</span><span class="st">"Abra alba"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">A.alba</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       taxon x0 x0-5 x5-15 x15-30 x&gt;30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 Abra alba  0  0.5   0.5      0    0</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">d.seq</span>   <span class="op">&lt;-</span> <span class="fu">par_d</span><span class="op">(</span>fDepth <span class="op">=</span> <span class="va">A.alba</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                  uDepth <span class="op">=</span> <span class="va">uDepth</span>, </span></span>
<span class="r-in"><span>                  gpd    <span class="op">=</span> <span class="va">GPD.seq</span><span class="op">)</span></span></span>
<span class="r-in"><span>                  </span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">GPD.seq</span>, <span class="va">d.seq</span>, </span></span>
<span class="r-in"><span>      xlab <span class="op">=</span> <span class="st">"gear penetration depth, cm"</span>, ylab <span class="op">=</span> <span class="st">"depletion"</span>,</span></span>
<span class="r-in"><span>      main <span class="op">=</span> <span class="st">"depletion for Abra alba"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingpars-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># depletion rate for all species and different penetration depths</span></span></span>
<span class="r-in"><span> <span class="va">ALL_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span>X   <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Traits_depth</span><span class="op">)</span>,   <span class="co"># combine all x-values</span></span></span>
<span class="r-in"><span>                Y   <span class="op">=</span> <span class="va">GPD.seq</span>,                <span class="co"># with these y-values</span></span></span>
<span class="r-in"><span>                </span></span>
<span class="r-in"><span>                FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">gpd</span><span class="op">)</span>        </span></span>
<span class="r-in"><span>                   <span class="fu">par_d</span><span class="op">(</span>fDepth <span class="op">=</span> <span class="va">Traits_depth</span><span class="op">[</span><span class="va">i</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="co"># depth of species i</span></span></span>
<span class="r-in"><span>                         uDepth <span class="op">=</span> <span class="va">uDepth</span>, </span></span>
<span class="r-in"><span>                         gpd    <span class="op">=</span> <span class="va">gpd</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">GPD.seq</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ALL_d</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>         xlab <span class="op">=</span> <span class="st">"gear penetration depth, cm"</span>, ylab <span class="op">=</span> <span class="st">"depletion"</span>,</span></span>
<span class="r-in"><span>         main <span class="op">=</span> <span class="st">"Depletion for Northsea species"</span>, </span></span>
<span class="r-in"><span>         type <span class="op">=</span> <span class="st">"l"</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingpars-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -----------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Carrying capacity </span></span></span>
<span class="r-in"><span><span class="co"># -----------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># assume gear penetration depth = 3 cm</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1. estimate depletion rate</span></span></span>
<span class="r-in"><span> <span class="va">d_3cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>              taxon <span class="op">=</span> <span class="va">Traits_depth</span><span class="op">$</span><span class="va">taxon</span>,</span></span>
<span class="r-in"><span>              d     <span class="op">=</span> <span class="fu">par_d</span><span class="op">(</span>fDepth <span class="op">=</span> <span class="va">Traits_depth</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                            uDepth <span class="op">=</span> <span class="va">uDepth</span>, </span></span>
<span class="r-in"><span>                            gpd    <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">Dens</span> <span class="op">&lt;-</span> <span class="fu">get_density</span><span class="op">(</span></span></span>
<span class="r-in"><span>                  data        <span class="op">=</span> <span class="va">MWTL</span><span class="op">$</span><span class="va">density</span>,</span></span>
<span class="r-in"><span>                  descriptor  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="va">station</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                  taxon       <span class="op">=</span> <span class="va">taxon</span>, </span></span>
<span class="r-in"><span>                  value       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>density<span class="op">=</span><span class="va">density</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                  averageOver <span class="op">=</span> <span class="va">year</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">FishStat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">Dens</span>    , </span></span>
<span class="r-in"><span>                   <span class="va">MWTL</span><span class="op">$</span><span class="va">abiotics</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"station"</span>, <span class="st">"sar"</span><span class="op">)</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                   by <span class="op">=</span> <span class="st">"station"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                   </span></span>
<span class="r-in"><span> <span class="va">FishStat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">FishStat</span>, </span></span>
<span class="r-in"><span>                   <span class="va">MWTL</span><span class="op">$</span><span class="va">fishing</span> <span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"taxon"</span>,<span class="st">"r"</span><span class="op">)</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                   by <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                   </span></span>
<span class="r-in"><span> <span class="va">FishStat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">FishStat</span>, </span></span>
<span class="r-in"><span>                   <span class="va">d_3cm</span>, </span></span>
<span class="r-in"><span>                   by <span class="op">=</span> <span class="st">"taxon"</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">KE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">FishStat</span>, </span></span>
<span class="r-in"><span>            <span class="fu">par_K</span> <span class="op">(</span>density <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>                   sar     <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                   r       <span class="op">=</span> <span class="va">r</span>, </span></span>
<span class="r-in"><span>                   d       <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">FishStat</span><span class="op">$</span><span class="va">KE</span> <span class="op">&lt;-</span> <span class="va">KE</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Note: some species do not have a value for the carrying capacity</span></span></span>
<span class="r-in"><span><span class="co"># based on the assumption that the density is at steady state with the </span></span></span>
<span class="r-in"><span><span class="co"># current fishing intensity.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">KE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">KE</span><span class="op">)</span> <span class="co"># Fraction that cannot be there</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.009615385</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Carrying capacity, assuming that fishing has been going on only for 50 years</span></span></span>
<span class="r-in"><span> <span class="va">FishStat</span><span class="op">$</span><span class="va">KE50</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">FishStat</span>, </span></span>
<span class="r-in"><span>            <span class="fu">par_K</span> <span class="op">(</span>density   <span class="op">=</span> <span class="va">density</span>, </span></span>
<span class="r-in"><span>                   t_density <span class="op">=</span> <span class="fl">50</span>,  </span></span>
<span class="r-in"><span>                   sar       <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                   r         <span class="op">=</span> <span class="va">r</span>, </span></span>
<span class="r-in"><span>                   d         <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># total carrying capacity and total density per station:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">Kstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">FishStat</span>, </span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">KE</span>, </span></span>
<span class="r-in"><span>                 INDEX <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>                 FUN   <span class="op">=</span> <span class="va">sum</span><span class="op">)</span><span class="op">)</span>   <span class="co"># summed carrying capacity</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="va">Dstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">FishStat</span>, </span></span>
<span class="r-in"><span>          <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">density</span>, </span></span>
<span class="r-in"><span>                 INDEX <span class="op">=</span> <span class="va">station</span>, </span></span>
<span class="r-in"><span>                 FUN <span class="op">=</span> <span class="va">sum</span><span class="op">)</span><span class="op">)</span>     <span class="co"># summed density</span></span></span>
<span class="r-in"><span>          </span></span>
<span class="r-in"><span> <span class="va">Kstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>station<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Kstat</span><span class="op">)</span>, K<span class="op">=</span><span class="va">Kstat</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">Kstat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">MWTL</span><span class="op">$</span><span class="va">stations</span>, <span class="va">Kstat</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">Kstat</span><span class="op">$</span><span class="va">D</span> <span class="op">&lt;-</span> <span class="va">Dstat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Kstat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     station    x     y         K         D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 BREEVTN02 3.31 53.52 1178.7365 1087.1328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 BREEVTN03 4.44 53.19  650.9417  640.3413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 BREEVTN04 4.31 53.10 1504.1525 1434.8697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 BREEVTN05 4.01 53.02 1990.5265 1853.5392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 BREEVTN06 4.23 52.82 1200.3763 1144.2236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 BREEVTN07 3.84 52.76 1177.7428 1125.9104</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">Kstat</span>, <span class="fu">map_key</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, </span></span>
<span class="r-in"><span>                    contours<span class="op">=</span><span class="va">MWTL</span><span class="op">$</span><span class="va">contours</span>,</span></span>
<span class="r-in"><span>                    colvar <span class="op">=</span> <span class="va">K</span><span class="op">/</span><span class="va">D</span><span class="op">-</span><span class="fl">1</span>, <span class="co"># color variable</span></span></span>
<span class="r-in"><span>                    clim   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-2</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    main   <span class="op">=</span> <span class="st">"K/D-1 for 3 cm trawling"</span>, </span></span>
<span class="r-in"><span>                    pch <span class="op">=</span> <span class="fl">18</span>, cex <span class="op">=</span> <span class="fl">2</span>, log <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingpars-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Mortality parameter and steady-state</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># discrete parameter values</span></span></span>
<span class="r-in"><span><span class="va">parms</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">0.5</span>, d<span class="op">=</span><span class="fl">0.2</span>, K<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sar</span>    <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">tend</span>   <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># output times and event times</span></span></span>
<span class="r-in"><span><span class="va">times</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0</span>,       to<span class="op">=</span><span class="va">tend</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, to<span class="op">=</span><span class="va">tend</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">sar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model run with events</span></span></span>
<span class="r-in"><span><span class="va">run.discrete</span>   <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span><span class="op">(</span>parms  <span class="op">=</span> <span class="va">parms</span>, </span></span>
<span class="r-in"><span>                              times  <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                              events <span class="op">=</span> <span class="va">events</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># corresponding mortality paramter</span></span></span>
<span class="r-in"><span><span class="va">m</span>              <span class="op">&lt;-</span> <span class="fu">par_m</span><span class="op">(</span>sar <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                        r   <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"r"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                        d   <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"d"</span><span class="op">]</span>, K <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"K"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># put all in parameter vector (for continuous mortality)</span></span></span>
<span class="r-in"><span><span class="va">parms.c</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">parms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="st">"K"</span><span class="op">)</span><span class="op">]</span>, m<span class="op">=</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model run with continuous mortality</span></span></span>
<span class="r-in"><span><span class="va">run.continuous</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_logistic</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="va">parms.c</span>, </span></span>
<span class="r-in"><span>                               times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare both (it is not perfect)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">run.continuous</span>, <span class="va">run.discrete</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingpars-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

