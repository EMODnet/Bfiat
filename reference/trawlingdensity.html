<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimates density before and after a trawling event, or the average density between trawls. — density during trawling events • Bfiat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimates density before and after a trawling event, or the average density between trawls. — density during trawling events"><meta name="description" content="trawl_perturb and trawl_metier calculates the density of taxa immediately at the start and end after the n-th trawling event, and the mean density inbetween trawling events, for one metier and multiple metiers respectively."><meta property="og:description" content="trawl_perturb and trawl_metier calculates the density of taxa immediately at the start and end after the n-th trawling event, and the mean density inbetween trawling events, for one metier and multiple metiers respectively."><meta property="og:image" content="https://EMODnet.github.io/Bfiat/reference/figures/Logo_hex.png"><meta property="og:image:alt" content="Bfiat logo"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Bfiat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">How To</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to"><li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/Bfiat.html">Description</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples-of-use" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples of use</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples-of-use"><li><a class="dropdown-item" href="../articles/MWTL.html">The dutch monitoring data - fishing impact on density</a></li>
    <li><a class="dropdown-item" href="../articles/MWTL_EF.html">The dutch monitoring - fishing impact on ecosystem functioning</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://emodnet.github.io/Bfiat/"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimates density before and after a trawling event, or the average density between trawls.</h1>

      <div class="d-none name"><code>trawlingdensity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>trawl_perturb</code> and <code>trawl_metier</code> calculates the density of taxa immediately at the start and end after the n-th trawling event, and the mean density inbetween trawling events, for one metier and multiple metiers respectively.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trawl_perturb</span>   <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, </span>
<span>                sar <span class="op">=</span> <span class="fl">1</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">trawl_metier</span>    <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                 parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>, </span>
<span>                 d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, </span>
<span>                 sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                 D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-sar-">sar <a class="anchor" aria-label="anchor" href="#arg-sar-"></a></dt>
<dd><p>fishing intensity, estimated as Swept Area Ratio, units e.g. [m2/m2/year]. For <code>trawl_perturb</code>: one number. For <code>trawl_metier</code>, a data.frame with one value per metier.</p></dd>

  <dt id="arg-r-">r <a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>the rate of increase of each taxon, units e.g. [/year]. One number, or a vector.</p></dd>

  <dt id="arg-d-">d <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>depletion fraction due to fishing. For <code>trawl_perturb</code>: one number, or a vector of same length as <code>r</code>.  For <code>trawl_metier</code>, a data.frame with nrows = length(r), and ncols = number of metiers, containing one number per metier and per taxon.</p></dd>

  <dt id="arg-k-">K <a class="anchor" aria-label="anchor" href="#arg-k-"></a></dt>
<dd><p>carrying capacity. One number, or a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-parms-">parms <a class="anchor" aria-label="anchor" href="#arg-parms-"></a></dt>
<dd><p>a data.frame with all parameters.</p></dd>

  <dt id="arg-d-">D0 <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>initial density. One number, or a vector of length = nrow(parms).</p></dd>

  <dt id="arg-n-">n <a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>number of fishing events. One number, or a vector.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code>data.frame</code>, with the following columns:</p>
<p></p><ul><li><p><code>K, r, d, D0</code>: the model parameters,</p></li>
<li><p><code>times</code>, the start time of the trawling events as in argument <code>n</code>,</p></li>
<li><p><code>times_end</code>, the end time of the trawling events as in argument <code>n</code>,</p></li>
<li><p><code>ntrawl_from</code>, the number of the trawl at the start of the trawling interval (<code>n</code>),</p></li>
<li><p><code>ntrawl_to</code>, the number of the trawl at the end of the trawling interval (<code>n+1</code>),</p></li>
<li><p><code>density</code>, the density averaged over the trawling interval,</p></li>
<li><p><code>density_start</code>, the density after trawling at the n-th trawling interval,</p></li>
<li><p><code>density_end</code>, the density at the end of the n-th trawling interval, before the next trawling.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="steadydensity.html">steady_perturb</a> for steady-state calculations.</p>
<p><a href="trawlingfun.html">run_perturb</a> for how to run a disturbance model.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_nioz</a>, for trait databases in package Btrait.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/MWTLdensitydata.html" class="external-link">MWTL</a> for data sets on which fishing can be imposed.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/BtraitMap.html" class="external-link">map_key</a> for simple plotting functions.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hiddink, JG, Jennings, S, Sciberras, M, et al., 2019. Assessing bottom trawling impacts based on the longevity of benthic invertebrates. J Appl Ecol 56: 1075-1084. https://doi.org/10.1111/1365-2664.13278</p>
<p>Hiddink, Jan Geert, Simon Jennings, Marija Sciberras, Claire L. Szostek, Kathryn M. Hughes, Nick Ellis, Adriaan D. Rijnsdorp, Robert A. McConnaughey, Tessa Mazor, Ray Hilborn, Jeremy S. Collie, C. Roland Pitcher, Ricardo O. Amoroso, Ana M. Parma, Petri Suuronen, and Michel J. Kaiser, 2017.  Global analysis of depletion and recovery of seabed biota after bottom trawling disturbance. Proc. Nat. Aca. Sci, 114 (31) 8301-8306. https://doi.org/10.1073/pnas.161885811.</p>
<p>C.R. Pitcher, N. Ellis, S. Jennings, J.G. Hiddink, T. Mazor, M.J.Kaiser, M.I. Kangas, R.A. McConnaughey, A.M. Parma, A.D. Rijnsdorp, P. Suuronen, J.S. Collie, R. Amoroso, K.M. Hughes and R. Hilborn, 2017. Estimating the sustainability of towed fishing-gearimpacts on seabed habitats: a simple quantitative riskassessment method applicable to data-limited fisheries. Methods in Ecology and Evolution,8,472-480doi: 10.1111/2041-210X.12705</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Density for one fishing events</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">D1</span> <span class="op">&lt;-</span> <span class="fu">trawl_perturb</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>,  </span></span>
<span class="r-in"><span>                    K <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>   </span></span>
<span class="r-in"><span><span class="va">D1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     K r   d sar  D0 times times_end ntrawl_from ntrawl_to  density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 100 1 0.1   1 100     0         1           1         2 93.47017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   density_start density_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            90    96.07297</span>
<span class="r-in"><span>             </span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Density for a sequence of fishing events</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">D2</span> <span class="op">&lt;-</span> <span class="fu">trawl_perturb</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, </span></span>
<span class="r-in"><span>                    K <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">D2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      K r   d sar  D0 times times_end ntrawl_from ntrawl_to  density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  100 1 0.1   1 100     0         1           1         2 93.47017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  100 1 0.1   1 100     1         2           2         3 91.05639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  100 1 0.1   1 100     2         3           3         4 90.10764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  100 1 0.1   1 100     3         4           4         5 89.72587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  100 1 0.1   1 100     4         5           5         6 89.57081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  100 1 0.1   1 100     5         6           6         7 89.50760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  100 1 0.1   1 100     6         7           7         8 89.48178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  100 1 0.1   1 100     7         8           8         9 89.47124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  100 1 0.1   1 100     8         9           9        10 89.46693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 100 1 0.1   1 100     9        10          10        11 89.46517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    density_start density_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       90.00000    96.07297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       86.46567    94.55518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       85.09966    93.94849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       84.55364    93.70274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       84.33247    93.60266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6       84.24239    93.56181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7       84.20563    93.54512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8       84.19061    93.53831</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9       84.18448    93.53552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10      84.18197    93.53438</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Density for a sequence of fishing events </span></span></span>
<span class="r-in"><span><span class="co">## and multiple parameters</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">D3</span> <span class="op">&lt;-</span> <span class="fu">trawl_perturb</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, </span></span>
<span class="r-in"><span>                    K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     K r   d sar D0 times times_end ntrawl_from ntrawl_to   density</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  10 1 0.1   1 10     0         1           1         2  9.347017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  10 1 0.1   1 10     1         2           2         3  9.105639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  10 1 0.1   1 10     2         3           3         4  9.010764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  10 1 0.1   1 10     3         4           4         5  8.972587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  10 1 0.1   1 10     4         5           5         6  8.957081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  20 1 0.1   1 20     0         1           1         2 18.694033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  20 1 0.1   1 20     1         2           2         3 18.211279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  20 1 0.1   1 20     2         3           3         4 18.021527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  20 1 0.1   1 20     3         4           4         5 17.945174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 20 1 0.1   1 20     4         5           5         6 17.914163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    density_start density_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       9.000000    9.607297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       8.646567    9.455518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       8.509966    9.394849</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       8.455364    9.370274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5       8.433247    9.360266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      18.000000   19.214594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      17.293135   18.911035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      17.019932   18.789698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      16.910728   18.740548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     16.866493   18.720532</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## compare trawl_perturb with the dynamic model solution</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">S</span>      <span class="op">&lt;-</span> <span class="fl">1</span>    <span class="co"># swept area ratio</span></span></span>
<span class="r-in"><span><span class="va">tend</span>   <span class="op">&lt;-</span> <span class="fl">20</span>   </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fishD</span>  <span class="op">&lt;-</span> <span class="fu">trawl_perturb</span><span class="op">(</span>n   <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">tend</span>, </span></span>
<span class="r-in"><span>                        d   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        K   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        sar <span class="op">=</span> <span class="va">S</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fishD</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    K r   d sar D0 times times_end ntrawl_from ntrawl_to  density density_start</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 40 1 0.2   1 40     0         1           1         2 34.59359      32.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 40 1 0.2   1 40     1         2           2         3 32.59422      29.30484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 40 1 0.2   1 40     2         3           3         4 31.75429      28.21217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 40 1 0.2   1 40     3         4           4         5 31.38313      27.73660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 40 1 0.2   1 40     4         5           5         6 31.21550      27.52325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 40 1 0.2   1 40     5         6           6         7 31.13904      27.42624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   density_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    36.63105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    35.26522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    34.67075</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    34.40406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    34.28280</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    34.22732</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dynamic run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="va">tend</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">parms</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,     <span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>               K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>,  <span class="fl">100</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>               d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="va">parms</span>, </span></span>
<span class="r-in"><span>                    times <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                    sar   <span class="op">=</span> <span class="va">S</span><span class="op">)</span>  <span class="co"># can only have one number for sar</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">matplot.0D</span><span class="op">(</span><span class="va">Dens</span>, </span></span>
<span class="r-in"><span>           lty <span class="op">=</span> <span class="fl">1</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>           ylab <span class="op">=</span> <span class="st">"density"</span>, </span></span>
<span class="r-in"><span>           main <span class="op">=</span> <span class="st">"comparison trawl_perturb and run_perturb"</span><span class="op">)</span></span></span>
<span class="r-in"><span>           </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">fishD</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">fishD</span><span class="op">$</span><span class="va">density_start</span> ,  </span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">fishD</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">times_end</span>, <span class="va">density_end</span> ,  </span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">fishD</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="va">times</span><span class="op">+</span><span class="va">times_end</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">density</span> ,  </span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">22</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"left"</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">15</span>, <span class="fl">1</span>, <span class="fl">22</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>      legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"run_perturb"</span>, <span class="st">"after perturbation"</span>, </span></span>
<span class="r-in"><span>      <span class="st">"before perturbation"</span>, <span class="st">"interval average"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingdensity-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## compare trawl_metier with the dynamic model solution</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">S</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>    <span class="co"># swept area ratio</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">d</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tend</span>   <span class="op">&lt;-</span> <span class="fl">20</span>   </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fishD</span>  <span class="op">&lt;-</span> <span class="fu">trawl_metier</span> <span class="op">(</span>n   <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">tend</span>, </span></span>
<span class="r-in"><span>                        d   <span class="op">=</span> <span class="va">d</span>,</span></span>
<span class="r-in"><span>                        K   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        sar <span class="op">=</span> <span class="va">S</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fishD</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    K r D0     times times_end ntrawl_from ntrawl_to  density density_start</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 40 1 40 0.0000000 0.5000000           1         2 36.78864      36.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 40 1 40 0.5000000 0.8333333           2         3 28.38467      26.98165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 40 1 40 0.8333333 1.1666667           3         4 28.16887      26.75150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 40 1 40 1.1666667 1.5000000           4         5 27.99941      26.57107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 40 1 40 1.5000000 1.8333333           5         6 22.78654      21.14332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 40 1 40 1.8333333 2.1666667           6         7 23.58950      21.96409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   density_end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    37.47451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    29.72389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    29.52341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    29.36572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    24.40454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    25.18284</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dynamic run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">7</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="density.html">density_metier</a></span><span class="op">(</span>d   <span class="op">=</span> <span class="va">d</span>,</span></span>
<span class="r-in"><span>                       K   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       sar <span class="op">=</span> <span class="va">S</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span>,</span></span>
<span class="r-in"><span>                       as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="co"># compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">matplot.0D</span><span class="op">(</span><span class="va">Dens</span>, </span></span>
<span class="r-in"><span>           lty <span class="op">=</span> <span class="fl">1</span>, legend <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>           ylab <span class="op">=</span> <span class="st">"density"</span>, </span></span>
<span class="r-in"><span>           main <span class="op">=</span> <span class="st">"comparison trawl_metier and density_metier"</span><span class="op">)</span></span></span>
<span class="r-in"><span>           </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">fishD</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">fishD</span><span class="op">$</span><span class="va">density_start</span> ,  </span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">fishD</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">times_end</span>, <span class="va">density_end</span> ,  </span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">fishD</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span><span class="op">(</span><span class="va">times</span><span class="op">+</span><span class="va">times_end</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">density</span> ,  </span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">22</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"left"</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">15</span>, <span class="fl">1</span>, <span class="fl">22</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>      legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"density_metier"</span>, <span class="st">"after perturbation"</span>, </span></span>
<span class="r-in"><span>      <span class="st">"before perturbation"</span>, <span class="st">"interval average"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="trawlingdensity-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

