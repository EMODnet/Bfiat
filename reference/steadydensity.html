<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate steady-state density for logistic and perturbation model for one and more metiers. — steady-state density  • Bfiat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate steady-state density for logistic and perturbation model for one and more metiers. — steady-state density "><meta name="description" content="steady_perturb  and steady_logistic calculate the steady-state density of taxa, based on their carrying capacity K, on the fishing intensity (swept area ratio, sar or mortality m), and on the species-specific parameters r and d (rate of increase and depletion fraction)."><meta property="og:description" content="steady_perturb  and steady_logistic calculate the steady-state density of taxa, based on their carrying capacity K, on the fishing intensity (swept area ratio, sar or mortality m), and on the species-specific parameters r and d (rate of increase and depletion fraction)."><meta property="og:image" content="https://EMODnet.github.io/Bfiat/reference/figures/Logo_hex.png"><meta property="og:image:alt" content="Bfiat logo"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Bfiat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">How To</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to"><li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/Bfiat.html">Description</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples-of-use" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples of use</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples-of-use"><li><a class="dropdown-item" href="../articles/MWTL.html">The dutch monitoring data - fishing impact on density</a></li>
    <li><a class="dropdown-item" href="../articles/MWTL_EF.html">The dutch monitoring - fishing impact on ecosystem functioning</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://emodnet.github.io/Bfiat/"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate steady-state density for logistic and perturbation model for one and more metiers.</h1>

      <div class="d-none name"><code>steadydensity.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>steady_perturb</code>  and <code>steady_logistic</code> calculate the steady-state density of taxa, based on their carrying capacity K, on the fishing intensity (swept area ratio, sar or mortality m), and on the species-specific parameters r and d (rate of increase and depletion fraction).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">steady_perturb</span>  <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, </span>
<span>                sar <span class="op">=</span> <span class="fl">1</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">steady_metier</span>  <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>,  </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>, </span>
<span>                d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">steady_logistic</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, m <span class="op">=</span> <span class="va">m</span><span class="op">)</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-sar-">sar <a class="anchor" aria-label="anchor" href="#arg-sar-"></a></dt>
<dd><p>fishing intensity, estimated as Swept Area Ratio, units e.g. [m2/m2/year]. One number, or, (for steady_perturb) a vector of the same length as <code>density</code>.</p></dd>

  <dt id="arg-r-">r <a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>the rate of increase of each taxon, units e.g. [/year]. One number, or (for steady_perturb and steady_logistic) a vector.</p></dd>

  <dt id="arg-d-">d <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>depletion fraction due to fishing. One number, or (for steady_perturb) a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-k-">K <a class="anchor" aria-label="anchor" href="#arg-k-"></a></dt>
<dd><p>carrying capacity. One number, or (for steady_perturb and steady_logistic) a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-m-">m <a class="anchor" aria-label="anchor" href="#arg-m-"></a></dt>
<dd><p>the mortality rate for the continous model; if NA, it will be estimated from sar, r, d and K; a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-parms-">parms <a class="anchor" aria-label="anchor" href="#arg-parms-"></a></dt>
<dd><p>a data.frame with all parameters.</p></dd>

  <dt id="arg-d-">D0 <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>initial density. One number, or a vector of length = nrow(parms).</p></dd>

  <dt id="arg-tol-">tol <a class="anchor" aria-label="anchor" href="#arg-tol-"></a></dt>
<dd><p>tolerance between which the steady-state solution needs to be estimated. For <code>steady_perturb</code> and <code>steady_metier</code>, steady-state is assumed to be reached, if the successive values at 1/sar, Di and Di+1 differ less than atol + tol*Di+1, where atol is taken as 1e-10 (cannot be changed). For <code>steady_logistic</code>, the steady-state can be estimated analytically, and <code>tol</code> is only used to estimate the time it takes to bring the solution to within tol from the steady-state, i.e. for D0 &lt; S, the time it takes to reach to S*(1-tol), for D0 &gt; S, the time it takes to reach S*(1+tol).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>for <code>steady_perturb</code>: returns a data.frame with</p><ul><li><p><code>k, r, d, sar, D0</code>, the input parameters,</p></li>
<li><p><code>density_before, density_after</code>, density before and after trawling at steady-state,</p></li>
<li><p><code>density</code>, the estimated densities, averaged over the trawling interval at steady-state,</p></li>
<li><p><code>ntrawl</code>, the number of trawls where this was attained,</p></li>
<li><p><code>time</code>, the time when steady-state was reached (within tol).</p></li>
</ul><p>for <code>steady_logistic</code>: returns a data.frame with</p><ul><li><p><code>k, r, m, D0</code>, the input parameters,</p></li>
<li><p><code>density</code>, the estimated densities at steady-state,</p></li>
<li><p><code>density_within_tol</code>, the steady-state densities within tolerances,</p></li>
<li><p><code>time</code>, the time when steady-state was reached (within tol).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="trawlingfun.html">run_perturb</a> for how to run a disturbance model.</p>
<p><a href="density.html">density_perturb</a> for how to calculate densities of a model.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_nioz</a>, for trait databases in package Btrait.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/MWTLdensitydata.html" class="external-link">MWTL</a> for data sets on which fishing can be imposed.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/BtraitMap.html" class="external-link">map_key</a> for simple plotting functions.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hiddink, JG, Jennings, S, Sciberras, M, et al., 2019. Assessing bottom trawling impacts based on the longevity of benthic invertebrates. J Appl Ecol 56: 1075-1084. https://doi.org/10.1111/1365-2664.13278</p>
<p>Hiddink, Jan Geert, Simon Jennings, Marija Sciberras, Claire L. Szostek, Kathryn M. Hughes, Nick Ellis, Adriaan D. Rijnsdorp, Robert A. McConnaughey, Tessa Mazor, Ray Hilborn, Jeremy S. Collie, C. Roland Pitcher, Ricardo O. Amoroso, Ana M. Parma, Petri Suuronen, and Michel J. Kaiser, 2017.  Global analysis of depletion and recovery of seabed biota after bottom trawling disturbance. Proc. Nat. Aca. Sci, 114 (31) 8301-8306. https://doi.org/10.1073/pnas.161885811.</p>
<p>C.R. Pitcher, N. Ellis, S. Jennings, J.G. Hiddink, T. Mazor, M.J.Kaiser, M.I. Kangas, R.A. McConnaughey, A.M. Parma, A.D. Rijnsdorp, P. Suuronen, J.S. Collie, R. Amoroso, K.M. Hughes and R. Hilborn, 2017. Estimating the sustainability of towed fishing-gearimpacts on seabed habitats: a simple quantitative riskassessment method applicable to data-limited fisheries. Methods in Ecology and Evolution,8,472-480doi: 10.1111/2041-210X.12705</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Several inputs logistic model</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SL</span>  <span class="op">&lt;-</span> <span class="fu">steady_logistic</span><span class="op">(</span>r   <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                       K   <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                       m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.5</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                       tol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Several inputs perturbation model</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">S1</span>  <span class="op">&lt;-</span> <span class="fu">steady_perturb</span><span class="op">(</span>r   <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="fl">0.2</span>, </span></span>
<span class="r-in"><span>                      K   <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      tol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## - compare with analytic formula</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steady-state density can also be estimated using this formula</span></span></span>
<span class="r-in"><span><span class="co"># (from Pritchard, 2017): D = 1+ sar/r * log(1-d)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">S1</span><span class="op">$</span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">S1</span>, <span class="fl">1</span> <span class="op">+</span> <span class="va">sar</span><span class="op">/</span><span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The min and max density is also estimated with steady_perturb</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S1</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">density</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S1</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">density_before</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S1</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">density_after</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S1</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">DD</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean in interval"</span>, <span class="st">"before trawling"</span>, </span></span>
<span class="r-in"><span>                  <span class="st">"after trawling"</span>, <span class="st">"1+sar/r*log(1-d)"</span><span class="op">)</span><span class="op">)</span>     </span></span>
<span class="r-plt img"><img src="steadydensity-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># random combinations</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">S2</span>  <span class="op">&lt;-</span> <span class="fu">steady_perturb</span><span class="op">(</span>r   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0.5</span>,  max <span class="op">=</span> <span class="fl">2</span>,   n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0.01</span>, max <span class="op">=</span> <span class="fl">0.5</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      K   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0.1</span>,  max <span class="op">=</span> <span class="fl">500</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>,    max <span class="op">=</span> <span class="fl">4</span>,   n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      tol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steady-state density can also be estimated using this formula</span></span></span>
<span class="r-in"><span><span class="co"># (from Pritchard, 2017): D* = 1+ sar/r * log(1-d)</span></span></span>
<span class="r-in"><span><span class="va">S2</span><span class="op">$</span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">S2</span>, <span class="va">K</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">sar</span><span class="op">/</span><span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S2</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span> <span class="op">(</span><span class="va">density</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">DD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               xlab <span class="op">=</span> <span class="st">"numeric"</span>, </span></span>
<span class="r-in"><span>               ylab <span class="op">=</span> <span class="st">"analytic formula (Pritchard 2017)"</span>, </span></span>
<span class="r-in"><span>               main <span class="op">=</span> <span class="st">"mean steady-state density"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="steadydensity-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Compare steady-state solution with dynamic run</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># discrete parameter values and dynamic run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">parms</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.5</span>, d <span class="op">=</span> <span class="fl">0.2</span>, K <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sar</span>    <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>,      to <span class="op">=</span> <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">365</span>, to <span class="op">=</span> <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">sar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">run.discrete</span>   <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span><span class="op">(</span>parms  <span class="op">=</span> <span class="va">parms</span>, </span></span>
<span class="r-in"><span>                              times  <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                              events <span class="op">=</span> <span class="va">events</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># continuous simulation </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate continous mortality equivalent with event fishing</span></span></span>
<span class="r-in"><span><span class="va">m</span>              <span class="op">&lt;-</span> <span class="fu"><a href="trawlingpars.html">par_m</a></span><span class="op">(</span>sar <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                        r   <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"r"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                        d   <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"d"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                        K   <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"K"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># new parameter vector with mortality                     </span></span></span>
<span class="r-in"><span><span class="va">parms.c</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">parms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="st">"K"</span><span class="op">)</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                    m <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">run.continuous</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_logistic</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="va">parms.c</span>, </span></span>
<span class="r-in"><span>                               times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show both simulations in one figure</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">run.discrete</span>, <span class="va">run.continuous</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use steady_perturb to estimate the steady-state condition</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">std</span> <span class="op">&lt;-</span> <span class="fu">steady_perturb</span><span class="op">(</span>r   <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="fl">0.2</span>, </span></span>
<span class="r-in"><span>                      K   <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="va">sar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">std</span><span class="op">$</span><span class="va">density</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="steadydensity-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## time it takes to reach (quasi-steady state)</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># start from initial density = K; </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1. impose fishing for 30 years, then stop fishing</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p_perturb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">10</span>, </span></span>
<span class="r-in"><span>                  r <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                  d <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dynamic run</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="va">p_perturb</span>,</span></span>
<span class="r-in"><span>                   sar   <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                   times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   tend_perturb <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># steady-state under fishing (tol = 1e-6)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">std_fish</span> <span class="op">&lt;-</span> <span class="fu">steady_perturb</span><span class="op">(</span>parms <span class="op">=</span> <span class="va">p_perturb</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    K r   d sar D0 density_before density_after  density ntrawl time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 10 1 0.3   1 10       7.505804      5.254063 6.433244     17   17</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># steady-state when fishing stops </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p_unperturb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">10</span>, </span></span>
<span class="r-in"><span>                    r <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                    m <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>   <span class="co"># mortality = 0 (no fishing)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Initial condition = steady-state solution under fishing</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tol</span> <span class="op">&lt;-</span> <span class="fl">0.01</span>  <span class="co"># will estimate the time it takes to recover for 90%</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">std_nofish</span> <span class="op">&lt;-</span> <span class="fu">steady_logistic</span><span class="op">(</span>parms <span class="op">=</span> <span class="va">p_unperturb</span>,</span></span>
<span class="r-in"><span>                               D0    <span class="op">=</span> <span class="va">std_fish</span><span class="op">$</span><span class="va">density</span>,  <span class="co"># fishing steady-state</span></span></span>
<span class="r-in"><span>                               tol   <span class="op">=</span> <span class="va">tol</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    K r m       D0 density density_within_tol     time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 10 1 0 6.433244      10                9.9 4.005297</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot dynamic run</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add 90 percent density value</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">std_nofish</span>, </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">density_within_tol</span>,</span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="st">"orange"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>          </span></span>
<span class="r-in"><span><span class="co"># add time to reach the 90 percent density value</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">std_nofish</span>, </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">time</span> <span class="op">+</span> <span class="fl">30</span>,</span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="st">"orange"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>          </span></span>
<span class="r-plt img"><img src="steadydensity-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

