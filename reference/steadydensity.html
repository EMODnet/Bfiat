<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate steady-state density for logistic and perturbation model for one and more metiers. — steady-state density  • Bfiat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate steady-state density for logistic and perturbation model for one and more metiers. — steady-state density "><meta property="og:description" content="steady_perturb  and steady_logistic calculate the steady-state density of taxa, based on their carrying capacity K, on the fishing intensity (swept area ratio, sar or mortality m), and on the species-specific parameters r and d (rate of increase and depletion fraction)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bfiat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Bfiat.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MWTL_EF.html">R-package Bfiat - Modelling trawling effects on ecosystem functioning - MWTL data</a>
    </li>
    <li>
      <a href="../articles/MWTL.html">The Bfiat package: modelling trawling effects in the Dutch part of the Northsea</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate steady-state density for logistic and perturbation model for one and more metiers.</h1>

    <div class="hidden name"><code>steadydensity.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>steady_perturb</code>  and <code>steady_logistic</code> calculate the steady-state density of taxa, based on their carrying capacity K, on the fishing intensity (swept area ratio, sar or mortality m), and on the species-specific parameters r and d (rate of increase and depletion fraction).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">steady_perturb</span>  <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>, </span>
<span>                sar <span class="op">=</span> <span class="fl">1</span>, D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">steady_metier</span>  <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>,  </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>, </span>
<span>                d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">steady_logistic</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, m <span class="op">=</span> <span class="va">m</span><span class="op">)</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, tol <span class="op">=</span> <span class="fl">1e-06</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-sar-">sar <a class="anchor" aria-label="anchor" href="#arg-sar-"></a></dt>
<dd><p>fishing intensity, estimated as Swept Area Ratio, units e.g. [m2/m2/year]. One number, or, (for steady_perturb) a vector of the same length as <code>density</code>.</p></dd>

  <dt id="arg-r-">r <a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>the rate of increase of each taxon, units e.g. [/year]. One number, or (for steady_perturb and steady_logistic) a vector.</p></dd>

  <dt id="arg-d-">d <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>depletion fraction due to fishing. One number, or (for steady_perturb) a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-k-">K <a class="anchor" aria-label="anchor" href="#arg-k-"></a></dt>
<dd><p>carrying capacity. One number, or (for steady_perturb and steady_logistic) a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-m-">m <a class="anchor" aria-label="anchor" href="#arg-m-"></a></dt>
<dd><p>the mortality rate for the continous model; if NA, it will be estimated from sar, r, d and K; a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-parms-">parms <a class="anchor" aria-label="anchor" href="#arg-parms-"></a></dt>
<dd><p>a data.frame with all parameters.</p></dd>

  <dt id="arg-d-">D0 <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>initial density. One number, or a vector of length = nrow(parms).</p></dd>

  <dt id="arg-tol-">tol <a class="anchor" aria-label="anchor" href="#arg-tol-"></a></dt>
<dd><p>tolerance between which the steady-state solution needs to be estimated. Steady-state is assumed to be reached, if the successive values at 1/sar, Di and Di+1 differ less than atol + tol*Di+1, where atol is taken as 1e-10 (cannot be changed)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>for <code>steady_perturb</code>: returns a data.frame with</p><ul><li><p><code>k, r, d, sar, D0</code>, the input parameters,</p></li>
<li><p><code>density_before, density_after</code>, density before and after trawling at steady-state,</p></li>
<li><p><code>density</code>, the estimated densities, averaged over the trawling interval at steady-state,</p></li>
<li><p><code>ntrawl</code>, the number of trawls where this was attained,</p></li>
<li><p><code>time</code>, the time when steady-state was reached (within tol).</p></li>
</ul><p>for <code>steady_logistic</code>: returns a data.frame with</p><ul><li><p><code>k, r, m, D0</code>, the input parameters,</p></li>
<li><p><code>density</code>, the estimated densities at steady-state,</p></li>
<li><p><code>time</code>, the time when steady-state was reached (within tol).</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="trawlingfun.html">run_perturb</a> for how to run a disturbance model.</p>
<p><a href="density.html">density_perturb</a> for how to calculate densities of a model.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_nioz</a>, for trait databases in package Btrait.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/MWTLdensitydata.html" class="external-link">MWTL</a> for data sets on which fishing can be imposed.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/BtraitMap.html" class="external-link">map_key</a> for simple plotting functions.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Hiddink, JG, Jennings, S, Sciberras, M, et al., 2019. Assessing bottom trawling impacts based on the longevity of benthic invertebrates. J Appl Ecol 56: 1075-1084. https://doi.org/10.1111/1365-2664.13278</p>
<p>Hiddink, Jan Geert, Simon Jennings, Marija Sciberras, Claire L. Szostek, Kathryn M. Hughes, Nick Ellis, Adriaan D. Rijnsdorp, Robert A. McConnaughey, Tessa Mazor, Ray Hilborn, Jeremy S. Collie, C. Roland Pitcher, Ricardo O. Amoroso, Ana M. Parma, Petri Suuronen, and Michel J. Kaiser, 2017.  Global analysis of depletion and recovery of seabed biota after bottom trawling disturbance. Proc. Nat. Aca. Sci, 114 (31) 8301-8306. https://doi.org/10.1073/pnas.161885811.</p>
<p>C.R. Pitcher, N. Ellis, S. Jennings, J.G. Hiddink, T. Mazor, M.J.Kaiser, M.I. Kangas, R.A. McConnaughey, A.M. Parma, A.D. Rijnsdorp, P. Suuronen, J.S. Collie, R. Amoroso, K.M. Hughes and R. Hilborn, 2017. Estimating the sustainability of towed fishing-gearimpacts on seabed habitats: a simple quantitative riskassessment method applicable to data-limited fisheries. Methods in Ecology and Evolution,8,472-480doi: 10.1111/2041-210X.12705</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Several inputs logistic model</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SL</span>  <span class="op">&lt;-</span> <span class="fu">steady_logistic</span><span class="op">(</span>r   <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                       K   <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                       m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.5</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                       tol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Several inputs perturbation model</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">S1</span>  <span class="op">&lt;-</span> <span class="fu">steady_perturb</span><span class="op">(</span>r   <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="fl">0.2</span>, </span></span>
<span class="r-in"><span>                      K   <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      tol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## - compare with analytic formula</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steady-state density can also be estimated using this formula</span></span></span>
<span class="r-in"><span><span class="co"># (from Pritchard, 2017): D = 1+ sar/r * log(1-d)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">S1</span><span class="op">$</span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">S1</span>, <span class="fl">1</span> <span class="op">+</span> <span class="va">sar</span><span class="op">/</span><span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The min and max density is also estimated with steady_perturb</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S1</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">density</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S1</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">density_before</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S1</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">density_after</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S1</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span> <span class="op">(</span><span class="va">sar</span>, <span class="va">DD</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean in interval"</span>, <span class="st">"before trawling"</span>, </span></span>
<span class="r-in"><span>                  <span class="st">"after trawling"</span>, <span class="st">"1+sar/r*log(1-d)"</span><span class="op">)</span><span class="op">)</span>     </span></span>
<span class="r-plt img"><img src="steadydensity-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># random combinations</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">S2</span>  <span class="op">&lt;-</span> <span class="fu">steady_perturb</span><span class="op">(</span>r   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0.5</span>,  max <span class="op">=</span> <span class="fl">2</span>,   n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0.01</span>, max <span class="op">=</span> <span class="fl">0.5</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      K   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0.1</span>,  max <span class="op">=</span> <span class="fl">500</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fl">0</span>,    max <span class="op">=</span> <span class="fl">4</span>,   n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      tol <span class="op">=</span> <span class="fl">1e-9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Steady-state density can also be estimated using this formula</span></span></span>
<span class="r-in"><span><span class="co"># (from Pritchard, 2017): D* = 1+ sar/r * log(1-d)</span></span></span>
<span class="r-in"><span><span class="va">S2</span><span class="op">$</span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span> <span class="op">(</span><span class="va">S2</span>, <span class="va">K</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">sar</span><span class="op">/</span><span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">S2</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span> <span class="op">(</span><span class="va">density</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">DD</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               xlab <span class="op">=</span> <span class="st">"numeric"</span>, </span></span>
<span class="r-in"><span>               ylab <span class="op">=</span> <span class="st">"analytic formula (Pritchard 2017)"</span>, </span></span>
<span class="r-in"><span>               main <span class="op">=</span> <span class="st">"mean steady-state density"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="steadydensity-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Compare steady-state solution with dynamic run</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># discrete parameter values and dynamic run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">parms</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.5</span>, d <span class="op">=</span> <span class="fl">0.2</span>, K <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sar</span>    <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>,      to <span class="op">=</span> <span class="fl">20</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">365</span>, to <span class="op">=</span> <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">sar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">run.discrete</span>   <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span><span class="op">(</span>parms  <span class="op">=</span> <span class="va">parms</span>, </span></span>
<span class="r-in"><span>                              times  <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                              events <span class="op">=</span> <span class="va">events</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># continuous simulation </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate continous mortality equivalent with event fishing</span></span></span>
<span class="r-in"><span><span class="va">m</span>              <span class="op">&lt;-</span> <span class="fu"><a href="trawlingpars.html">par_m</a></span><span class="op">(</span>sar <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                        r   <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"r"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                        d   <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"d"</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                        K   <span class="op">=</span> <span class="va">parms</span><span class="op">[</span><span class="st">"K"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># new parameter vector with mortality                     </span></span></span>
<span class="r-in"><span><span class="va">parms.c</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">parms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r"</span>, <span class="st">"K"</span><span class="op">)</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                    m <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">run.continuous</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_logistic</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="va">parms.c</span>, </span></span>
<span class="r-in"><span>                               times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show both simulations in one figure</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">run.discrete</span>, <span class="va">run.continuous</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use steady_perturb to estimate the steady-state condition</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">std</span> <span class="op">&lt;-</span> <span class="fu">steady_perturb</span><span class="op">(</span>r   <span class="op">=</span> <span class="fl">0.5</span>, </span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="fl">0.2</span>, </span></span>
<span class="r-in"><span>                      K   <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="va">sar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">std</span><span class="op">$</span><span class="va">density</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="steadydensity-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

