<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>From model output (time x taxon density) to time x bioturbation or time x bioirrigation potentials. — Bioturbation and bioirrigation indices from Model output • Bfiat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="From model output (time x taxon density) to time x bioturbation or time x bioirrigation potentials. — Bioturbation and bioirrigation indices from Model output"><meta property="og:description" content="get_Db_model and get_irr_model combine output of a biological model that describes how taxa evolve with time with a trait database to obtain how bioturbation and bioirrigation potentials evolve over time.  They estimate the bioturbation potential index (BPc) sensu Querios et al., 2013 and Solan et al., 2004, and the bioirrigation potential index (IPc) sensu Wrede et al., 2018, respectively."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bfiat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Bfiat.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MWTL_EF.html">R-package Bfiat - Modelling trawling effects on ecosystem functioning - MWTL data</a>
    </li>
    <li>
      <a href="../articles/MWTL.html">The Bfiat package: modelling trawling effects in the Dutch part of the Northsea</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>From model output (time x taxon density) to time x bioturbation or time x bioirrigation potentials.</h1>

    <div class="hidden name"><code>getDbModel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>get_Db_model</code> and <code>get_irr_model</code> combine output of a biological model that describes how taxa evolve with time with a trait database to obtain how bioturbation and bioirrigation potentials evolve over time.  They estimate the bioturbation potential index (BPc) sensu Querios et al., 2013 and Solan et al., 2004, and the bioirrigation potential index (IPc) sensu Wrede et al., 2018, respectively.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_Db_model</span><span class="op">(</span><span class="va">model</span>, trait <span class="op">=</span> <span class="fu">Btrait</span><span class="fu">::</span><span class="va"><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_Db</a></span>, </span>
<span>             taxon_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, taxonomy <span class="op">=</span> <span class="cn">NULL</span>,  </span>
<span>             <span class="va">weight</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>  </span>
<span></span>
<span><span class="fu">get_irr_model</span><span class="op">(</span><span class="va">model</span>, trait <span class="op">=</span> <span class="fu">Btrait</span><span class="fu">::</span><span class="va"><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_irr</a></span>, </span>
<span>              taxon_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, taxonomy <span class="op">=</span> <span class="cn">NULL</span>,  </span>
<span>              <span class="va">weight</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, na.rm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>dynamic model output that describes how taxa change over time. This is a matrix with (time x taxon) information, such as generated from the function <a href="trawlingfun.html">run_perturb</a> or <code>density+perturb</code>. The first column should contain the time, and the other columns the taxon density trajectories over time, with the column names the taxon names, if not in <code>taxon.name</code>. (see note for the taxon names)</p></dd>

  <dt id="arg-taxon-names">taxon_names<a class="anchor" aria-label="anchor" href="#arg-taxon-names"></a></dt>
<dd><p>names of the taxa, one for each column in <code>model</code>, except the first column. A vector of length = ncol(model) - 1. These names will be matched with the trait database, and optionally with <code>weight</code> if this is a two-columned matrix/data.frame.</p></dd>

  <dt id="arg-trait">trait<a class="anchor" aria-label="anchor" href="#arg-trait"></a></dt>
<dd><p>(taxon x trait) data. For <code>get_Db_model</code>, <code>traits</code> should contain the columns <code>Ri</code> and <code>Mi</code> (with the reworking and mobility traits). For use in <code>get_irr_model</code>, <code>traits</code> should contain columns <code>BT</code> and <code>FT</code>, and <code>ID</code>, the burrowing type, feeding type, and injection depth respectively. The trait matrix should have the names of the taxa in its first column. A good choice of a trait database for estimating bioturbation potentials is <a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_Db</a>; a good choice for estimating bioirrigation potentials is <a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_irr</a>.</p></dd>

  <dt id="arg-verbose-">verbose <a class="anchor" aria-label="anchor" href="#arg-verbose-"></a></dt>
<dd><p>when TRUE, will write warnings to the screen.</p></dd>

  <dt id="arg-na-rm-">na.rm <a class="anchor" aria-label="anchor" href="#arg-na-rm-"></a></dt>
<dd><p>when TRUE, will remove species for which trait could not be estimated (as not present in the trait database).</p></dd>

  <dt id="arg-taxonomy-">taxonomy <a class="anchor" aria-label="anchor" href="#arg-taxonomy-"></a></dt>
<dd><p>taxonomic information; first column will be matched with <code>taxon</code>, regardless of its name.</p></dd>

  <dt id="arg-weight-">weight <a class="anchor" aria-label="anchor" href="#arg-weight-"></a></dt>
<dd><p>either a vector with a value for each trajectory in model (and with length = ncol(model) - 1), or a <code>data.frame</code> with taxon (first column) versus weight (2nd column) characteristics for each taxon in the <code>model</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>get_Db_model</code> returns the time x Db-index matrix of class <code>deSolve</code>. Both the bioturbation index for each taxon ("BPC_taxon.."), and the summed index is returned ("BPc").</p>
<p><code>get_irr_model</code> returns the time x Irr-index density matrix of class <code>deSolve</code>. Both the irrigation index for each taxon ("IPC_taxon.."), and the summed index is returned ("IPc").</p>
<p>The result has in its attributes a vector called "Factor", which is the constant factor with which the model output has been multiplied; for <code>get_Db_model</code>, this is estimated as sqrt(weight)*Mi*Ri; for <code>get_irr_model</code>, this is estimated as (weight)^0.75*FT*BT*ID.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>*** About taxon names ****</p>
<p>The names of the columns in <code>model</code> should have the taxon names, that are also found in the trait database. This can create a problem if the model output is a <code>data.frame</code> and the taxon names contain blancs. In this case, the names will have "." rather than " ".</p>
<p>This can be solved by either</p><ul><li><p>(1) by making the names in the trait database consistent with the model output (use R-function <code><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names()</a></code> to convert names with spaces to good names, as used in data.frames), or</p></li>
<li><p>(2) by specifying the true names in argument <code>taxon_names</code> that has the actual taxon names (in the order of the columns).</p></li>
</ul><p>*** Formulae ****</p>
<ul><li><p>get_Db_model: The formula for estimating the bioturbation Index for taxon i (as in Querios et al., 2013) is:</p>
<p>BPc_i = sqrt(Wi) * density_i * Ri*Wi</p></li>
<li><p>get_irr_model: The formula for estimating the bioirrigation Index for taxon i (as in Wrede et al., 2018) is:</p>
<p>IPc_i = (Wi)^(0.75) * density_i * BTi*FTi*IDi</p></li>
<li><p>The stations Index is the sum of all species indices.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="trawlingfun.html">run_perturb</a> for the disturbance model.</p>
<p><a href="getTraitModel.html">get_trait_model</a> for deriving functional traits from a perturbation or logistic model.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_Db</a>, for trait databases in packge Btrait..</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/getTraitDensity.html" class="external-link">get_trait_density</a>, for the function on which <code>get_trait_model</code> is based.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/traitfun.html" class="external-link">get_trait</a> for functions from package Btrait to extract traits</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Queiros, Ana M., Silvana N. R. Birchenough, Julie Bremner, Jasmin A. Godbold, Ruth E. Parker, Alicia Romero-Ramirez, Henning Reiss, Martin Solan, Paul J. Somerfield, Carl Van Colen, Gert Van Hoey, Stephen Widdicombe, 2013. A bioturbation classification of European marine infaunal invertebrates. Ecology and Evolution 3 (11), 3958-3985</p>
<p>Solan M, Cardinale BJ, Downing AL, Engelhardt KAM, Ruesink JL, Srivastava DS. 2004. Extinction and ecosystem function in the marine benthos. Science 306:1177-80.</p>
<p>A. Wrede, J.Beermann, J.Dannheim, L.Gutow, T.Brey, 2018. Organism functional traits and ecosystem supporting services - A novel approach to predict bioirrigation. Ecological indicators, 91, 737-743.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## A small model</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">Trawl.pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    taxon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span><span class="op">)</span>,  <span class="co"># name of taxa</span></span></span>
<span class="r-in"><span>    r     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">3</span>,      <span class="fl">1</span>,    <span class="fl">20</span>,    <span class="fl">0.1</span><span class="op">)</span>,  <span class="co"># rate of increase (/year)</span></span></span>
<span class="r-in"><span>    K     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">1</span>,     <span class="fl">10</span>,   <span class="fl">0.5</span>,    <span class="fl">10</span> <span class="op">)</span>,  <span class="co"># carrying capacity (density or biomass)</span></span></span>
<span class="r-in"><span>    d     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="fl">0.1</span>,    <span class="fl">0.1</span>,   <span class="fl">0.5</span>,   <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>  <span class="co"># instantaneous depletion</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># run the model for 5 years </span></span></span>
<span class="r-in"><span> <span class="va">times</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span>             <span class="co"># time in years (consistent with pars)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># trawling frequency once / twice per year</span></span></span>
<span class="r-in"><span> <span class="va">trawl1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, by<span class="op">=</span><span class="fl">1</span>,   to<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">trawl2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span>, by<span class="op">=</span><span class="fl">0.5</span>, to<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># run the model</span></span></span>
<span class="r-in"><span> <span class="va">trawl1run</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span> <span class="op">(</span>parms  <span class="op">=</span> <span class="va">Trawl.pars</span>, </span></span>
<span class="r-in"><span>                           times  <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                           events <span class="op">=</span> <span class="va">trawl1</span><span class="op">)</span>     </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">trawl2run</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span> <span class="op">(</span>parms  <span class="op">=</span> <span class="va">Trawl.pars</span>, </span></span>
<span class="r-in"><span>                           times  <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                           events <span class="op">=</span> <span class="va">trawl2</span><span class="op">)</span>     </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">trawl1run</span>, <span class="va">trawl2run</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="getDbModel-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Small dataset: taxonomy</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Btaxonomy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  genus   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"g.1"</span>, <span class="st">"g.2"</span>, <span class="st">"g.2"</span>, <span class="st">"g.2"</span>, <span class="st">"g.3"</span>, <span class="st">"g.4"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  family  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.1"</span>, <span class="st">"f.2"</span>, <span class="st">"f.3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  order   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.1"</span>, <span class="st">"o.2"</span>, <span class="st">"o.2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  class   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span>, <span class="st">"c.1"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Db and Irr traits</span></span></span>
<span class="r-in"><span><span class="co">##-----------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Note: no data for "sp.4"</span></span></span>
<span class="r-in"><span><span class="va">DbTraits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  taxon   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Ri      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>     , <span class="fl">1</span>    ,   <span class="fl">3</span>  ,   <span class="fl">2</span>  ,     <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Mi      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>     , <span class="fl">2</span>    ,   <span class="fl">2</span>  ,   <span class="fl">3</span>  ,     <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IrrTraits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  taxon   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  BT      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>     , <span class="fl">1</span>    ,   <span class="fl">3</span>  ,   <span class="fl">2</span>  ,     <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  FT      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>     , <span class="fl">2.5</span>  ,   <span class="fl">2</span>  ,   <span class="fl">3</span>  ,     <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ID      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>     , <span class="fl">2</span>    ,   <span class="fl">1</span>  ,   <span class="fl">3</span>  ,     <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Weight of the species - it is assumed this does not change over time</span></span></span>
<span class="r-in"><span><span class="va">Weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>taxon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sp.1"</span>,<span class="st">"sp.2"</span>,<span class="st">"sp.3"</span>,<span class="st">"sp.4"</span>,<span class="st">"sp.5"</span>,<span class="st">"sp.6"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     weight <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,   <span class="fl">0.2</span>,     <span class="fl">3</span>,  <span class="fl">0.04</span>,   <span class="fl">0.5</span>,     <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                     </span></span>
<span class="r-in"><span><span class="va">DbRun</span>  <span class="op">&lt;-</span> <span class="fu">get_Db_model</span> <span class="op">(</span>model       <span class="op">=</span> <span class="va">trawl1run</span>,  </span></span>
<span class="r-in"><span>                        trait       <span class="op">=</span> <span class="va">DbTraits</span>, </span></span>
<span class="r-in"><span>                        weight      <span class="op">=</span> <span class="va">Weight</span><span class="op">)</span></span></span>
<span class="r-in"><span>                      </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DbRun</span><span class="op">)</span>   <span class="co"># contains NA for sp.4 that is not in DbTraits</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             time  BPc_sp.1 BPc_sp.2 BPc_sp.3 BPc_sp.4      BPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.000000000 0.3162278 8.944272 5.196152       NA 14.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.002739726 0.3162278 8.944272 5.196152       NA 14.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.005479452 0.3162278 8.944272 5.196152       NA 14.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.008219178 0.3162278 8.944272 5.196152       NA 14.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.010958904 0.3162278 8.944272 5.196152       NA 14.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 0.013698630 0.3162278 8.944272 5.196152       NA 14.45665</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">DbRun</span><span class="op">)</span><span class="op">$</span><span class="va">notrait</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sp.4"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use taxonomy to also estimate Db for sp.4</span></span></span>
<span class="r-in"><span><span class="va">DbRun1</span> <span class="op">&lt;-</span> <span class="fu">get_Db_model</span> <span class="op">(</span>model       <span class="op">=</span> <span class="va">trawl1run</span>,  </span></span>
<span class="r-in"><span>                        trait       <span class="op">=</span> <span class="va">DbTraits</span>, </span></span>
<span class="r-in"><span>                        weight      <span class="op">=</span> <span class="va">Weight</span>,</span></span>
<span class="r-in"><span>                        taxonomy    <span class="op">=</span> <span class="va">Btaxonomy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">DbRun1</span><span class="op">)</span>  <span class="co"># sp.4 estimated based on taxonomic closeness</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             time  BPc_sp.1 BPc_sp.2 BPc_sp.3 BPc_sp.4      BPc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.000000000 0.3162278 8.944272 5.196152        8 22.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.002739726 0.3162278 8.944272 5.196152        8 22.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.005479452 0.3162278 8.944272 5.196152        8 22.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.008219178 0.3162278 8.944272 5.196152        8 22.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.010958904 0.3162278 8.944272 5.196152        8 22.45665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6,] 0.013698630 0.3162278 8.944272 5.196152        8 22.45665</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co"># Show results - note: no sp4 for DbRun, so only one line</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">DbRun1</span>, <span class="va">DbRun</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Irrigation potential index</span></span></span>
<span class="r-in"><span><span class="va">IrrRun1</span> <span class="op">&lt;-</span> <span class="fu">get_irr_model</span> <span class="op">(</span>model       <span class="op">=</span> <span class="va">trawl1run</span>,  </span></span>
<span class="r-in"><span>                          trait       <span class="op">=</span> <span class="va">IrrTraits</span>, </span></span>
<span class="r-in"><span>                          weight      <span class="op">=</span> <span class="va">Weight</span>,</span></span>
<span class="r-in"><span>                          taxonomy    <span class="op">=</span> <span class="va">Btaxonomy</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">IrrRun1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="getDbModel-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-plt img"><img src="getDbModel-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

