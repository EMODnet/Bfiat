<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimates density at specific times for the logistic and perturbation model. density_metier allows to specify different metiers. — density  • Bfiat</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimates density at specific times for the logistic and perturbation model. density_metier allows to specify different metiers. — density "><meta property="og:description" content="density_perturb, density_metier, and density_logistic calculates the density at specific times for the perturbation (one metier, several metiers) and the continuous model respectively. Fishing is implemented as swept area ratios."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bfiat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Bfiat.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MWTL_EF.html">R-package Bfiat - Modelling trawling effects on ecosystem functioning - MWTL data</a>
    </li>
    <li>
      <a href="../articles/MWTL.html">The Bfiat package: modelling trawling effects in the Dutch part of the Northsea</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimates density at specific times for the logistic and perturbation model. <code>density_metier</code> allows to specify different metiers.</h1>

    <div class="hidden name"><code>density.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>density_perturb</code>, <code>density_metier</code>, and <code>density_logistic</code> calculates the density at specific times for the perturbation (one metier, several metiers) and the continuous model respectively. Fishing is implemented as swept area ratios.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">density_perturb</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>,</span>
<span>                sar <span class="op">=</span> <span class="fl">1</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, </span>
<span>                tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, </span>
<span>                as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">density_metier</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>,</span>
<span>                d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,   </span>
<span>                taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, </span>
<span>                tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, </span>
<span>                as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">density_logistic</span><span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, m <span class="op">=</span> <span class="va">m</span><span class="op">)</span>,</span>
<span>                taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, </span>
<span>                as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-sar-">sar <a class="anchor" aria-label="anchor" href="#arg-sar-"></a></dt>
<dd><p>fishing intensity, estimated as Swept Area Ratio, units e.g. [m2/m2/year]. For <code>density_perturb</code>: one number; this will be ignored if a column named "sar" is present in <code>parms</code>. For <code>density_metier</code>, a data.frame with one value per metier.</p></dd>

  <dt id="arg-r-">r <a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>the rate of increase of each taxon, units e.g. [/year]. One number, or a vector (one value per taxon).</p></dd>

  <dt id="arg-d-">d <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>depletion fraction due to fishing. For <code>density_perturb</code>: one number, or a vector of same length as <code>r</code>.  For <code>density_metier</code>, a data.frame with nrows = length(r), and ncols = number of metiers, containing one number per metier and per taxon.</p></dd>

  <dt id="arg-m-">m <a class="anchor" aria-label="anchor" href="#arg-m-"></a></dt>
<dd><p>mortality rate. One number, or a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-k-">K <a class="anchor" aria-label="anchor" href="#arg-k-"></a></dt>
<dd><p>carrying capacity. One number, or a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-parms-">parms <a class="anchor" aria-label="anchor" href="#arg-parms-"></a></dt>
<dd><p>a data.frame with all parameters. If it also includes a column labeled "times" or "sar", then the argument(s) with the same name will be ignored.</p></dd>

  <dt id="arg-taxon-names-">taxon_names <a class="anchor" aria-label="anchor" href="#arg-taxon-names-"></a></dt>
<dd><p>a vector with names of the taxa whose characteristics are present in <code>parms</code>. Should be of the same length as (the number of rows of) <code>parms</code>. When not present or <code>NULL</code>, and the parms vector does not have row.names, the taxa in the output will be labeled <code>"tax_1"</code>, <code>"tax_2"</code>, etc.</p></dd>

  <dt id="arg-d-">D0 <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>initial density. One number, or a vector of length = nrow(parms).</p></dd>

  <dt id="arg-times-">times <a class="anchor" aria-label="anchor" href="#arg-times-"></a></dt>
<dd><p>time at which to estimate the density. One number, or a vector. Ignored if <code>parms</code> contains a column labeled <code>"times"</code>.</p></dd>

    <dt id="arg-tstart-perturb-tend-perturb-">tstart_perturb, tend_perturb <a class="anchor" aria-label="anchor" href="#arg-tstart-perturb-tend-perturb-"></a></dt>
<dd><p>time at which the perturbation starts and stops - before tsart_perturb and after tend_perturb, no events will occur (<code>density_perturb, density_metier</code>) or the mortality parameter will be set = 0 (<code>density_logistic</code>.</p></dd>

  <dt id="arg-as-desolve-">as.deSolve <a class="anchor" aria-label="anchor" href="#arg-as-desolve-"></a></dt>
<dd><p>if <code>TRUE</code>, will return an object of class deSolve, where the first column is time; if <code>FALSE</code>, the first columns will contain the parameters, and the values for the <code>times</code> will make up the remaining columns.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>


<p>If <code>as.deSolve</code> is <code>FALSE</code>, and <code>times</code> is part of the argument <code>parms</code>,
 returns a <code>data.frame</code>, with the following columns:</p>
<p></p><ul><li><p>for <code>density_logistic</code>:</p>
<p></p><ul><li><p><code>K, r, m</code>: the model parameters,</p></li>
<li><p><code>D0</code>: the initial condition,</p></li>
<li><p><code>times</code>, the times as in the argument <code>times</code>,</p></li>
<li><p><code>density</code>, the requested density at <code>times</code>.</p></li>
</ul></li>
<li><p>for <code>density_perturb</code>:</p>
<p></p><ul><li><p><code>K, r, d</code>: the model parameters,</p></li>
<li><p><code>sar</code>: the swept area ratio,</p></li>
<li><p><code>D0</code>: the initial condition,</p></li>
<li><p><code>times</code>, the times as in the argument <code>times</code>,</p></li>
<li><p><code>density</code>, the requested density at <code>times</code>.</p></li>
</ul></li>
</ul><p>If <code>as.deSolve</code> is <code>FALSE</code>, and <code>times</code> is a vector:
 returns a <code>data.frame</code>, with the following columns:</p>
<p></p><ul><li><p>for <code>density_logistic</code>:</p>
<p></p><ul><li><p><code>K, r, m</code>: the model parameters,</p></li>
<li><p><code>D0</code>: the initial condition,</p></li>
<li><p><code>Dt_..</code>, columns with the density for each value in the argument <code>times</code></p></li>
</ul></li>
<li><p>for <code>density_perturb</code>:</p>
<p></p><ul><li><p><code>K, r, d</code>: the model parameters,</p></li>
<li><p><code>sar</code>: the swept area ratio,</p></li>
<li><p><code>D0</code>: the initial condition,</p></li>
<li><p><code>Dt_..</code>, columns with the density for each value in the argument <code>times</code></p></li>
</ul></li>
</ul><p>If <code>as.deSolve</code> is <code>TRUE</code>, returns an object of class <code>deSolve</code>:</p>
<p></p><ul><li><ul><li><p><code>time</code>: the time as in the argument <code>times</code></p></li>
<li><p><code>..</code>, columns with the density for each row in the argument <code>parms</code></p></li>
</ul></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="trawlingdensity.html">trawl_perturb</a> for density before, after trawling and mean density inbetween trawling.</p>
<p><a href="steadydensity.html">steady_perturb</a> for steady-state calculations.</p>
<p><a href="trawlingfun.html">run_perturb</a> for how to run a disturbance model with unregularly spaced events.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_nioz</a>, for trait databases in package Btrait.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/MWTLdensitydata.html" class="external-link">MWTL</a> for data sets on which fishing can be imposed.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/BtraitMap.html" class="external-link">map_key</a> for simple plotting functions.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Hiddink, JG, Jennings, S, Sciberras, M, et al., 2019. Assessing bottom trawling impacts based on the longevity of benthic invertebrates. J Appl Ecol 56: 1075-1084. https://doi.org/10.1111/1365-2664.13278</p>
<p>Hiddink, Jan Geert, Simon Jennings, Marija Sciberras, Claire L. Szostek, Kathryn M. Hughes, Nick Ellis, Adriaan D. Rijnsdorp, Robert A. McConnaughey, Tessa Mazor, Ray Hilborn, Jeremy S. Collie, C. Roland Pitcher, Ricardo O. Amoroso, Ana M. Parma, Petri Suuronen, and Michel J. Kaiser, 2017.  Global analysis of depletion and recovery of seabed biota after bottom trawling disturbance. Proc. Nat. Aca. Sci, 114 (31) 8301-8306. https://doi.org/10.1073/pnas.161885811.</p>
<p>C.R. Pitcher, N. Ellis, S. Jennings, J.G. Hiddink, T. Mazor, M.J.Kaiser, M.I. Kangas, R.A. McConnaughey, A.M. Parma, A.D. Rijnsdorp, P. Suuronen, J.S. Collie, R. Amoroso, K.M. Hughes and R. Hilborn, 2017. Estimating the sustainability of towed fishing-gearimpacts on seabed habitats: a simple quantitative riskassessment method applicable to data-limited fisheries. Methods in Ecology and Evolution,8,472-480doi: 10.1111/2041-210X.12705</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Simple runs</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">T1</span> <span class="op">&lt;-</span> <span class="fu">density_perturb</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, D0 <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>                       tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                       tend_perturb   <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span>      </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu">density_metier</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, D0 <span class="op">=</span> <span class="fl">50</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       tstart_perturb <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                       tend_perturb   <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span>      </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">T3</span> <span class="op">&lt;-</span> <span class="fu">density_logistic</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.7</span>, D0 <span class="op">=</span> <span class="fl">50</span>, </span></span>
<span class="r-in"><span>                       tstart_perturb <span class="op">=</span> <span class="fl">2</span>, </span></span>
<span class="r-in"><span>                       tend_perturb   <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span>      </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">T1</span>, <span class="va">T2</span>, <span class="va">T3</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="density-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Compare density_perturb with dynamic run_perturb</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">8.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">T1</span> <span class="op">&lt;-</span> <span class="fu">density_perturb</span> <span class="op">(</span>K     <span class="op">=</span> <span class="fl">100</span>, </span></span>
<span class="r-in"><span>                       tstart_perturb <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span>      </span></span>
<span class="r-in"><span><span class="va">T1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   times        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.0 90.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.5 93.68627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1.5 91.32927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   2.5 90.39963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   8.5 89.77085</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dynamic run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rP</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  sar   <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rP</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">"comparison density_perturb and run_perturb"</span><span class="op">)</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">T1</span>, </span></span>
<span class="r-in"><span>       pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span></span>
<span class="r-in"><span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"run_perturb"</span>, </span></span>
<span class="r-in"><span>                   <span class="st">"density_perturb"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span>       </span></span>
<span class="r-plt img"><img src="density-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>       </span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Compare density_logistic with dynamic run_logistic</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">8.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu">density_logistic</span><span class="op">(</span>K     <span class="op">=</span> <span class="fl">100</span>, </span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">T2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   times         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.0 100.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.5  96.12949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1.5  92.39526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   2.5  90.95870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   8.5  90.00428</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dynamic run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rL</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_logistic</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rL</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">"comparison density_logistic and run_logistic"</span><span class="op">)</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">T2</span>,   </span></span>
<span class="r-in"><span>       pch <span class="op">=</span> <span class="fl">18</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span></span>
<span class="r-in"><span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"run_logistic"</span>, </span></span>
<span class="r-in"><span>                   <span class="st">"density_logistic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span>       </span></span>
<span class="r-plt img"><img src="density-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Several metiers, one taxon</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># 2 metiers</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu">density_metier</span> <span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>,</span></span>
<span class="r-in"><span>                      K   <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                      as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with one metier run,                       </span></span></span>
<span class="r-in"><span><span class="va">P1</span> <span class="op">&lt;-</span> <span class="fu">density_perturb</span><span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                      K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sar</span><span class="op">)</span>,  <span class="co"># sum of sar</span></span></span>
<span class="r-in"><span>                      as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">P1</span>, <span class="va">M1</span>, lty <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"one or two metiers"</span>, </span></span>
<span class="r-in"><span>     las <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sar = 3"</span>, <span class="st">"sar = (1, 2)"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="density-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Several metiers, multiple taxa</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4 taxa, 3 metiers</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sar1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                sar2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                sar3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                </span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,  <span class="fl">1</span>,   <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,  <span class="fl">2</span>, <span class="fl">1.5</span>,  <span class="fl">2</span><span class="op">)</span>    </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span>, <span class="fl">1.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu">density_metier</span> <span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>,</span></span>
<span class="r-in"><span>                      K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,</span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="va">d</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                      as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare with the single metier model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># average depletion</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">d</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">sar</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">sar</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">sar</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sar</span><span class="op">)</span>                      </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">P1</span> <span class="op">&lt;-</span> <span class="fu">density_perturb</span><span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                      K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, </span></span>
<span class="r-in"><span>                      d <span class="op">=</span> <span class="va">d1</span>,</span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sar</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">P1</span>, <span class="va">M1</span>, lty <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>     las <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sar = 4.3"</span>, <span class="st">"sar = (1, 2, 1.3)"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, <span class="st">"one or multiple metiers"</span>, outer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="density-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

