<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimates density at specific times for the logistic and perturbation model. density_metier allows to specify different metiers. — density  • Bfiat</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimates density at specific times for the logistic and perturbation model. density_metier allows to specify different metiers. — density "><meta name="description" content="density_perturb, density_metier, and density_logistic calculates the density at specific times for the perturbation (one metier, several metiers) and the continuous model respectively. Fishing is implemented as swept area ratios."><meta property="og:description" content="density_perturb, density_metier, and density_logistic calculates the density at specific times for the perturbation (one metier, several metiers) and the continuous model respectively. Fishing is implemented as swept area ratios."><meta property="og:image" content="https://EMODnet.github.io/Bfiat/reference/figures/Logo_hex.png"><meta property="og:image:alt" content="Bfiat logo"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="inverse" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Bfiat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-how-to" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">How To</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-how-to"><li><a class="dropdown-item" href="../articles/installation.html">Installation</a></li>
    <li><a class="dropdown-item" href="../articles/Bfiat.html">Description</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples-of-use" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples of use</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples-of-use"><li><a class="dropdown-item" href="../articles/MWTL.html">The dutch monitoring data - fishing impact on density</a></li>
    <li><a class="dropdown-item" href="../articles/MWTL_EF.html">The dutch monitoring - fishing impact on ecosystem functioning</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> functions</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://emodnet.github.io/Bfiat/"><span class="fa fa-github fa-lg"></span> github</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimates density at specific times for the logistic and perturbation model. <code>density_metier</code> allows to specify different metiers.</h1>

      <div class="d-none name"><code>density.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>density_perturb</code>, <code>density_metier</code>, and <code>density_logistic</code> calculates the density at specific times for the perturbation (one metier, several metiers) and the continuous model respectively. Fishing is implemented as swept area ratios.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">density_perturb</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, d <span class="op">=</span> <span class="va">d</span><span class="op">)</span>,</span>
<span>                sar <span class="op">=</span> <span class="fl">1</span>, taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, </span>
<span>                tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, </span>
<span>                as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">density_metier</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span><span class="op">)</span>,</span>
<span>                d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,   </span>
<span>                taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">/</span><span class="va">sar</span>, </span>
<span>                tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, </span>
<span>                as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">density_logistic</span><span class="op">(</span>K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>                parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, m <span class="op">=</span> <span class="va">m</span><span class="op">)</span>,</span>
<span>                taxon_names <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"taxon"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                D0 <span class="op">=</span> <span class="va">parms</span><span class="op">[[</span><span class="st">"K"</span><span class="op">]</span><span class="op">]</span>, times <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                tstart_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, tend_perturb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>, </span>
<span>                as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-sar-">sar <a class="anchor" aria-label="anchor" href="#arg-sar-"></a></dt>
<dd><p>fishing intensity, estimated as Swept Area Ratio, units e.g. [m2/m2/year]. For <code>density_perturb</code>: one number; this will be ignored if a column named "sar" is present in <code>parms</code>. For <code>density_metier</code>, a data.frame with one value per metier.</p></dd>

  <dt id="arg-r-">r <a class="anchor" aria-label="anchor" href="#arg-r-"></a></dt>
<dd><p>the rate of increase of each taxon, units e.g. [/year]. One number, or a vector (one value per taxon).</p></dd>

  <dt id="arg-d-">d <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>depletion fraction due to fishing. For <code>density_perturb</code>: one number, or a vector of same length as <code>r</code>.  For <code>density_metier</code>, a data.frame with nrows = length(r), and ncols = number of metiers, containing one number per metier and per taxon.</p></dd>

  <dt id="arg-m-">m <a class="anchor" aria-label="anchor" href="#arg-m-"></a></dt>
<dd><p>mortality rate. One number, or a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-k-">K <a class="anchor" aria-label="anchor" href="#arg-k-"></a></dt>
<dd><p>carrying capacity. One number, or a vector of same length as <code>r</code>.</p></dd>

  <dt id="arg-parms-">parms <a class="anchor" aria-label="anchor" href="#arg-parms-"></a></dt>
<dd><p>a data.frame with all parameters. If it also includes a column labeled "times" or "sar", then the argument(s) with the same name will be ignored.</p></dd>

  <dt id="arg-taxon-names-">taxon_names <a class="anchor" aria-label="anchor" href="#arg-taxon-names-"></a></dt>
<dd><p>a vector with names of the taxa whose characteristics are present in <code>parms</code>. Should be of the same length as (the number of rows of) <code>parms</code>. When not present or <code>NULL</code>, and the parms vector does not have row.names, the taxa in the output will be labeled <code>"tax_1"</code>, <code>"tax_2"</code>, etc.</p></dd>

  <dt id="arg-d-">D0 <a class="anchor" aria-label="anchor" href="#arg-d-"></a></dt>
<dd><p>initial density. One number, or a vector of length = nrow(parms).</p></dd>

  <dt id="arg-times-">times <a class="anchor" aria-label="anchor" href="#arg-times-"></a></dt>
<dd><p>time at which to estimate the density. One number, or a vector. Ignored if <code>parms</code> contains a column labeled <code>"times"</code>.</p></dd>

    <dt id="arg-tstart-perturb-tend-perturb-">tstart_perturb, tend_perturb <a class="anchor" aria-label="anchor" href="#arg-tstart-perturb-tend-perturb-"></a></dt>
<dd><p>time at which the perturbation starts and stops - before tsart_perturb and after tend_perturb, no events will occur (<code>density_perturb, density_metier</code>) or the mortality parameter will be set = 0 (<code>density_logistic</code>.</p></dd>

  <dt id="arg-as-desolve-">as.deSolve <a class="anchor" aria-label="anchor" href="#arg-as-desolve-"></a></dt>
<dd><p>if <code>TRUE</code>, will return an object of class deSolve, where the first column is time; if <code>FALSE</code>, the first columns will contain the parameters, and the values for the <code>times</code> will make up the remaining columns.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<p>If <code>as.deSolve</code> is <code>FALSE</code>, and <code>times</code> is part of the argument <code>parms</code>,
 returns a <code>data.frame</code>, with the following columns:</p>
<p></p><ul><li><p>for <code>density_logistic</code>:</p>
<p></p><ul><li><p><code>K, r, m</code>: the model parameters,</p></li>
<li><p><code>D0</code>: the initial condition,</p></li>
<li><p><code>times</code>, the times as in the argument <code>times</code>,</p></li>
<li><p><code>density</code>, the requested density at <code>times</code>.</p></li>
</ul></li>
<li><p>for <code>density_perturb</code>:</p>
<p></p><ul><li><p><code>K, r, d</code>: the model parameters,</p></li>
<li><p><code>sar</code>: the swept area ratio,</p></li>
<li><p><code>D0</code>: the initial condition,</p></li>
<li><p><code>times</code>, the times as in the argument <code>times</code>,</p></li>
<li><p><code>density</code>, the requested density at <code>times</code>.</p></li>
</ul></li>
</ul><p>If <code>as.deSolve</code> is <code>FALSE</code>, and <code>times</code> is a vector:
 returns a <code>data.frame</code>, with the following columns:</p>
<p></p><ul><li><p>for <code>density_logistic</code>:</p>
<p></p><ul><li><p><code>K, r, m</code>: the model parameters,</p></li>
<li><p><code>D0</code>: the initial condition,</p></li>
<li><p><code>Dt_..</code>, columns with the density for each value in the argument <code>times</code></p></li>
</ul></li>
<li><p>for <code>density_perturb</code>:</p>
<p></p><ul><li><p><code>K, r, d</code>: the model parameters,</p></li>
<li><p><code>sar</code>: the swept area ratio,</p></li>
<li><p><code>D0</code>: the initial condition,</p></li>
<li><p><code>Dt_..</code>, columns with the density for each value in the argument <code>times</code></p></li>
</ul></li>
</ul><p>If <code>as.deSolve</code> is <code>TRUE</code>, returns an object of class <code>deSolve</code>:</p>
<p></p><ul><li><ul><li><p><code>time</code>: the time as in the argument <code>times</code></p></li>
<li><p><code>..</code>, columns with the density for each row in the argument <code>parms</code></p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="trawlingdensity.html">trawl_perturb</a> for density before, after trawling and mean density inbetween trawling.</p>
<p><a href="steadydensity.html">steady_perturb</a> for steady-state calculations.</p>
<p><a href="trawlingfun.html">run_perturb</a> for how to run a disturbance model with unregularly spaced events.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/Btraitdata.html" class="external-link">Traits_nioz</a>, for trait databases in package Btrait.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/MWTLdensitydata.html" class="external-link">MWTL</a> for data sets on which fishing can be imposed.</p>
<p><a href="https://EMODnet.github.io/Btrait/reference/BtraitMap.html" class="external-link">map_key</a> for simple plotting functions.</p></div>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hiddink, JG, Jennings, S, Sciberras, M, et al., 2019. Assessing bottom trawling impacts based on the longevity of benthic invertebrates. J Appl Ecol 56: 1075-1084. https://doi.org/10.1111/1365-2664.13278</p>
<p>Hiddink, Jan Geert, Simon Jennings, Marija Sciberras, Claire L. Szostek, Kathryn M. Hughes, Nick Ellis, Adriaan D. Rijnsdorp, Robert A. McConnaughey, Tessa Mazor, Ray Hilborn, Jeremy S. Collie, C. Roland Pitcher, Ricardo O. Amoroso, Ana M. Parma, Petri Suuronen, and Michel J. Kaiser, 2017.  Global analysis of depletion and recovery of seabed biota after bottom trawling disturbance. Proc. Nat. Aca. Sci, 114 (31) 8301-8306. https://doi.org/10.1073/pnas.161885811.</p>
<p>C.R. Pitcher, N. Ellis, S. Jennings, J.G. Hiddink, T. Mazor, M.J.Kaiser, M.I. Kangas, R.A. McConnaughey, A.M. Parma, A.D. Rijnsdorp, P. Suuronen, J.S. Collie, R. Amoroso, K.M. Hughes and R. Hilborn, 2017. Estimating the sustainability of towed fishing-gearimpacts on seabed habitats: a simple quantitative riskassessment method applicable to data-limited fisheries. Methods in Ecology and Evolution,8,472-480doi: 10.1111/2041-210X.12705</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Simple runs</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">T1</span> <span class="op">&lt;-</span> <span class="fu">density_perturb</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, D0 <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>                       tstart_perturb <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                       tend_perturb   <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span>      </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu">density_metier</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, D0 <span class="op">=</span> <span class="fl">50</span>, sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       tstart_perturb <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                       tend_perturb   <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span>      </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">T3</span> <span class="op">&lt;-</span> <span class="fu">density_logistic</span> <span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.7</span>, D0 <span class="op">=</span> <span class="fl">50</span>, </span></span>
<span class="r-in"><span>                       tstart_perturb <span class="op">=</span> <span class="fl">2</span>, </span></span>
<span class="r-in"><span>                       tend_perturb   <span class="op">=</span> <span class="fl">8</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span>      </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">T1</span>, <span class="va">T2</span>, <span class="va">T3</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="density-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Compare density_perturb with dynamic run_perturb</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">8.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">T1</span> <span class="op">&lt;-</span> <span class="fu">density_perturb</span> <span class="op">(</span>K     <span class="op">=</span> <span class="fl">100</span>, </span></span>
<span class="r-in"><span>                       tstart_perturb <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span>      </span></span>
<span class="r-in"><span><span class="va">T1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   times        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.0 90.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.5 93.68627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1.5 91.32927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   2.5 90.39963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   8.5 89.77085</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dynamic run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rP</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_perturb</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  sar   <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rP</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">"comparison density_perturb and run_perturb"</span><span class="op">)</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">T1</span>, </span></span>
<span class="r-in"><span>       pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span></span>
<span class="r-in"><span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"run_perturb"</span>, </span></span>
<span class="r-in"><span>                   <span class="st">"density_perturb"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">16</span><span class="op">)</span><span class="op">)</span>       </span></span>
<span class="r-plt img"><img src="density-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>       </span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Compare density_logistic with dynamic run_logistic</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">8.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">T2</span> <span class="op">&lt;-</span> <span class="fu">density_logistic</span><span class="op">(</span>K     <span class="op">=</span> <span class="fl">100</span>, </span></span>
<span class="r-in"><span>                       times <span class="op">=</span> <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">T2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   times         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.0 100.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   0.5  96.12949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1.5  92.39526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   2.5  90.95870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   8.5  90.00428</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># dynamic run</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rL</span> <span class="op">&lt;-</span> <span class="fu"><a href="trawlingfun.html">run_logistic</a></span><span class="op">(</span>parms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K <span class="op">=</span> <span class="fl">100</span>, r <span class="op">=</span> <span class="fl">1</span>, m <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">11</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rL</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">"comparison density_logistic and run_logistic"</span><span class="op">)</span></span></span>
<span class="r-in"><span>     </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">T2</span>,   </span></span>
<span class="r-in"><span>       pch <span class="op">=</span> <span class="fl">18</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span></span>
<span class="r-in"><span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"run_logistic"</span>, </span></span>
<span class="r-in"><span>                   <span class="st">"density_logistic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span>       </span></span>
<span class="r-plt img"><img src="density-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Several metiers, one taxon</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># 2 metiers</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu">density_metier</span> <span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>,</span></span>
<span class="r-in"><span>                      K   <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                      as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with one metier run,                       </span></span></span>
<span class="r-in"><span><span class="va">P1</span> <span class="op">&lt;-</span> <span class="fu">density_perturb</span><span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                      K <span class="op">=</span> <span class="fl">1</span>, r <span class="op">=</span> <span class="fl">1</span>, d <span class="op">=</span> <span class="fl">0.1</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sar</span><span class="op">)</span>,  <span class="co"># sum of sar</span></span></span>
<span class="r-in"><span>                      as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">P1</span>, <span class="va">M1</span>, lty <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"one or two metiers"</span>, </span></span>
<span class="r-in"><span>     las <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sar = 3"</span>, <span class="st">"sar = (1, 2)"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="density-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span><span class="co">## Several metiers, multiple taxa</span></span></span>
<span class="r-in"><span><span class="co">## ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4 taxa, 3 metiers</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sar1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                sar2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                sar3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                </span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,  <span class="fl">1</span>,   <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,  <span class="fl">2</span>, <span class="fl">1.5</span>,  <span class="fl">2</span><span class="op">)</span>    </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span>, <span class="fl">1.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M1</span> <span class="op">&lt;-</span> <span class="fu">density_metier</span> <span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>,</span></span>
<span class="r-in"><span>                      K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>,</span></span>
<span class="r-in"><span>                      d   <span class="op">=</span> <span class="va">d</span>, </span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="va">sar</span>, </span></span>
<span class="r-in"><span>                      as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare with the single metier model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># average depletion</span></span></span>
<span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">d</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">sar</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">sar</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="va">d</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">sar</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sar</span><span class="op">)</span>                      </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">P1</span> <span class="op">&lt;-</span> <span class="fu">density_perturb</span><span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>, </span></span>
<span class="r-in"><span>                      K <span class="op">=</span> <span class="va">K</span>, r <span class="op">=</span> <span class="va">r</span>, </span></span>
<span class="r-in"><span>                      d <span class="op">=</span> <span class="va">d1</span>,</span></span>
<span class="r-in"><span>                      sar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sar</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      as.deSolve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">P1</span>, <span class="va">M1</span>, lty <span class="op">=</span> <span class="fl">1</span>, </span></span>
<span class="r-in"><span>     las <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>        legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sar = 4.3"</span>, <span class="st">"sar = (1, 2, 1.3)"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, <span class="st">"one or multiple metiers"</span>, outer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="density-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karline Soetaert, Olivier Beauchard.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

